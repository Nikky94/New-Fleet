<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é€²éšè»ŠéšŠç‡Ÿé‹ç¸¾æ•ˆå ±è¡¨</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .tabs {
            display: flex;
            background: #f5f5f5;
            border-bottom: 2px solid #ddd;
            overflow-x: auto;
        }
        
        .tab-btn {
            flex: 1;
            padding: 15px 20px;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 1em;
            color: #666;
            transition: all 0.3s;
            white-space: nowrap;
            min-width: 150px;
        }
        
        .tab-btn:hover {
            background: #e0e0e0;
            color: #333;
        }
        
        .tab-btn.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
            font-weight: bold;
        }
        
        .content {
            padding: 30px;
            min-height: 600px;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .stat-card h3 {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 10px;
        }
        
        .stat-card .value {
            font-size: 2em;
            font-weight: bold;
        }
        
        .stat-card .unit {
            font-size: 0.8em;
            opacity: 0.8;
            margin-top: 5px;
        }
        
        .chart-container {
            position: relative;
            height: 400px;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .chart-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        @media (max-width: 1024px) {
            .chart-row {
                grid-template-columns: 1fr;
            }
        }
        
        .table-container {
            overflow-x: auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95em;
        }
        
        th {
            background: #667eea;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        
        td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }
        
        tr:hover {
            background: #f9f9f9;
        }
        
        .status-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }
        
        .status-critical {
            background: #ff6b6b;
            color: white;
        }
        
        .status-warning {
            background: #ffd93d;
            color: #333;
        }
        
        .status-normal {
            background: #51cf66;
            color: white;
        }
        
        .status-completed {
            background: #868e96;
            color: white;
        }
        
        .status-terminated {
            background: #ff922b;
            color: white;
        }
        
        .search-filter {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .search-filter input,
        .search-filter select {
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 0.95em;
        }
        
        .search-filter input {
            flex: 1;
            min-width: 200px;
        }
        
        .footer {
            background: #f5f5f5;
            padding: 20px;
            text-align: center;
            color: #666;
            font-size: 0.9em;
            border-top: 1px solid #ddd;
        }
        
        .legend {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 20px;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 5px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
        }

        .profit-positive {
            color: #51cf66;
            font-weight: bold;
        }

        .profit-negative {
            color: #ff6b6b;
            font-weight: bold;
        }

        .summary-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .summary-box h3 {
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .summary-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .summary-item {
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 5px;
            text-align: center;
        }

        .summary-item .label {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .summary-item .value {
            font-size: 1.5em;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ‘® å¤©é·¹ä¿å…¨</h1>
            <p>    SEMAILè»ŠéšŠç¸¾æ•ˆç®¡ç†å ±è¡¨</p>
        </div>
        
        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('overview')">ğŸ“Š ç¸½è¦½</button>
            <button class="tab-btn" onclick="switchTab('trends')">ğŸ“ˆ é¢¨éšª</button>
            <button class="tab-btn" onclick="switchTab('vehicles')">ğŸš™ ç§Ÿè³ƒ</button>
            <button class="tab-btn" onclick="switchTab('sold')">âœ… å‡ºå”®</button>
            <button class="tab-btn" onclick="switchTab('terminated')">â›” ç•°å¸¸</button>
            <button class="tab-btn" onclick="switchTab('profitability')">ğŸ’° å¯¦è¡Œä¸­æç›Š</button>
            <button class="tab-btn" onclick="switchTab('costs')">ğŸ”§ æˆæœ¬çµæ§‹</button>
        </div>
        
        <div class="content">
            <!-- ç¸½è¦½ -->
            <div id="overview" class="tab-content active">
                <h2 style="margin-bottom: 20px;">ç¾æ³</h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>ä¿æœ‰</h3>
                        <div class="value" id="totalVehicles">30</div>
                        <div class="unit">å°</div>
                    </div>
                    <div class="stat-card">
                        <h3>æ‰¿ç§Ÿ</h3>
                        <div class="value" id="activeVehicles">29</div>
                        <div class="unit">å°</div>
                    </div>
                    <div class="stat-card">
                        <h3>è‡ªè³¼</h3>
                        <div class="value" id="idleVehicles">1</div>
                        <div class="unit">å°</div>
                    </div>
                    <div class="stat-card">
                        <h3>æœˆå‡æ”¶ç›Š</h3>
                        <div class="value" id="avgMonthlyRevenue">24,695</div>
                        <div class="unit">å…ƒ/å°</div>
                    </div>
                    <div class="stat-card">
                        <h3>æœˆå‡æ”¯å‡º</h3>
                        <div class="value" id="avgMonthlyExpense">7,722</div>
                        <div class="unit">å…ƒ/å°</div>
                    </div>
                    <div class="stat-card">
                        <h3>å¹³å‡ä½¿ç”¨ç‡(ä¿ä¿®,ä¿éšªè²»)</h3>
                        <div class="value" id="utilizationRate">96.7</div>
                        <div class="unit">%</div>
                    </div>
                </div>

                <div class="chart-row">
                    <div class="chart-container">
                        <canvas id="vehicleTypeChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="statusChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- é¢¨éšª -->
            <div id="trends" class="tab-content">
                <h2 style="margin-bottom: 20px;">ç”¨è»Šç¿’æ…£</h2>
                
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: #667eea;"></div>
                        <span>éå»5å¹´ (å¯¦ç¸¾)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #ffd93d;"></div>
                        <span>æœªä¾†5å¹´ (é æ¸¬)</span>
                    </div>
                </div>

               <div class="chart-container">
                    <canvas id="revenueChart"></canvas>
               </div>
                
               <div class="chart-row">
                   <div class="chart-container">
                       <canvas id="claimRateChart"></canvas>
                   </div>
                    <div class="chart-container">
                        <canvas id="utilizationChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="profitTrendChart"></canvas>
                </div>
            </div>

            <!-- ä½¿ç”¨ä¸­è»Šè¼› -->
            <div id="vehicles" class="tab-content">
                <h2 style="margin-bottom: 20px;">ä½¿ç”¨ä¸­è»Šè¼›æ˜ç´°</h2>
                <div class="search-filter">
                    <input type="text" id="vehicleSearch" placeholder="æœå°‹è»Šç‰Œæˆ–ç·¨è™Ÿ..." onkeyup="filterVehicleTable()">
                </div>
                <div class="table-container">
                    <table id="vehicleTable">
                        <thead>
                            <tr>
                                <th>è»Šè¼›ç·¨è™Ÿ</th>
                                <th>è»Šç‰Œ</th>
                                <th>è»Šå‹</th>
                                <th>é¡å‹</th>
                                <th>ç§Ÿç´„åˆ°æœŸ</th>
                                <th>å¹´æ”¶ç›Š</th>
                                <th>å¹´æˆæœ¬</th>
                                <th>å¹´åˆ©æ½¤</th>
                                <th>åˆ©æ½¤ç‡</th>
                                <th>ä½¿ç”¨ç‡</th>
                                <th>ç‹€æ…‹</th>
                                <th>å»ºè­°</th>
                            </tr>
                        </thead>
                        <tbody id="vehicleTableBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- å·²å‡ºå”®è»Šè¼› -->
            <div id="sold" class="tab-content">
                <h2 style="margin-bottom: 20px;">å·²å‡ºå”®è»Šè¼›çµ±è¨ˆ</h2>
                <div class="summary-box">
                    <h3>æ‘˜è¦</h3>
                    <div class="summary-content">
                        <div class="summary-item">
                            <div class="label">å·²å‡ºå”®å°æ•¸</div>
                            <div class="value" id="soldCount">27</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">ç¸½è³¼å…¥æˆæœ¬</div>
                            <div class="value" id="soldTotalPurchase">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">ç¸½å‡ºå”®æ”¶å…¥</div>
                            <div class="value" id="soldTotalSale">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">ç¸½ç§Ÿé‡‘æ”¶å…¥</div>
                            <div class="value" id="soldTotalRental">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">ç¸½ç‡Ÿé‹æˆæœ¬</div>
                            <div class="value" id="soldTotalCost">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">ç¸½æç›Š</div>
                            <div class="value" id="soldTotalProfit">0</div>
                        </div>
                    </div>
                </div>
                <div class="search-filter">
                    <input type="text" id="soldSearch" placeholder="æœå°‹è»Šç‰Œæˆ–ç·¨è™Ÿ..." onkeyup="filterSoldTable()">
                </div>
                <div class="table-container">
                    <table id="soldTable">
                        <thead>
                            <tr>
                                <th>è»Šè¼›ç·¨è™Ÿ</th>
                                <th>è»Šç‰Œ</th>
                                <th>è»Šå‹</th>
                                <th>è³¼å…¥åƒ¹</th>
                                <th>å‡ºå”®åƒ¹</th>
                                <th>ç§Ÿé‡‘æ”¶å…¥</th>
                                <th>ç‡Ÿé‹æˆæœ¬</th>
                                <th>ç¸½æç›Š</th>
                                <th>å‚™è¨»</th>
                            </tr>
                        </thead>
                        <tbody id="soldTableBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- è§£ç´„è»Šè¼› -->
            <div id="terminated" class="tab-content">
                <h2 style="margin-bottom: 20px;">è§£ç´„è»Šè¼›çµ±è¨ˆ</h2>
                <div class="summary-box">
                    <h3>è§£ç´„çµ±è¨ˆæ‘˜è¦</h3>
                    <div class="summary-content">
                        <div class="summary-item">
                            <div class="label">è§£ç´„å°æ•¸</div>
                            <div class="value" id="terminatedCount">4</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">ç§Ÿé‡‘æ”¶å…¥</div>
                            <div class="value" id="terminatedTotalRental">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">é•ç´„é‡‘æ”¶å…¥</div>
                            <div class="value" id="terminatedTotalPenalty">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">ç‡Ÿé‹æˆæœ¬</div>
                            <div class="value" id="terminatedTotalCost">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">ç¸½æç›Š</div>
                            <div class="value" id="terminatedTotalProfit">0</div>
                        </div>
                    </div>
                </div>
                <div class="search-filter">
                    <input type="text" id="terminatedSearch" placeholder="æœå°‹è»Šç‰Œæˆ–ç·¨è™Ÿ..." onkeyup="filterTerminatedTable()">
                </div>
                <div class="table-container">
                    <table id="terminatedTable">
                        <thead>
                            <tr>
                                <th>è»Šè¼›ç·¨è™Ÿ</th>
                                <th>è»Šç‰Œ</th>
                                <th>è»Šå‹</th>
                                <th>ç§Ÿé‡‘æ”¶å…¥</th>
                                <th>é•ç´„é‡‘</th>
                                <th>ç‡Ÿé‹æˆæœ¬</th>
                                <th>ç¸½æç›Š</th>
                                <th>è§£ç´„åŸå› </th>
                            </tr>
                        </thead>
                        <tbody id="terminatedTableBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- å€‹åˆ¥æç›Š -->
            <div id="profitability" class="tab-content">
                <h2 style="margin-bottom: 20px;">å€‹åˆ¥æç›Šåˆ†æ</h2>
                <div class="chart-row">
                    <div class="chart-container">
                        <canvas id="profitChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="marginChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- æˆæœ¬çµæ§‹ -->
            <div id="costs" class="tab-content">
                <h2 style="margin-bottom: 20px;">æˆæœ¬çµæ§‹åˆ†æ</h2>
                <div class="chart-container">
                    <canvas id="costChart"></canvas>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>é€²éšè»ŠéšŠç‡Ÿé‹ç¸¾æ•ˆå ±è¡¨ | æœ€å¾Œæ›´æ–°ï¼š2026-02-28 | JBD Dept. Fleet Management Division</p>
        </div>
    </div>

    <script>
        // ===== æ•¸æ“šæ ¸å¿ƒå€ (å®Œæ•´çš„çœŸå¯¦è»ŠéšŠæ•¸æ“š) =====
        const fleetData = {
  "reportInfo": {
    "reportDate": "2026-02-28",
    "reportTitle": "ğŸ‘®è»ŠéšŠå ±è¡¨",
    "company": " JBD Dept. "
  },
  "summary": {
    "totalVehicles": 30,
    "status": {
      "active": 29,
      "idle": 1,
      "sold": 27,
      "terminated": 4
    },
    "avgMonthlyRevenue": 24695,
    "avgMonthlyExpense": 7722,
    "utilizationRate": 96.7
  },
  "vehicleTypes": {
    "Sedan": 26,
    "SUV": 1,
    "MPV": 3
  },
  "yearlyTrend": [
    {"year": 2021, "revenue": 5774563, "expense": 3934790, "profit": 1839773, "claimRate": 0.42, "utilization": 92.5},
    {"year": 2022, "revenue": 7085577, "expense": 4077142, "profit": 3008435, "claimRate": 0.44, "utilization": 94.1},
    {"year": 2023, "revenue": 8744272, "expense": 3694609, "profit": 5049663, "claimRate": 1.44, "utilization": 95.8},
    {"year": 2024, "revenue": 9306029, "expense": 3202077, "profit": 6103952, "claimRate": 0.74, "utilization": 96.2},
    {"year": 2025, "revenue": 8595524, "expense": 3158363, "profit": 5437161, "claimRate": 0.67, "utilization": 96.7},
    {"year": 2026, "revenue": 8854422, "expense": 2858841, "profit": 5234191, "claimRate": 0.69, "utilization": 96.7},
    {"year": 2027, "revenue": 8499354, "expense": 3026021, "profit": 5473333, "claimRate": 0.64, "utilization": 100},
    {"year": 2028, "revenue": 9533640, "expense": 4000000, "profit": 5533640, "claimRate": 0.6, "utilization": 100},
    {"year": 2029, "revenue": 9533640, "expense": 4000000, "profit": 5533600, "claimRate": 0.55, "utilization": 100},
    {"year": 2030, "revenue": 9533640, "expense": 4000000, "profit": 5533600, "claimRate": 0.48, "utilization": 100}
  ],
  "expiringVehicles": [
    {"id": "GA-21001", "plate": "RDH-8065", "model": "Luxgen M7", "type": "MPV", "leaseEnd": "2026-09-18", "revenue": 1033000, "cost": 796000, "profit": 285000, "margin": 7.8, "utilization": 78.5, "status": "critical", "recommendation": "å·²ä½¿ç”¨äº”å¹´ï¼Œå»ºè­°æ±°æ–°"},
    {"id": "GA-21002", "plate": "RDQ-0865", "model": "Honda CR-V", "type": "SUV", "leaseEnd": "2027-03-30", "revenue": 1001000, "cost": 1254000, "profit": 373000, "margin": 20.8, "utilization": 82.1, "status": "critical", "recommendation": "å·²ä½¿ç”¨å…­å¹´ï¼Œå»ºè­°æ±°æ–°"},
    {"id": "CEO-22001", "plate": "RFD-9786", "model": "Toyota Sienna", "type": "MPV", "leaseEnd": "2026-11-30", "revenue": 2100000, "cost": 3089000, "profit": 373000, "margin": 20.8, "utilization": 88.3, "status": "critical", "recommendation": "8.6è¬,é«˜æ”¶ç›Šè»Šè¼›"},
    {"id": "HSR-23001", "plate": "RFA-8173", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "profit": 38000, "margin": 20.8, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°"},
    {"id": "HSR-23002", "plate": "RFA-8175", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "profit": 38000, "margin": 20.8, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°"},
    {"id": "HSR-23003", "plate": "RFA-8187", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "profit": 38000, "margin": 20.8, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°"},
    {"id": "HSR-23004", "plate": "RFA-8190", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "profit": 38000, "margin": 20.8, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°"},
    {"id": "HSR-23005", "plate": "RFA-8192", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "profit": 38000, "margin": 20.8, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°"},
    {"id": "HSR-23006", "plate": "RFA-8193", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "profit": 38000, "margin": 20.8, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°"},
    {"id": "HSR-23007", "plate": "RFA-8197", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "profit": 38000, "margin": 20.8, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°"},
    {"id": "HSR-23008", "plate": "RFA-8201", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "profit": 38000, "margin": 20.8, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°"},
    {"id": "HSR-23009", "plate": "RFA-8202", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "profit": 38000, "margin": 20.8, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°"},
    {"id": "HSR-23010", "plate": "RFA-8203", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "profit": 38000, "margin": 20.8, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°"},
    {"id": "HSR-23011", "plate": "RFA-8205", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "profit": 38000, "margin": 20.8, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°"},
    {"id": "HSR-23012", "plate": "RFA-8210", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "profit": 38000, "margin": 20.8, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°"},
    {"id": "HSR-23013", "plate": "RFA-8211", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "profit": 38000, "margin": 20.8, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°"},
    {"id": "HSR-23014", "plate": "RFA-8215", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "profit": 38000, "margin": 20.8, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°"},
    {"id": "HSR-23015", "plate": "RFA-8219", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "profit": 38000, "margin": 20.8, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°"},
    {"id": "HSR-23016", "plate": "RFA-8223", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "profit": 38000, "margin": 20.8, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°"},
    {"id": "HSR-23017", "plate": "RFA-8225", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "profit": 38000, "margin": 20.8, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°"},
    {"id": "HSR-23018", "plate": "RFA-8230", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "profit": 38000, "margin": 20.8, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°"},
    {"id": "HSR-23019", "plate": "RFA-8232", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "profit": 38000, "margin": 20.8, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°"},
    {"id": "HSR-23020", "plate": "RFA-8235", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "profit": 38000, "margin": 20.8, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°"},
    {"id": "HSR-23021", "plate": "RFA-8237", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "profit": 38000, "margin": 20.8, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°"},
    {"id": "HSR-23022", "plate": "RFA-8239", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "profit": 38000, "margin": 20.8, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°"},
    {"id": "HSR-23023", "plate": "RFA-8250", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "profit": 38000, "margin": 20.8, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°"},
    {"id": "HSR-23024", "plate": "RFA-8251", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "profit": 38000, "margin": 20.8, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°"},
    {"id": "HSR-23025", "plate": "RFA-8252", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "profit": 38000, "margin": 20.8, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°"},
    {"id": "HSR-23026", "plate": "RFA-9715", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "profit": 38000, "margin": 20.8, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°"}
  ],
  "soldVehicles": [
    {"id": "GA-19001", "plate": "RDQ-1350", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-03-31", "saleDate": "2022-03-30", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
    {"id": "CEO-20001", "plate": "RDB-8065", "model": "M-BENZ GLC coupe", "type": "SUV", "purchaseDate": "2020-12-01", "saleDate": "2023-11-30", "purchasePrice": 2780095, "salePrice": 1790476, "totalRentalRevenue": 1952360, "totalOperatingCost": 306228, "totalProfit": 656513, "holdingPeriod": 3, "status": "completed", "notes": "7.9è¬km"},
    {"id": "HSR-20001", "plate": "RCU-6706", "model": "Toyota Yaris", "type": "Sedan", "purchaseDate": "2020-04-30", "saleDate": "2023-10-02", "purchasePrice": 512794, "salePrice": 147619, "totalRentalRevenue": 743424, "totalOperatingCost": 353683, "totalProfit": 24866, "holdingPeriod": 3.3, "status": "completed", "notes": "33.5è¬km"},
    {"id": "HSR-20002", "plate": "RCU-6710", "model": "Toyota Yaris", "type": "Sedan", "purchaseDate": "2020-04-30", "saleDate": "2023-10-02", "purchasePrice": 512794, "salePrice": 147619, "totalRentalRevenue": 743424, "totalOperatingCost": 353683, "totalProfit": 24866, "holdingPeriod": 3.3, "status": "completed", "notes": "33.5è¬km"},
    {"id": "HSR-20003", "plate": "RCU-6712", "model": "Toyota Yaris", "type": "Sedan", "purchaseDate": "2020-04-30", "saleDate": "2023-10-02", "purchasePrice": 512794, "salePrice": 154286, "totalRentalRevenue": 741484, "totalOperatingCost": 326754, "totalProfit": 56222, "holdingPeriod": 3.3, "status": "completed", "notes": "30.1è¬km"},
    {"id": "HSR-20004", "plate": "RCU-6713", "model": "Toyota Yaris", "type": "Sedan", "purchaseDate": "2020-04-30", "saleDate": "2023-10-02", "purchasePrice": 512794, "salePrice": 171429, "totalRentalRevenue": 746190, "totalOperatingCost": 351446, "totalProfit": 53379, "holdingPeriod": 3.3, "status": "completed", "notes": "36è¬km"},
    {"id": "HSR-20005", "plate": "RCU-6715", "model": "Toyota Yaris", "type": "Sedan", "purchaseDate": "2020-04-30", "saleDate": "2023-11-16", "purchasePrice": 512794, "salePrice": 136190, "totalRentalRevenue": 792421, "totalOperatingCost": 397736, "totalProfit": 18081, "holdingPeriod": 3.3, "status": "completed", "notes": "31.3è¬km"},
    {"id": "HSR-20006", "plate": "RCU-6716", "model": "Toyota Yaris", "type": "Sedan", "purchaseDate": "2020-04-30", "saleDate": "2023-10-02", "purchasePrice": 512794, "salePrice": 202857, "totalRentalRevenue": 770322, "totalOperatingCost": 403156, "totalProfit": 57229, "holdingPeriod": 3.3, "status": "completed", "notes": "30.8è¬km"},
    {"id": "HSR-20007", "plate": "RCU-6720", "model": "Toyota Yaris", "type": "Sedan", "purchaseDate": "2020-04-30", "saleDate": "2023-10-26", "purchasePrice": 512794, "salePrice": 170476, "totalRentalRevenue": 768768, "totalOperatingCost": 383830, "totalProfit": 42620, "holdingPeriod": 3.3, "status": "completed", "notes": "30è¬km"},
    {"id": "HSR-20008", "plate": "RCU-6721", "model": "Toyota Yaris", "type": "Sedan", "purchaseDate": "2020-04-30", "saleDate": "2023-10-02", "purchasePrice": 512794, "salePrice": 109524, "totalRentalRevenue": 762533, "totalOperatingCost": 338750, "totalProfit": 20513, "holdingPeriod": 3.3, "status": "completed", "notes": "24.8è¬km"},
    {"id": "HSR-20009", "plate": "RCU-6723", "model": "Toyota Yaris", "type": "Sedan", "purchaseDate": "2020-04-30", "saleDate": "2023-10-02", "purchasePrice": 512794, "salePrice": 126667, "totalRentalRevenue": 761657, "totalOperatingCost": 450339, "totalProfit": -74809, "holdingPeriod": 3.3, "status": "completed", "notes": "30è¬km"},
    {"id": "HSR-20010", "plate": "RCU-6730", "model": "Toyota Yaris", "type": "Sedan", "purchaseDate": "2020-04-30", "saleDate": "2023-10-02", "purchasePrice": 512794, "salePrice": 171429, "totalRentalRevenue": 744353, "totalOperatingCost": 351446, "totalProfit": 51542, "holdingPeriod": 3.3, "status": "completed", "notes": "36.5è¬km"},
    {"id": "HSR-20011", "plate": "RCU-6732", "model": "Toyota Yaris", "type": "Sedan", "purchaseDate": "2020-04-30", "saleDate": "2023-10-02", "purchasePrice": 512794, "salePrice": 187619, "totalRentalRevenue": 739048, "totalOperatingCost": 351446, "totalProfit": 62427, "holdingPeriod": 3.3, "status": "completed", "notes": "23.7è¬km"},
    {"id": "HSR-20012", "plate": "RCU-6733", "model": "Toyota Yaris", "type": "Sedan", "purchaseDate": "2020-04-30", "saleDate": "2023-10-02", "purchasePrice": 512794, "salePrice": 191429, "totalRentalRevenue": 754895, "totalOperatingCost": 288537, "totalProfit": 144993, "holdingPeriod": 3.3, "status": "completed", "notes": "24.5è¬km"},
    {"id": "HSR-20013", "plate": "RCU-6735", "model": "Toyota Yaris", "type": "Sedan", "purchaseDate": "2020-04-30", "saleDate": "2023-10-02", "purchasePrice": 512794, "salePrice": 171429, "totalRentalRevenue": 747771, "totalOperatingCost": 346717, "totalProfit": 59689, "holdingPeriod": 3.3, "status": "completed", "notes": "34.2è¬km"},
    {"id": "HSR-20014", "plate": "RCU-6750", "model": "Toyota Yaris", "type": "Sedan", "purchaseDate": "2020-04-30", "saleDate": "2023-10-02", "purchasePrice": 512794, "salePrice": 176190, "totalRentalRevenue": 968096, "totalOperatingCost": 393361, "totalProfit": 238131, "holdingPeriod": 3.3, "status": "completed", "notes": "31.6è¬km æœ‰æ”¶å›å¾©è²»"},
    {"id": "HSR-20015", "plate": "RCU-6751", "model": "Toyota Yaris", "type": "Sedan", "purchaseDate": "2020-04-30", "saleDate": "2023-10-02", "purchasePrice": 512794, "salePrice": 118095, "totalRentalRevenue": 735048, "totalOperatingCost": 334736, "totalProfit": 5613, "holdingPeriod": 3.3, "status": "completed", "notes": "28è¬km"},
    {"id": "HSR-20016", "plate": "RCU-6752", "model": "Toyota Yaris", "type": "Sedan", "purchaseDate": "2020-04-30", "saleDate": "2023-10-02", "purchasePrice": 512794, "salePrice": 164762, "totalRentalRevenue": 735048, "totalOperatingCost": 349720, "totalProfit": 5613, "holdingPeriod": 3.3, "status": "completed", "notes": "29.4è¬km"},
    {"id": "HSR-20017", "plate": "RCU-6753", "model": "Toyota Yaris", "type": "Sedan", "purchaseDate": "2020-04-30", "saleDate": "2023-10-02", "purchasePrice": 512794, "salePrice": 141905, "totalRentalRevenue": 746119, "totalOperatingCost": 438791, "totalProfit": 37296, "holdingPeriod": 3.3, "status": "completed", "notes": "40.9è¬km"},
    {"id": "HSR-20018", "plate": "RCU-6760", "model": "Toyota Yaris", "type": "Sedan", "purchaseDate": "2020-04-30", "saleDate": "2023-10-02", "purchasePrice": 512794, "salePrice": 142857, "totalRentalRevenue": 746190, "totalOperatingCost": 445174, "totalProfit": -68921, "holdingPeriod": 3.3, "status": "completed", "notes": "36è¬km"},
    {"id": "HSR-20019", "plate": "RCU-6762", "model": "Toyota Yaris", "type": "Sedan", "purchaseDate": "2020-04-30", "saleDate": "2023-10-02", "purchasePrice": 512794, "salePrice": 143810, "totalRentalRevenue": 735048, "totalOperatingCost": 326343, "totalProfit": 39721, "holdingPeriod": 3.3, "status": "completed", "notes": "32.3è¬km"},
    {"id": "HSR-20020", "plate": "RCU-6763", "model": "Toyota Yaris", "type": "Sedan", "purchaseDate": "2020-04-30", "saleDate": "2023-10-02", "purchasePrice": 512794, "salePrice": 200000, "totalRentalRevenue": 735048, "totalOperatingCost": 245254, "totalProfit": 177000, "holdingPeriod": 3.3, "status": "completed", "notes": "25.1è¬km"},
    {"id": "HSR-20021", "plate": "RCU-6772", "model": "Toyota Yaris", "type": "Sedan", "purchaseDate": "2020-04-30", "saleDate": "2023-10-02", "purchasePrice": 512794, "salePrice": 158095, "totalRentalRevenue": 742095, "totalOperatingCost": 246858, "totalProfit": 140538, "holdingPeriod": 3.3, "status": "completed", "notes": "23,1è¬km"},
    {"id": "HSR-20022", "plate": "RCU-6773", "model": "Toyota Yaris", "type": "Sedan", "purchaseDate": "2020-04-30", "saleDate": "2023-10-02", "purchasePrice": 512794, "salePrice": 164762, "totalRentalRevenue": 735048, "totalOperatingCost": 245254, "totalProfit": 141762, "holdingPeriod": 3.3, "status": "completed", "notes": "24.1è¬km"},
    {"id": "HSR-20023", "plate": "RCU-6773", "model": "Toyota Yaris", "type": "Sedan", "purchaseDate": "2020-04-30", "saleDate": "2023-10-02", "purchasePrice": 512794, "salePrice": 164762, "totalRentalRevenue": 735048, "totalOperatingCost": 245254, "totalProfit": 141762, "holdingPeriod": 3.3, "status": "completed", "notes": "24.1è¬km"},
    {"id": "HSR-20024", "plate": "RCU-6775", "model": "Toyota Yaris", "type": "Sedan", "purchaseDate": "2020-04-30", "saleDate": "2023-08-31", "purchasePrice": 338286, "salePrice": 171429, "totalRentalRevenue": 919631, "totalOperatingCost": 298443, "totalProfit": 454331, "holdingPeriod": 3.3, "status": "completed", "notes": "23.7è¬km"},
    {"id": "HSR-20025", "plate": "RDL-6517", "model": "Toyota Yaris", "type": "Sedan", "purchaseDate": "2022-03-11", "saleDate": "2023-08-31", "purchasePrice": 445047, "salePrice": 202857, "totalRentalRevenue": 587424, "totalOperatingCost": 102616, "totalProfit": 242618, "holdingPeriod": 1.46, "status": "completed", "notes": "14.6è¬km"}
  ],
  "terminatedVehicles": [
    {"id": "HSR-001", "plate": "RCU-6725", "model": "Toyota Yaris", "type": "Sedan", "leaseStartDate": "2020-04-30", "terminationDate": "2020-07-29", "purchasePrice": 512794, "rentalRevenueReceived": 40000, "terminationFeeReceived": 572460, "totalOperatingCost": 533031, "totalProfit": 79429, "holdingPeriod": 0.25, "terminationReason": "è‹—æ —è‡ªæ’å®‰å…¨å³¶å…¨æ", "status": "terminated", "notes": "æœ¬é‡‘åˆ©ç›Š26891,RCW-6713æ¥çºŒ"},
    {"id": "HSR-002", "plate": "RCU-6736", "model": "Toyota Yaris", "type": "Sedan", "leaseStartDate": "2020-04-30", "terminationDate": "2021-06-29", "purchasePrice": 512794, "rentalRevenueReceived": 230667, "terminationFeeReceived": 485980, "totalOperatingCost": 645531, "totalProfit": 71116, "holdingPeriod": 1.17, "terminationReason": "å½°åŒ–è‡ªæ’é›»ç·šæ¡¿å…¨æ", "status": "terminated", "notes": "æœ¬é‡‘åˆ©ç›Š38307,RDF-5603æ¥çºŒ"},
    {"id": "HSR-003", "plate": "RDF-5603", "model": "Toyota Yaris", "type": "Sedan", "leaseStartDate": "2021-06-30", "terminationDate": "2022-02-07", "purchasePrice": 520033, "rentalRevenueReceived": 163107, "terminationFeeReceived": 513770, "totalOperatingCost": 592558, "totalProfit": 84319, "holdingPeriod": 0.75, "terminationReason": "å½°åŒ–è‡ªæ’å…¨æ", "status": "terminated", "notes": "æœ¬é‡‘åˆ©ç›Š34051,RDL-6517æ¥çºŒ"},
    {"id": "HSR-004", "plate": "RDA-8226", "model": "Vios", "type": "Sedan", "leaseStartDate": "2023-09-01", "terminationDate": "2025-06-11", "purchasePrice": 528413, "rentalRevenueReceived": 480000, "terminationFeeReceived": 451800, "totalOperatingCost": 682558, "totalProfit": 249242, "holdingPeriod": 1.67, "terminationReason": "é›²æ—è‡ªæ’è·¯æ¨¹å…¨æ", "status": "terminated", "notes": "æœ¬é‡‘åˆ©ç›Š115949,RDL-6517æ¥çºŒ"}
  ],
  "costBreakdown": {
    "purchase": 2074034,
    "tax": 41331,
    "maintenance": 229508,
    "insurance": 92390,
    "others": 19524
  }
};

        // ===== é ç±¤åˆ‡æ›é‚è¼¯ =====
        function switchTab(tabName) {
            const tabs = document.querySelectorAll('.tab-content');
            const buttons = document.querySelectorAll('.tab-btn');
            
            tabs.forEach(tab => tab.classList.remove('active'));
            buttons.forEach(btn => btn.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            setTimeout(() => {
                if (tabName === 'trends') initTrendChart();
                else if (tabName === 'profitability') {
                    initProfitChart();
                    initMarginChart();
                }
                else if (tabName === 'costs') initCostChart();
            }, 100);
        }

        // ===== åˆå§‹åŒ–é é¢ =====
        function initPage() {
            updateSummaryCards();
            initVehicleTypeChart();
            initStatusChart();
            populateVehicleTable();
            populateSoldTable();
            populateTerminatedTable();
            updateSoldSummary();
            updateTerminatedSummary();
        }

        // ===== æ›´æ–°æ‘˜è¦å¡ç‰‡ =====
        function updateSummaryCards() {
            document.getElementById('totalVehicles').textContent = fleetData.summary.totalVehicles;
            document.getElementById('activeVehicles').textContent = fleetData.summary.status.active;
            document.getElementById('idleVehicles').textContent = fleetData.summary.status.idle;
            document.getElementById('avgMonthlyRevenue').textContent = fleetData.summary.avgMonthlyRevenue.toLocaleString();
            document.getElementById('avgMonthlyExpense').textContent = fleetData.summary.avgMonthlyExpense.toLocaleString();
            document.getElementById('utilizationRate').textContent = fleetData.summary.utilizationRate;
        }

        // ===== è»Šå‹åˆ†ä½ˆåœ– =====
        function initVehicleTypeChart() {
            const ctx = document.getElementById('vehicleTypeChart').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(fleetData.vehicleTypes),
                    datasets: [{
                        data: Object.values(fleetData.vehicleTypes),
                        backgroundColor: ['#667eea', '#764ba2', '#f093fb'],
                        borderColor: '#fff',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        },
                        title: {
                            display: true,
                            text: 'è»Šå‹åˆ†ä½ˆ'
                        }
                    }
                }
            });
        }

        // ===== è»ŠéšŠç‹€æ…‹åœ– =====
        function initStatusChart() {
            const ctx = document.getElementById('statusChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['ä½¿ç”¨ä¸­', 'è‡ªè³¼', 'å·²å‡ºå”®', 'è§£ç´„'],
                    datasets: [{
                        label: 'å°æ•¸',
                        data: [
                            fleetData.summary.status.active,
                            fleetData.summary.status.idle,
                            fleetData.summary.status.sold,
                            fleetData.summary.status.terminated
                        ],
                        backgroundColor: ['#51cf66', '#4c6ef5', '#868e96', '#ff922b'],
                        borderRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'è»ŠéšŠç‹€æ…‹åˆ†ä½ˆ'
                        },
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // ===== 10å¹´è¶¨å‹¢åœ– =====
        function initTrendChart() {
            const ctx = document.getElementById('trendChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: fleetData.yearlyTrend.map(y => y.year),
                    datasets: [
                        {
                            label: 'æ”¶ç›Š',
                            data: fleetData.yearlyTrend.map(y => y.revenue),
                            borderColor: '#51cf66',
                            backgroundColor: 'rgba(81, 207, 102, 0.1)',
                            tension: 0.4,
                            fill: true
                        },
                        {
                            label: 'æˆæœ¬',
                            data: fleetData.yearlyTrend.map(y => y.expense),
                            borderColor: '#ff6b6b',
                            backgroundColor: 'rgba(255, 107, 107, 0.1)',
                            tension: 0.4,
                            fill: true
                        },
                        {
                            label: 'æ·¨åˆ©',
                            data: fleetData.yearlyTrend.map(y => y.profit),
                            borderColor: '#667eea',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            tension: 0.4,
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: '10å¹´æœŸç‡Ÿé‹è¶¨å‹¢ï¼ˆéå»5å¹´å¯¦ç¸¾ + æœªä¾†5å¹´é æ¸¬ï¼‰'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // ===== å€‹åˆ¥æç›Šåœ– =====
        function initProfitChart() {
            const ctx = document.getElementById('profitChart').getContext('2d');
            const vehicles = fleetData.expiringVehicles.slice(0, 10);
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: vehicles.map(v => v.id),
                    datasets: [
                        {
                            label: 'æ”¶ç›Š',
                            data: vehicles.map(v => v.revenue),
                            backgroundColor: '#51cf66'
                        },
                        {
                            label: 'æˆæœ¬',
                            data: vehicles.map(v => v.cost),
                            backgroundColor: '#ff6b6b'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'å€‹åˆ¥æç›Šå°æ¯”ï¼ˆå‰10å°ï¼‰'
                        }
                    }
                }
            });
        }

        // ===== åˆ©æ½¤ç‡åœ– =====
        function initMarginChart() {
            const ctx = document.getElementById('marginChart').getContext('2d');
            const vehicles = fleetData.expiringVehicles.slice(0, 10);
            const margins = vehicles.map(v => v.margin);
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: vehicles.map(v => v.id),
                    datasets: [{
                        label: 'åˆ©æ½¤ç‡ (%)',
                        data: margins,
                        backgroundColor: margins.map(m => m >= 20 ? '#51cf66' : m >= 10 ? '#ffd93d' : '#ff6b6b')
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'åˆ©æ½¤ç‡æ’è¡Œï¼ˆå‰10å°ï¼‰'
                        }
                    }
                }
            });
        }

        // ===== æˆæœ¬çµæ§‹åœ– =====
        function initCostChart() {
            const ctx = document.getElementById('costChart').getContext('2d');
            const total = Object.values(fleetData.costBreakdown).reduce((a, b) => a + b, 0);
            const percentages = Object.values(fleetData.costBreakdown).map(v => (v / total * 100).toFixed(1));
            
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['è³¼è»Š', 'ç¨…é‡‘', 'ç¶­ä¿®', 'ä¿è²»', 'å…¶ä»–'],
                    datasets: [{
                        data: percentages,
                        backgroundColor: ['#667eea', '#764ba2', '#f093fb', '#4c6ef5', '#868e96']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'æˆæœ¬çµæ§‹ä½”æ¯” (%)'
                        }
                    }
                }
            });
        }

        // ===== å¡«å……ä½¿ç”¨ä¸­è»Šè¼›è¡¨æ ¼ =====
        function populateVehicleTable() {
            const tbody = document.getElementById('vehicleTableBody');
            tbody.innerHTML = '';
            fleetData.expiringVehicles.forEach(v => {
                const row = `<tr>
                    <td>${v.id}</td>
                    <td>${v.plate}</td>
                    <td>${v.model}</td>
                    <td>${v.type}</td>
                    <td>${v.leaseEnd}</td>
                    <td>${v.revenue.toLocaleString()}</td>
                    <td>${v.cost.toLocaleString()}</td>
                    <td class="${v.profit >= 0 ? 'profit-positive' : 'profit-negative'}">${v.profit.toLocaleString()}</td>
                    <td>${v.margin}%</td>
                    <td>${v.utilization}%</td>
                    <td><span class="status-badge status-${v.status}">${v.status === 'critical' ? 'ç·Šæ€¥' : 'æ­£å¸¸'}</span></td>
                    <td>${v.recommendation}</td>
                </tr>`;
                tbody.innerHTML += row;
            });
        }

        // ===== å¡«å……å·²å‡ºå”®è»Šè¼›è¡¨æ ¼ =====
        function populateSoldTable() {
            const tbody = document.getElementById('soldTableBody');
            tbody.innerHTML = '';
            fleetData.soldVehicles.forEach(v => {
                const row = `<tr>
                    <td>${v.id}</td>
                    <td>${v.plate}</td>
                    <td>${v.model}</td>
                    <td>${v.purchasePrice.toLocaleString()}</td>
                    <td>${v.salePrice.toLocaleString()}</td>
                    <td>${v.totalRentalRevenue.toLocaleString()}</td>
                    <td>${v.totalOperatingCost.toLocaleString()}</td>
                    <td class="${v.totalProfit >= 0 ? 'profit-positive' : 'profit-negative'}">${v.totalProfit.toLocaleString()}</td>
                    <td>${v.notes}</td>
                </tr>`;
                tbody.innerHTML += row;
            });
        }

        // ===== å¡«å……è§£ç´„è»Šè¼›è¡¨æ ¼ =====
        function populateTerminatedTable() {
            const tbody = document.getElementById('terminatedTableBody');
            tbody.innerHTML = '';
            fleetData.terminatedVehicles.forEach(v => {
                const row = `<tr>
                    <td>${v.id}</td>
                    <td>${v.plate}</td>
                    <td>${v.model}</td>
                    <td>${v.rentalRevenueReceived.toLocaleString()}</td>
                    <td>${v.terminationFeeReceived.toLocaleString()}</td>
                    <td>${v.totalOperatingCost.toLocaleString()}</td>
                    <td class="${v.totalProfit >= 0 ? 'profit-positive' : 'profit-negative'}">${v.totalProfit.toLocaleString()}</td>
                    <td>${v.terminationReason}</td>
                </tr>`;
                tbody.innerHTML += row;
            });
        }

        // ===== æ›´æ–°å·²å‡ºå”®çµ±è¨ˆ =====
        function updateSoldSummary() {
            const sold = fleetData.soldVehicles;
            const totalPurchase = sold.reduce((sum, v) => sum + v.purchasePrice, 0);
            const totalSale = sold.reduce((sum, v) => sum + v.salePrice, 0);
            const totalRental = sold.reduce((sum, v) => sum + v.totalRentalRevenue, 0);
            const totalCost = sold.reduce((sum, v) => sum + v.totalOperatingCost, 0);
            const totalProfit = sold.reduce((sum, v) => sum + v.totalProfit, 0);
            
            document.getElementById('soldCount').textContent = sold.length;
            document.getElementById('soldTotalPurchase').textContent = totalPurchase.toLocaleString();
            document.getElementById('soldTotalSale').textContent = totalSale.toLocaleString();
            document.getElementById('soldTotalRental').textContent = totalRental.toLocaleString();
            document.getElementById('soldTotalCost').textContent = totalCost.toLocaleString();
            document.getElementById('soldTotalProfit').textContent = totalProfit.toLocaleString();
        }

        // ===== æ›´æ–°è§£ç´„çµ±è¨ˆ =====
        function updateTerminatedSummary() {
            const terminated = fleetData.terminatedVehicles;
            const totalRental = terminated.reduce((sum, v) => sum + v.rentalRevenueReceived, 0);
            const totalPenalty = terminated.reduce((sum, v) => sum + v.terminationFeeReceived, 0);
            const totalCost = terminated.reduce((sum, v) => sum + v.totalOperatingCost, 0);
            const totalProfit = terminated.reduce((sum, v) => sum + v.totalProfit, 0);
            
            document.getElementById('terminatedCount').textContent = terminated.length;
            document.getElementById('terminatedTotalRental').textContent = totalRental.toLocaleString();
            document.getElementById('terminatedTotalPenalty').textContent = totalPenalty.toLocaleString();
            document.getElementById('terminatedTotalCost').textContent = totalCost.toLocaleString();
            document.getElementById('terminatedTotalProfit').textContent = totalProfit.toLocaleString();
        }

        // ===== æœå°‹èˆ‡ç¯©é¸ =====
        function filterVehicleTable() {
            const input = document.getElementById('vehicleSearch').value.toUpperCase();
            const table = document.getElementById('vehicleTable');
            const rows = table.getElementsByTagName('tr');
            
            for (let i = 1; i < rows.length; i++) {
                const cells = rows[i].getElementsByTagName('td');
                let found = false;
                for (let j = 0; j < cells.length; j++) {
                    if (cells[j].textContent.toUpperCase().indexOf(input) > -1) {
                        found = true;
                        break;
                    }
                }
                rows[i].style.display = found ? '' : 'none';
            }
        }

        function filterSoldTable() {
            const input = document.getElementById('soldSearch').value.toUpperCase();
            const table = document.getElementById('soldTable');
            const rows = table.getElementsByTagName('tr');
            
            for (let i = 1; i < rows.length; i++) {
                const cells = rows[i].getElementsByTagName('td');
                let found = false;
                for (let j = 0; j < cells.length; j++) {
                    if (cells[j].textContent.toUpperCase().indexOf(input) > -1) {
                        found = true;
                        break;
                    }
                }
                rows[i].style.display = found ? '' : 'none';
            }
        }

        function filterTerminatedTable() {
            const input = document.getElementById('terminatedSearch').value.toUpperCase();
            const table = document.getElementById('terminatedTable');
            const rows = table.getElementsByTagName('tr');
            
            for (let i = 1; i < rows.length; i++) {
                const cells = rows[i].getElementsByTagName('td');
                let found = false;
                for (let j = 0; j < cells.length; j++) {
                    if (cells[j].textContent.toUpperCase().indexOf(input) > -1) {
                        found = true;
                        break;
                    }
                }
                rows[i].style.display = found ? '' : 'none';
            }
        }

        // ===== é é¢è¼‰å…¥æ™‚åˆå§‹åŒ– =====
        window.addEventListener('load', initPage);
    </script>
</body>
</html>
