<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ‘®å¤©é·¹ä¿å…¨ğŸš™</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .tabs {
            display: flex;
            background: #f5f5f5;
            border-bottom: 2px solid #ddd;
            overflow-x: auto;
        }
        
        .tab-btn {
            flex: 1;
            padding: 15px 20px;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 1em;
            color: #666;
            transition: all 0.3s;
            white-space: nowrap;
            min-width: 150px;
        }
        
        .tab-btn:hover {
            background: #e0e0e0;
            color: #333;
        }
        
        .tab-btn.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
            font-weight: bold;
        }
        
        .content {
            padding: 30px;
            min-height: 600px;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .stat-card h3 {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 10px;
        }
        
        .stat-card .value {
            font-size: 2em;
            font-weight: bold;
        }
        
        .stat-card .unit {
            font-size: 0.8em;
            opacity: 0.8;
            margin-top: 5px;
        }
        
        .chart-container {
            position: relative;
            height: 400px;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .chart-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        @media (max-width: 1024px) {
            .chart-row {
                grid-template-columns: 1fr;
            }
        }
        
        .table-container {
            overflow-x: auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95em;
        }
        
        th {
            background: #667eea;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        
        td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }
        
        tr:hover {
            background: #f9f9f9;
        }
        
        .status-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }
        
        .status-critical {
            background: #ff6b6b;
            color: white;
        }
        
        .status-warning {
            background: #ffd93d;
            color: #333;
        }
        
        .status-normal {
            background: #51cf66;
            color: white;
        }
        
        .status-completed {
            background: #868e96;
            color: white;
        }
        
        .status-terminated {
            background: #ff922b;
            color: white;
        }
        
        .search-filter {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .search-filter input,
        .search-filter select {
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 0.95em;
        }
        
        .search-filter input {
            flex: 1;
            min-width: 200px;
        }
        
        .footer {
            background: #f5f5f5;
            padding: 20px;
            text-align: center;
            color: #666;
            font-size: 0.9em;
            border-top: 1px solid #ddd;
        }
        
        .legend {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 20px;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 5px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
        }

        .profit-positive {
            color: #51cf66;
            font-weight: bold;
        }

        .profit-negative {
            color: #ff6b6b;
            font-weight: bold;
        }

        .summary-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .summary-box h3 {
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .summary-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .summary-item {
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 5px;
            text-align: center;
        }

        .summary-item .label {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .summary-item .value {
            font-size: 1.5em;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ‘®å¤©é·¹ä¿å…¨ğŸš™</h1>
            <p></p>
        </div>
        
        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('overview')">ğŸ“Š è»ŠéšŠç¸½è¦½</button>
            <button class="tab-btn" onclick="switchTab('trends')">ğŸ“ˆ é•·æœŸè©•ä¼°</button>
            <button class="tab-btn" onclick="switchTab('vehicles')">ğŸš™ ç§Ÿç”¨ä¸­</button>
            <button class="tab-btn" onclick="switchTab('sold')">ğŸ§® å‡ºå”®</button>
            <button class="tab-btn" onclick="switchTab('terminated')">â›” è§£ç´„</button>
            <button class="tab-btn" onclick="switchTab('profitability')">ğŸ’° æç›Š</button>
            <button class="tab-btn" onclick="switchTab('costs')">ğŸ”§ æˆæœ¬çµæ§‹</button>
        </div>
        
        <div class="content">
            <!-- è»ŠéšŠç¸½è¦½ -->
            <div id="overview" class="tab-content active">
                <h2 style="margin-bottom: 20px;">ä½¿ç”¨æ¦‚æ³</h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>ç¸½è»Šè¼›æ•¸</h3>
                        <div class="value" id="totalVehicles">30</div>
                        <div class="unit">å°</div>
                    </div>
                    <div class="stat-card">
                        <h3>ç§Ÿç”¨ä¸­</h3>
                        <div class="value" id="activeVehicles">29</div>
                        <div class="unit">å°</div>
                    </div>
                    <div class="stat-card">
                        <h3>è‡ªè³¼</h3>
                        <div class="value" id="idleVehicles">1</div>
                        <div class="unit">å°</div>
                    </div>
                    <div class="stat-card">
                        <h3>ç¶­ä¿®ä¸­</h3>
                        <div class="value" id="maintenanceVehicles">0</div>
                        <div class="unit">å°</div>
                    </div>
                    <div class="stat-card">
                        <h3>å·²å‡ºå”®</h3>
                        <div class="value" id="soldVehicles">28</div>
                        <div class="unit">å°</div>
                    </div>
                    <div class="stat-card">
                        <h3>ä¸­é€”è§£ç´„</h3>
                        <div class="value" id="terminatedVehicles">5</div>
                        <div class="unit">å°</div>
                    </div>
                </div>
                
                <div class="chart-row">
                    <div class="chart-container">
                        <canvas id="statusChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="typeChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-row">
                    <div class="chart-container">
                        <canvas id="ageChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="typePerformanceChart"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- é•·æœŸè©•ä¼° -->
            <div id="trends" class="tab-content">
                <h2 style="margin-bottom: 20px;">10å¹´é–“æ›²ç·šåˆ†æ</h2>
                
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: #667eea;"></div>
                        <span>éå»5å¹´ (å¯¦ç¸¾)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #ffd93d;"></div>
                        <span>æœªä¾†5å¹´ (é æ¸¬)</span>
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="revenueChart"></canvas>
                </div>
                
                <div class="chart-row">
                    <div class="chart-container">
                        <canvas id="claimRateChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="utilizationChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="profitTrendChart"></canvas>
                </div>
            </div>
            
            <!-- ç§Ÿç”¨ä¸­ -->
            <div id="vehicles" class="tab-content">
                <h2 style="margin-bottom: 20px;">ç§Ÿç´„å¯¦è¡Œä¸­</h2>
                
                <div class="search-filter">
                    <input type="text" id="searchVehicle" placeholder="ğŸ” æœå°‹è»Šç‰Œ / è»Šå‹..." onkeyup="filterVehicles()">
                    <select id="statusFilter" onchange="filterVehicles()">
                        <option value="">ç‹€æ…‹</option>
                        <option value="critical">ğŸ”´ ç·Šæ€¥</option>
                        <option value="warning">ğŸŸ¡ è­¦ç¤º</option>
                        <option value="normal">ğŸŸ¢ ä¸€èˆ¬</option>
                    </select>
                </div>
                
                <div class="chart-row">
                    <div class="chart-container">
                        <canvas id="expiryTimelineChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="expiryProfitChart"></canvas>
                    </div>
                </div>
                
                <div class="table-container">
                    <table id="vehicleTable">
                        <thead>
                            <tr>
                                <th>ç·¨ç¢¼</th>
                                <th>è»Šè™Ÿ</th>
                                <th>è»Šå‹</th>
                                <th>åˆ°æœŸæ—¥</th>
                                <th>æ”¶ç›Š</th>
                                <th>æˆæœ¬</th>
                                <th>æ·¨åˆ©</th>
                                <th>åˆ©æ½¤ç‡</th>
                                <th>ä½¿ç”¨ç‡</th>
                                <th>ç‹€æ…‹</th>
                                <th>å»ºè­°</th>
                            </tr>
                        </thead>
                        <tbody id="vehicleTableBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- å‡ºå”® -->
            <div id="sold" class="tab-content">
                <h2 style="margin-bottom: 20px;">çµæ¡ˆæ˜ç´°</h2>

                <div class="summary-box">
                    <h3>æ‘˜è¦</h3>
                    <div class="summary-content">
                        <div class="summary-item">
                            <div class="label">å·²å‡ºå”®å°æ•¸</div>
                            <div class="value" id="soldCount">28</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">è³¼è»Šç¸½æˆæœ¬</div>
                            <div class="value" id="soldTotalPurchase">$5.7M</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">å‡ºå”®ç¸½æ”¶å…¥</div>
                            <div class="value" id="soldTotalSale">$2.65M</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">ç§Ÿé‡‘ç¸½æ”¶å…¥</div>
                            <div class="value" id="soldTotalRental">$22.0M</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">æˆæœ¬ç¸½æ”¯å‡º</div>
                            <div class="value" id="soldTotalCost">$15.15M</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">æç›Šçµ±è¨ˆ</div>
                            <div class="value profit-positive" id="soldTotalProfit">$4.95M</div>
                        </div>
                    </div>
                </div>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ç·¨ç¢¼</th>
                                <th>è»Šè™Ÿ</th>
                                <th>è»Šå‹</th>
                                <th>è³¼å…¥æ—¥æœŸ</th>
                                <th>å‡ºå”®æ—¥æœŸ</th>
                                <th>è³¼è»Šåƒ¹</th>
                                <th>å‡ºå”®åƒ¹</th>
                                <th>ç§Ÿé‡‘æ”¶å…¥</th>
                                <th>æ”¯å‡ºæˆæœ¬</th>
                                <th>ç¸½æç›Š</th>
                                <th>æŒæœ‰å¹´é™</th>
                                <th>å‚™è¨»</th>
                            </tr>
                        </thead>
                        <tbody id="soldTableBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ä¸­é€”è§£ç´„ -->
            <div id="terminated" class="tab-content">
                <h2 style="margin-bottom: 20px;">çµ‚æ­¢æ˜ç´°</h2>

                <div class="summary-box">
                    <h3>æ‘˜è¦</h3>
                    <div class="summary-content">
                        <div class="summary-item">
                            <div class="label">è§£ç´„å°æ•¸</div>
                            <div class="value" id="termCount">5</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">è³¼è»Šç¸½æˆæœ¬</div>
                            <div class="value" id="termTotalPurchase">$5.9M</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">ç§Ÿé‡‘ç¸½æ”¶å…¥</div>
                            <div class="value" id="termTotalRental">$9.75M</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">è§£ç´„ç­‰æ”¶å…¥</div>
                            <div class="value" id="termTotalFee">$0.87M</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">æˆæœ¬ç¸½æ”¯å‡º</div>
                            <div class="value" id="termTotalCost">$7.65M</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">æç›Š</div>
                            <div class="value profit-positive" id="termTotalProfit">$3.27M</div>
                        </div>
                    </div>
                </div>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ç·¨ç¢¼</th>
                                <th>è»Šè™Ÿ</th>
                                <th>è»Šå‹</th>
                                <th>èµ·ç§Ÿæ—¥</th>
                                <th>è§£ç´„æ—¥</th>
                                <th>è³¼è»Šåƒ¹</th>
                                <th>ç§Ÿé‡‘æ”¶å…¥</th>
                                <th>è§£ç´„é‡‘</th>
                                <th>æ”¯å‡ºæˆæœ¬</th>
                                <th>ç¸½æç›Š</th>
                                <th>æŒæœ‰å¹´é™</th>
                                <th>è§£ç´„åŸå› </th>
                                <th>å‚™è¨»</th>
                            </tr>
                        </thead>
                        <tbody id="terminatedTableBody">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- æç›Š -->
            <div id="profitability" class="tab-content">
                <h2 style="margin-bottom: 20px;">å€‹åˆ¥åˆ†æ</h2>
                
                <div class="chart-row">
                    <div class="chart-container">
                        <canvas id="vehicleComparisonChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="marginRankChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="scatterChart"></canvas>
                </div>
            </div>
            
            <!-- æˆæœ¬çµæ§‹ -->
            <div id="costs" class="tab-content">
                <h2 style="margin-bottom: 20px;">åœ–è¡¨åˆ†æ</h2>
                
                <div class="chart-row">
                    <div class="chart-container">
                        <canvas id="costStructureChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="typeMarginChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="costStackChart"></canvas>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>å¤©é·¹è»ŠéšŠå ±è¡¨ | å ±å‘Šæ—¥æœŸï¼š<span id="reportDate">2026-02-26</span> | SE Corp. - Fleet Management Division</p>
        </div>
    </div>
    
    <script>
        // æ•¸æ“šè¼‰å…¥
        const fleetData = {
            "reportDate": "2026-02-26",
            "reportTitle": "å¤©é·¹è»ŠéšŠå ±è¡¨ (10å¹´æ›²ç·šåˆ†æ)",
            "company": "SE Corp. - Fleet Management Division",
            "summary": {
                "totalVehicles": 30,
                "status": {
                    "active": 29,
                    "idle": 1,
                    "maintenance": 0,
                    "terminated": 5,
                    "sold": 28
                },
                "vehicleTypes": {
                    "Sedan": 26,
                    "SUV": 1,
                    "MPV": 2,
                    "VAN": 0,                    
                },
                "fleetAge": {
                    "under1Year": 0,
                    "1to3Years": 27,
                    "3to5Years": 2,
                    "over5Years": 0
                }
            },
            "yearlyTrend": [
                {"year": 2021, "revenue": 12500000, "expense": 9500000, "profit": 3000000, "claimRate": 4.2, "utilization": 82.5},
                {"year": 2022, "revenue": 13800000, "expense": 10200000, "profit": 3600000, "claimRate": 3.8, "utilization": 84.2},
                {"year": 2023, "revenue": 15200000, "expense": 11500000, "profit": 3700000, "claimRate": 4.5, "utilization": 86.8},
                {"year": 2024, "revenue": 16500000, "expense": 12800000, "profit": 3700000, "claimRate": 4.1, "utilization": 85.5},
                {"year": 2025, "revenue": 17800000, "expense": 13500000, "profit": 4300000, "claimRate": 3.9, "utilization": 88.2},
                {"year": 2026, "revenue": 18500000, "expense": 14200000, "profit": 4300000, "claimRate": 4.0, "utilization": 87.5, "forecast": true},
                {"year": 2027, "revenue": 19200000, "expense": 14800000, "profit": 4400000, "claimRate": 4.0, "utilization": 88.0, "forecast": true},
                {"year": 2028, "revenue": 20500000, "expense": 15500000, "profit": 5000000, "claimRate": 3.8, "utilization": 89.5, "forecast": true},
                {"year": 2029, "revenue": 21800000, "expense": 16200000, "profit": 5600000, "claimRate": 3.7, "utilization": 90.2, "forecast": true},
                {"year": 2030, "revenue": 23000000, "expense": 17000000, "profit": 6000000, "claimRate": 3.6, "utilization": 91.5, "forecast": true}
            ],
            "costStructure": {
                "acquisition": 45.0,
                "tax": 12.5,
                "maintenance": 18.5,
                "insurance": 15.0,
                "other": 9.0
            },
            "typePerformance": [
                {"type": "Sedan", "count": 26, "utilization": 82.5, "profitMargin": 12.5, "avgCost": 850000},
                {"type": "SUV", "count": 1, "utilization": 88.2, "profitMargin": 15.8, "avgCost": 1250000},
                {"type": "MPV", "count": 2, "utilization": 91.5, "profitMargin": 18.2, "avgCost": 1550000},
                {"type": "VAN", "count": 0, "utilization": 85.0, "profitMargin": 10.5, "avgCost": 950000},
            ],
            "expiringVehicles": [
                {
                    "id": "GA-21001",
                    "plate": "ABC-8888",
                    "model": "Toyota Camry",
                    "type": "Sedan",
                    "leaseEnd": "2026-03-15",
                    "revenue": 1200000,
                    "cost": 950000,
                    "profit": 250000,
                    "margin": 20.8,
                    "utilization": 88.5,
                    "status": "critical",
                    "recommendation": "é«˜æ”¶ç›Šè»Šè¼›ï¼Œå»ºè­°çºŒç´„æˆ–è½‰å”®é«˜åƒ¹"
                },
                {
                    "id": "CEO-001",
                    "plate": "BOSS-1",
                    "model": "Mercedes-Benz S-Class",
                    "type": "Sedan",
                    "leaseEnd": "2026-06-01",
                    "revenue": 4500000,
                    "cost": 4200000,
                    "profit": 300000,
                    "margin": 6.7,
                    "utilization": 65.0,
                    "status": "warning",
                    "recommendation": "é«˜éšåº§è»Šï¼Œç¶­è­·æˆæœ¬åé«˜ï¼Œè©•ä¼°æ›è³¼æ–°è»Š"
                },
                {
                    "id": "HSR-005",
                    "plate": "HSR-5566",
                    "model": "VW Multivan",
                    "type": "MPV",
                    "leaseEnd": "2026-08-20",
                    "revenue": 2800000,
                    "cost": 2100000,
                    "profit": 700000,
                    "margin": 25.0,
                    "utilization": 95.2,
                    "status": "normal",
                    "recommendation": "é«˜éµæ¥é§ä¸»åŠ›ï¼Œé«˜ç¨¼å‹•ç‡ï¼Œå»ºè­°çºŒç´„"
                },
                {
                    "id": "TRK-002",
                    "plate": "TRK-1234",
                    "model": "Isuzu F-Series",
                    "type": "Track",
                    "leaseEnd": "2027-02-15",
                    "revenue": 5500000,
                    "cost": 4100000,
                    "profit": 1400000,
                    "margin": 25.5,
                    "utilization": 92.0,
                    "status": "normal",
                    "recommendation": "ç©©å®šæ”¶ç›Šè²¨è»Šï¼ŒæŒ‰è¨ˆç•«ä¿é¤Š"
                },
                {
                    "id": "VAN-012",
                    "plate": "VAN-9900",
                    "model": "Ford Transit",
                    "type": "VAN",
                    "leaseEnd": "2026-04-10",
                    "revenue": 1500000,
                    "cost": 1550000,
                    "profit": -50000,
                    "margin": -3.3,
                    "utilization": 72.0,
                    "status": "critical",
                    "recommendation": "è™§æè»Šè¼›ï¼Œç§Ÿç´„æœŸæ»¿å³åˆ»è™•åˆ†"
                }
            ],
            "soldVehicles": [
                {
                    "id": "GA-19001",
                    "plate": "RDQ-1350",
                    "model": "Toyota Sienta",
                    "type": "MPV",
                    "purchaseDate": "2019-03-31",
                    "saleDate": "2022-06-24",
                    "purchasePrice": 679537,
                    "salePrice": 438095,
                    "totalRentalRevenue": 479988,
                    "totalOperatingCost": 121148,
                    "totalProfit": 117398,
                    "holdingPeriod": 3.25,
                    "status": "completed",
                    "notes": "é«˜æ–¼å¸‚åƒ¹å‡ºå”®"
                },
                {
                    "id": "CEO-20001",
                    "plate": "RDB-8065",
                    "model": "Mercedes-Benz GLC",
                    "type": "SUV",
                    "purchaseDate": "2020-12-01",
                    "saleDate": "2023-12-05",
                    "purchasePrice": 2780095,
                    "salePrice": 1790476,
                    "totalRentalRevenue": 1956558,
                    "totalOperatingCost": 306228,
                    "totalProfit": 660711,
                    "holdingPeriod": 3,
                    "status": "completed",
                    "notes": "æ¥µé«˜æ”¶ç›Š"
                },
                {
                    "id": "HSR-20001",
                    "plate": "RCU-6706",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-26",
                    "purchasePrice": 512794,
                    "salePrice": 188571,
                    "totalRentalRevenue": 603036,
                    "totalOperatingCost": 287922,
                    "totalProfit": -9109,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "17.8è¬kmå¾®å¹…è™§æ"
                },
                {
                    
                    "id": "HSR-20002",
                    "plate": "RCU-6710",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 189524,
                    "totalRentalRevenue": 603036,
                    "totalOperatingCost": 288920,
                    "totalProfit": -9154,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "20.9è¬kmå¾®å¹…è™§æ"
                },
                {
                    
                    "id": "HSR-20003",
                    "plate": "RCU-6712",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-11-02",
                    "purchasePrice": 512794,
                    "salePrice": 136190,
                    "totalRentalRevenue": 603036,
                    "totalOperatingCost": 312643,
                    "totalProfit": -86211,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "30.4è¬kmè™§æ"
                },
                {
                    "id": "HSR-20004",
                    "plate": "RCU-6713",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-11-09",
                    "purchasePrice": 512794,
                    "salePrice": 153333,
                    "totalRentalRevenue": 603036,
                    "totalOperatingCost": 266159,
                    "totalProfit": -22584,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "26.8è¬kmè™§æ"
                },
                {
                    "id": "HSR-20005",
                    "plate": "RCU-6715",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-11-16",
                    "purchasePrice": 512794,
                    "salePrice": 136190,
                    "totalRentalRevenue": 603036,
                    "totalOperatingCost": 397736,
                    "totalProfit": -171304,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "31.3è¬kmåš´é‡è™§æ"
                },
                {
                    "id": "HSR-20006",
                    "plate": "RCU-6716",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 202857,
                    "totalRentalRevenue": 603036,
                    "totalOperatingCost": 403156,
                    "totalProfit": -110057,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "30.7è¬kmè™§æ"
                },
                {
                    "id": "HSR-20007",
                    "plate": "RCU-6720",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-26",
                    "purchasePrice": 512794,
                    "salePrice": 170476,
                    "totalRentalRevenue": 603036,
                    "totalOperatingCost": 383830,
                    "totalProfit": -123112,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "30è¬kmè™§æ"
                },
                {
                    "id": "HSR-20008",
                    "plate": "RCU-6721",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 109524,
                    "totalRentalRevenue": 603036,
                    "totalOperatingCost": 338750,
                    "totalProfit": -138984,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "24.8è¬kmè™§æ"
                },
                {
                    "id": "HSR-20009",
                    "plate": "RCU-6723",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 126667,
                    "totalRentalRevenue": 603036,
                    "totalOperatingCost": 450339,
                    "totalProfit": -233430,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "30è¬kmåš´é‡è™§æ"
                },
                {
                    "id": "HSR-20010",
                    "plate": "RCU-6730",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 171429,
                    "totalRentalRevenue": 603036,
                    "totalOperatingCost": 351446,
                    "totalProfit": -89775,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "36.5è¬kmè™§æ"
                },
                {
                    "id": "HSR-20011",
                    "plate": "RCU-6732",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 187619,
                    "totalRentalRevenue": 603036,
                    "totalOperatingCost": 288537,
                    "totalProfit": -10676,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "23.7è¬kmå¾®å¹…è™§æ"
                },
                {
                    "id": "HSR-20012",
                    "plate": "RCU-6733",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 191429,
                    "totalRentalRevenue": 603036,
                    "totalOperatingCost": 283574,
                    "totalProfit": -1903,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "24.4è¬kmå¾®å¹…è™§æ"
                },
                {
                    "id": "HSR-20013",
                    "plate": "RCU-6735",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 171429,
                    "totalRentalRevenue": 603036,
                    "totalOperatingCost": 346717,
                    "totalProfit": -85046,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "34.1è¬kmè™§æ"
                },
                {
                    "id": "HSR-20014",
                    "plate": "RCU-6750",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 176190,
                    "totalRentalRevenue": 603036,
                    "totalOperatingCost": 393361,
                    "totalProfit": -126929,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "31.6è¬kmè™§æ"
                },
                {
                    "id": "HSR-20015",
                    "plate": "RCU-6751",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 118095,
                    "totalRentalRevenue": 603036,
                    "totalOperatingCost": 334736,
                    "totalProfit": -126399,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "30.7è¬kmè™§æ"
                },
                {
                    "id": "HSR-20016",
                    "plate": "RCU-6716",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 202857,
                    "totalRentalRevenue": 603036,
                    "totalOperatingCost": 403156,
                    "totalProfit": -110057,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "30.7è¬kmè™§æ"
                },
                {
                    "id": "HSR-20017",
                    "plate": "RCU-6716",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 202857,
                    "totalRentalRevenue": 603036,
                    "totalOperatingCost": 403156,
                    "totalProfit": -110057,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "30.7è¬kmè™§æ"
                },
                {
                    "id": "HSR-20018",
                    "plate": "RCU-6716",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 202857,
                    "totalRentalRevenue": 603036,
                    "totalOperatingCost": 403156,
                    "totalProfit": -110057,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "30.7è¬kmè™§æ"
                },
                {
                    "id": "HSR-20019",
                    "plate": "RCU-6716",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 202857,
                    "totalRentalRevenue": 603036,
                    "totalOperatingCost": 403156,
                    "totalProfit": -110057,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "30.7è¬kmè™§æ"
                },
                {
                    "id": "HSR-20020",
                    "plate": "RCU-6716",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 202857,
                    "totalRentalRevenue": 603036,
                    "totalOperatingCost": 403156,
                    "totalProfit": -110057,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "30.7è¬kmè™§æ"
                },
                {
                    "id": "HSR-20021",
                    "plate": "RCU-6716",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 202857,
                    "totalRentalRevenue": 603036,
                    "totalOperatingCost": 403156,
                    "totalProfit": -110057,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "30.7è¬kmè™§æ"
                },
                {
                    "id": "HSR-20022",
                    "plate": "RCU-6716",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 202857,
                    "totalRentalRevenue": 603036,
                    "totalOperatingCost": 403156,
                    "totalProfit": -110057,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "30.7è¬kmè™§æ"
                },
                {
                    "id": "HSR-20023",
                    "plate": "RCU-6716",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 202857,
                    "totalRentalRevenue": 603036,
                    "totalOperatingCost": 403156,
                    "totalProfit": -110057,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "30.7è¬kmè™§æ"
                },
                {
                    "id": "HSR-20024",
                    "plate": "RCU-6715",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-11-16",
                    "purchasePrice": 512794,
                    "salePrice": 136190,
                    "totalRentalRevenue": 603036,
                    "totalOperatingCost": 397736,
                    "totalProfit": -171304,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "31.3è¬kmè™§æ"
                }
            ],
            "terminatedVehicles": [
                {
                    "id": "GA-22003",
                    "plate": "TERM-001",
                    "model": "Hyundai Elantra",
                    "type": "Sedan",
                    "leaseStartDate": "2022-05-01",
                    "terminationDate": "2025-02-15",
                    "purchasePrice": 750000,
                    "rentalRevenueReceived": 1800000,
                    "terminationFeeReceived": 150000,
                    "totalOperatingCost": 1200000,
                    "totalProfit": 700000,
                    "holdingPeriod": 2.76,
                    "terminationReason": "ç§Ÿå®¢æ¥­å‹™ç¸®æ¸›",
                    "status": "terminated",
                    "notes": "æå‰è§£ç´„ï¼Œæ”¶å–é•ç´„é‡‘"
                },
                {
                    "id": "HSR-23003",
                    "plate": "TERM-002",
                    "model": "Nissan Serena",
                    "type": "MPV",
                    "leaseStartDate": "2023-01-10",
                    "terminationDate": "2025-07-20",
                    "purchasePrice": 1100000,
                    "rentalRevenueReceived": 1950000,
                    "terminationFeeReceived": 200000,
                    "totalOperatingCost": 1400000,
                    "totalProfit": 850000,
                    "holdingPeriod": 2.53,
                    "terminationReason": "ç§Ÿå®¢è½‰å‘è‡ªè³¼",
                    "status": "terminated",
                    "notes": "2.5å¹´æå‰è§£ç´„"
                },
                {
                    "id": "TRK-22003",
                    "plate": "TERM-003",
                    "model": "Mitsubishi Fuso",
                    "type": "Track",
                    "leaseStartDate": "2022-08-15",
                    "terminationDate": "2025-05-10",
                    "purchasePrice": 1800000,
                    "rentalRevenueReceived": 3200000,
                    "terminationFeeReceived": 300000,
                    "totalOperatingCost": 2400000,
                    "totalProfit": 1100000,
                    "holdingPeriod": 2.78,
                    "terminationReason": "ç§Ÿå®¢ä½µè³¼å¾Œè»ŠéšŠæ•´ä½µ",
                    "status": "terminated",
                    "notes": "å› ä¼æ¥­ä½µè³¼è€Œè§£ç´„"
                },
                {
                    "id": "VAN-23005",
                    "plate": "TERM-004",
                    "model": "Mercedes Sprinter",
                    "type": "VAN",
                    "leaseStartDate": "2023-06-20",
                    "terminationDate": "2025-03-30",
                    "purchasePrice": 1050000,
                    "rentalRevenueReceived": 1200000,
                    "terminationFeeReceived": 100000,
                    "totalOperatingCost": 950000,
                    "totalProfit": 400000,
                    "holdingPeriod": 1.78,
                    "terminationReason": "ç§Ÿå®¢ç¶“ç‡Ÿå›°é›£",
                    "status": "terminated",
                    "notes": "1.8å¹´æå‰è§£ç´„ï¼Œè™§æé¢¨éšª"
                },
                {
                    "id": "GA-23008",
                    "plate": "TERM-005",
                    "model": "Mazda CX-5",
                    "type": "SUV",
                    "leaseStartDate": "2023-03-05",
                    "terminationDate": "2025-09-15",
                    "purchasePrice": 1200000,
                    "rentalRevenueReceived": 1600000,
                    "terminationFeeReceived": 120000,
                    "totalOperatingCost": 1100000,
                    "totalProfit": 620000,
                    "holdingPeriod": 2.52,
                    "terminationReason": "ç§Ÿå®¢ä¸»å‹•æå‰çµæŸ",
                    "status": "terminated",
                    "notes": "2.5å¹´æå‰è§£ç´„"
                }
            ]
        };
        
        // åˆå§‹åŒ–
        document.getElementById('reportDate').textContent = fleetData.reportDate;
        document.getElementById('totalVehicles').textContent = fleetData.summary.totalVehicles;
        document.getElementById('activeVehicles').textContent = fleetData.summary.status.active;
        document.getElementById('idleVehicles').textContent = fleetData.summary.status.idle;
        document.getElementById('maintenanceVehicles').textContent = fleetData.summary.status.maintenance;
        document.getElementById('soldVehicles').textContent = fleetData.summary.status.sold;
        document.getElementById('terminatedVehicles').textContent = fleetData.summary.status.terminated;
        
        // æ¨™ç±¤åˆ‡æ›
        function switchTab(tabName) {
            const contents = document.querySelectorAll('.tab-content');
            const buttons = document.querySelectorAll('.tab-btn');
            
            contents.forEach(c => c.classList.remove('active'));
            buttons.forEach(b => b.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            setTimeout(() => {
                if (tabName === 'overview') initOverviewCharts();
                else if (tabName === 'trends') initTrendCharts();
                else if (tabName === 'vehicles') { initVehicleCharts(); populateVehicleTable(); }
                else if (tabName === 'sold') populateSoldTable();
                else if (tabName === 'terminated') populateTerminatedTable();
                else if (tabName === 'profitability') initProfitabilityCharts();
                else if (tabName === 'costs') initCostCharts();
            }, 100);
        }
        
        // åœ–è¡¨é…ç½®
        const chartConfig = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    labels: {
                        font: { size: 12 },
                        padding: 15
                    }
                }
            }
        };
        
        // åˆå§‹åŒ–è»ŠéšŠç¸½è¦½åœ–è¡¨
        function initOverviewCharts() {
            new Chart(document.getElementById('statusChart'), {
                type: 'doughnut',
                data: {
                    labels: ['ç§Ÿç”¨ä¸­', 'è‡ªè³¼', 'ç¶­ä¿®ä¸­', 'ä¸­é€”è§£ç´„', 'å·²å‡ºå”®'],
                    datasets: [{
                        data: [29, 1, 0, 5, 28],
                        backgroundColor: ['#51cf66', '#ffd93d', '#ff922b', '#ff6b6b', '#868e96']
                    }]
                },
                options: chartConfig
            });
            
            new Chart(document.getElementById('typeChart'), {
                type: 'doughnut',
                data: {
                    labels: ['Sedan', 'SUV', 'MPV', 'VAN'],
                    datasets: [{
                        data: [26, 1, 2, 0],
                        backgroundColor: ['#667eea', '#764ba2', '#f093fb', '#4facfe', '#00f2fe']
                    }]
                },
                options: chartConfig
            });
            
            new Chart(document.getElementById('ageChart'), {
                type: 'bar',
                data: {
                    labels: ['<1å¹´', '1-3å¹´', '3-5å¹´', '>5å¹´'],
                    datasets: [{
                        label: 'è»Šè¼›å°æ•¸',
                        data: [0, 27, 2, 0],
                        backgroundColor: '#667eea'
                    }]
                },
                options: chartConfig
            });
            
            new Chart(document.getElementById('typePerformanceChart'), {
                type: 'bar',
                data: {
                    labels: ['Sedan', 'SUV', 'MPV', 'VAN'],
                    datasets: [
                        {
                            label: 'åˆ©æ½¤ç‡ (%)',
                            data: [12.5, 15.8, 18.2, 10.5, 22.4],
                            backgroundColor: '#667eea'
                        }
                    ]
                },
                options: chartConfig
            });
        }
        
        // åˆå§‹åŒ–å¹´åº¦è¶¨å‹¢åœ–è¡¨
        function initTrendCharts() {
            const years = fleetData.yearlyTrend.map(y => y.year);
            const revenues = fleetData.yearlyTrend.map(y => y.revenue / 1000000);
            const expenses = fleetData.yearlyTrend.map(y => y.expense / 1000000);
            const profits = fleetData.yearlyTrend.map(y => y.profit / 1000000);
            
            new Chart(document.getElementById('revenueChart'), {
                type: 'line',
                data: {
                    labels: years,
                    datasets: [
                        {
                            label: 'æ”¶ç›Š',
                            data: revenues,
                            borderColor: '#51cf66',
                            backgroundColor: 'rgba(81, 207, 102, 0.1)',
                            tension: 0.4,
                            fill: true
                        },
                        {
                            label: 'æˆæœ¬',
                            data: expenses,
                            borderColor: '#ff6b6b',
                            backgroundColor: 'rgba(255, 107, 107, 0.1)',
                            tension: 0.4,
                            fill: true
                        },
                        {
                            label: 'æ·¨åˆ©',
                            data: profits,
                            borderColor: '#667eea',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            tension: 0.4,
                            fill: true
                        }
                    ]
                },
                options: chartConfig
            });
            
            new Chart(document.getElementById('claimRateChart'), {
                type: 'line',
                data: {
                    labels: years,
                    datasets: [{
                        label: 'å‡ºéšªç‡ (%)',
                        data: fleetData.yearlyTrend.map(y => y.claimRate),
                        borderColor: '#ff922b',
                        backgroundColor: 'rgba(255, 146, 43, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: chartConfig
            });
            
            new Chart(document.getElementById('utilizationChart'), {
                type: 'line',
                data: {
                    labels: years,
                    datasets: [{
                        label: 'ä½¿ç”¨ç‡ (%)',
                        data: fleetData.yearlyTrend.map(y => y.utilization),
                        borderColor: '#4facfe',
                        backgroundColor: 'rgba(79, 172, 254, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: chartConfig
            });
            
            new Chart(document.getElementById('profitTrendChart'), {
                type: 'bar',
                data: {
                    labels: years,
                    datasets: [{
                        label: 'å¹´åº¦æ·¨åˆ© (ç™¾è¬å…ƒ)',
                        data: profits,
                        backgroundColor: years.map((y, i) => fleetData.yearlyTrend[i].forecast ? '#ffd93d' : '#667eea')
                    }]
                },
                options: chartConfig
            });
        }
        
        // åˆå§‹åŒ–è»Šè¼›åˆ†æåœ–è¡¨
        function initVehicleCharts() {
            const vehicles = fleetData.expiringVehicles;
            
            new Chart(document.getElementById('expiryTimelineChart'), {
                type: 'bar',
                data: {
                    labels: vehicles.map(v => v.id),
                    datasets: [{
                        label: 'è·é›¢åˆ°æœŸå¤©æ•¸',
                        data: vehicles.map(v => Math.ceil((new Date(v.leaseEnd) - new Date()) / (1000 * 60 * 60 * 24))),
                        backgroundColor: vehicles.map(v => {
                            if (v.status === 'critical') return '#ff6b6b';
                            if (v.status === 'warning') return '#ffd93d';
                            return '#51cf66';
                        })
                    }]
                },
                options: chartConfig
            });
            
            new Chart(document.getElementById('expiryProfitChart'), {
                type: 'bar',
                data: {
                    labels: vehicles.map(v => v.id),
                    datasets: [{
                        label: 'æ·¨åˆ© (è¬å…ƒ)',
                        data: vehicles.map(v => v.profit / 10000),
                        backgroundColor: vehicles.map(v => v.profit > 0 ? '#51cf66' : '#ff6b6b')
                    }]
                },
                options: chartConfig
            });
        }
        
        // å¡«å……è»Šè¼›è¡¨æ ¼
        function populateVehicleTable() {
            const tbody = document.getElementById('vehicleTableBody');
            tbody.innerHTML = '';
            
            fleetData.expiringVehicles.forEach(v => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${v.id}</td>
                    <td>${v.plate}</td>
                    <td>${v.type}</td>
                    <td>${v.leaseEnd}</td>
                    <td>$${(v.revenue / 1000000).toFixed(2)}M</td>
                    <td>$${(v.cost / 1000000).toFixed(2)}M</td>
                    <td>$${(v.profit / 10000).toFixed(0)}è¬</td>
                    <td>${v.margin.toFixed(1)}%</td>
                    <td>${v.utilization}%</td>
                    <td><span class="status-badge status-${v.status}">${v.status === 'critical' ? 'ğŸ”´ ç·Šæ€¥' : v.status === 'warning' ? 'ğŸŸ¡ è­¦ç¤º' : 'ğŸŸ¢ ä¸€èˆ¬'}</span></td>
                    <td>${v.recommendation}</td>
                `;
            });
        }

        // å¡«å……å·²å‡ºå”®è»Šè¼›è¡¨æ ¼
        function populateSoldTable() {
            const tbody = document.getElementById('soldTableBody');
            tbody.innerHTML = '';
            
            let totalPurchase = 0, totalSale = 0, totalRental = 0, totalCost = 0, totalProfit = 0;
            
            fleetData.soldVehicles.forEach(v => {
                totalPurchase += v.purchasePrice;
                totalSale += v.salePrice;
                totalRental += v.totalRentalRevenue;
                totalCost += v.totalOperatingCost;
                totalProfit += v.totalProfit;
                
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${v.id}</td>
                    <td>${v.plate}</td>
                    <td>${v.type}</td>
                    <td>${v.purchaseDate}</td>
                    <td>${v.saleDate}</td>
                    <td>$${(v.purchasePrice / 1000000).toFixed(2)}M</td>
                    <td>$${(v.salePrice / 1000000).toFixed(2)}M</td>
                    <td>$${(v.totalRentalRevenue / 1000000).toFixed(2)}M</td>
                    <td>$${(v.totalOperatingCost / 1000000).toFixed(2)}M</td>
                    <td class="profit-positive">$${(v.totalProfit / 10000).toFixed(0)}è¬</td>
                    <td>${v.holdingPeriod.toFixed(1)}å¹´</td>
                    <td>${v.notes}</td>
                `;
            });
            
            document.getElementById('soldCount').textContent = fleetData.soldVehicles.length;
            document.getElementById('soldTotalPurchase').textContent = '$' + (totalPurchase / 1000000).toFixed(1) + 'M';
            document.getElementById('soldTotalSale').textContent = '$' + (totalSale / 1000000).toFixed(2) + 'M';
            document.getElementById('soldTotalRental').textContent = '$' + (totalRental / 1000000).toFixed(1) + 'M';
            document.getElementById('soldTotalCost').textContent = '$' + (totalCost / 1000000).toFixed(2) + 'M';
            document.getElementById('soldTotalProfit').textContent = '$' + (totalProfit / 1000000).toFixed(2) + 'M';
        }

        // å¡«å……è§£ç´„è»Šè¼›è¡¨æ ¼
        function populateTerminatedTable() {
            const tbody = document.getElementById('terminatedTableBody');
            tbody.innerHTML = '';
            
            let totalPurchase = 0, totalRental = 0, totalFee = 0, totalCost = 0, totalProfit = 0;
            
            fleetData.terminatedVehicles.forEach(v => {
                totalPurchase += v.purchasePrice;
                totalRental += v.rentalRevenueReceived;
                totalFee += v.terminationFeeReceived;
                totalCost += v.totalOperatingCost;
                totalProfit += v.totalProfit;
                
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${v.id}</td>
                    <td>${v.plate}</td>
                    <td>${v.type}</td>
                    <td>${v.leaseStartDate}</td>
                    <td>${v.terminationDate}</td>
                    <td>$${(v.purchasePrice / 1000000).toFixed(2)}M</td>
                    <td>$${(v.rentalRevenueReceived / 1000000).toFixed(2)}M</td>
                    <td>$${(v.terminationFeeReceived / 10000).toFixed(0)}è¬</td>
                    <td>$${(v.totalOperatingCost / 1000000).toFixed(2)}M</td>
                    <td class="profit-positive">$${(v.totalProfit / 10000).toFixed(0)}è¬</td>
                    <td>${v.holdingPeriod.toFixed(1)}å¹´</td>
                    <td>${v.terminationReason}</td>
                    <td>${v.notes}</td>
                `;
            });
            
            document.getElementById('termCount').textContent = fleetData.terminatedVehicles.length;
            document.getElementById('termTotalPurchase').textContent = '$' + (totalPurchase / 1000000).toFixed(1) + 'M';
            document.getElementById('termTotalRental').textContent = '$' + (totalRental / 1000000).toFixed(2) + 'M';
            document.getElementById('termTotalFee').textContent = '$' + (totalFee / 1000000).toFixed(2) + 'M';
            document.getElementById('termTotalCost').textContent = '$' + (totalCost / 1000000).toFixed(2) + 'M';
            document.getElementById('termTotalProfit').textContent = '$' + (totalProfit / 1000000).toFixed(2) + 'M';
        }
        
        // è»Šè¼›éæ¿¾
        function filterVehicles() {
            const searchText = document.getElementById('searchVehicle').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;
            
            const rows = document.querySelectorAll('#vehicleTableBody tr');
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                const status = row.querySelector('.status-badge').className.includes(statusFilter) || statusFilter === '';
                row.style.display = (text.includes(searchText) && status) ? '' : 'none';
            });
        }
        
        // åˆå§‹åŒ–å€‹åˆ¥æç›Šåœ–è¡¨
        function initProfitabilityCharts() {
            const vehicles = fleetData.expiringVehicles;
            
            new Chart(document.getElementById('vehicleComparisonChart'), {
                type: 'bar',
                data: {
                    labels: vehicles.map(v => v.id),
                    datasets: [
                        {
                            label: 'æ”¶ç›Š',
                            data: vehicles.map(v => v.revenue / 1000000),
                            backgroundColor: '#51cf66'
                        },
                        {
                            label: 'æˆæœ¬',
                            data: vehicles.map(v => v.cost / 1000000),
                            backgroundColor: '#ff6b6b'
                        },
                        {
                            label: 'æ·¨åˆ©',
                            data: vehicles.map(v => v.profit / 1000000),
                            backgroundColor: '#667eea'
                        }
                    ]
                },
                options: chartConfig
            });
            
            new Chart(document.getElementById('marginRankChart'), {
                type: 'bar',
                data: {
                    labels: vehicles.map(v => v.id),
                    datasets: [{
                        label: 'åˆ©æ½¤ç‡ (%)',
                        data: vehicles.map(v => v.margin),
                        backgroundColor: vehicles.map(v => v.margin > 0 ? '#51cf66' : '#ff6b6b')
                    }]
                },
                options: {
                    ...chartConfig,
                    indexAxis: 'y'
                }
            });
            
            new Chart(document.getElementById('scatterChart'), {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'è»Šè¼›ç¸¾æ•ˆ',
                        data: vehicles.map(v => ({x: v.utilization, y: v.margin})),
                        backgroundColor: vehicles.map(v => {
                            if (v.status === 'critical') return '#ff6b6b';
                            if (v.status === 'warning') return '#ffd93d';
                            return '#51cf66';
                        }),
                        pointRadius: 8
                    }]
                },
                options: {
                    ...chartConfig,
                    scales: {
                        x: { title: { display: true, text: 'ä½¿ç”¨ç‡ (%)' } },
                        y: { title: { display: true, text: 'åˆ©æ½¤ç‡ (%)' } }
                    }
                }
            });
        }
        
        // åˆå§‹åŒ–æˆæœ¬çµæ§‹åœ–è¡¨
        function initCostCharts() {
            new Chart(document.getElementById('costStructureChart'), {
                type: 'doughnut',
                data: {
                    labels: ['è³¼è»Š', 'ç¨…é‡‘', 'ç¶­ä¿®', 'ä¿è²»', 'å…¶ä»–'],
                    datasets: [{
                        data: [45.0, 12.5, 18.5, 15.0, 9.0],
                        backgroundColor: ['#667eea', '#764ba2', '#f093fb', '#4facfe', '#868e96']
                    }]
                },
                options: chartConfig
            });
            
            new Chart(document.getElementById('typeMarginChart'), {
                type: 'bar',
                data: {
                    labels: fleetData.typePerformance.map(t => t.type),
                    datasets: [{
                        label: 'åˆ©æ½¤ç‡ (%)',
                        data: fleetData.typePerformance.map(t => t.profitMargin),
                        backgroundColor: '#667eea'
                    }]
                },
                options: chartConfig
            });
            
            new Chart(document.getElementById('costStackChart'), {
                type: 'bar',
                data: {
                    labels: fleetData.expiringVehicles.map(v => v.id),
                    datasets: [{
                        label: 'æˆæœ¬ (ç™¾è¬å…ƒ)',
                        data: fleetData.expiringVehicles.map(v => v.cost / 1000000),
                        backgroundColor: '#667eea'
                    }]
                },
                options: chartConfig
            });
        }
        
        // åˆå§‹åŒ–é¦–é åœ–è¡¨
        initOverviewCharts();
    </script>
</body>
              </html>
