<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÈÄ≤ÈöéËªäÈöäÁáüÈÅãÁ∏æÊïàÂ†±Ë°®</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .tabs {
            display: flex;
            background: #f5f5f5;
            border-bottom: 2px solid #ddd;
            overflow-x: auto;
        }
        
        .tab-btn {
            flex: 1;
            padding: 15px 20px;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 1em;
            color: #666;
            transition: all 0.3s;
            white-space: nowrap;
            min-width: 150px;
        }
        
        .tab-btn:hover {
            background: #e0e0e0;
            color: #333;
        }
        
        .tab-btn.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
            font-weight: bold;
        }
        
        .content {
            padding: 30px;
            min-height: 600px;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .stat-card h3 {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 10px;
        }
        
        .stat-card .value {
            font-size: 2em;
            font-weight: bold;
        }
        
        .stat-card .unit {
            font-size: 0.8em;
            opacity: 0.8;
            margin-top: 5px;
        }
        
        .chart-container {
            position: relative;
            height: 400px;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .chart-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        @media (max-width: 1024px) {
            .chart-row {
                grid-template-columns: 1fr;
            }
        }
        
        .table-container {
            overflow-x: auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95em;
        }
        
        th {
            background: #667eea;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        
        td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }
        
        tr:hover {
            background: #f9f9f9;
        }
        
        .status-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }
        
        .status-critical {
            background: #ff6b6b;
            color: white;
        }
        
        .status-warning {
            background: #ffd93d;
            color: #333;
        }
        
        .status-normal {
            background: #51cf66;
            color: white;
        }
        
        .status-completed {
            background: #868e96;
            color: white;
        }
        
        .status-terminated {
            background: #ff922b;
            color: white;
        }
        
        .search-filter {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .search-filter input,
        .search-filter select {
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 0.95em;
        }
        
        .search-filter input {
            flex: 1;
            min-width: 200px;
        }
        
        .footer {
            background: #f5f5f5;
            padding: 20px;
            text-align: center;
            color: #666;
            font-size: 0.9em;
            border-top: 1px solid #ddd;
        }
        
        .legend {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 20px;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 5px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
        }

        .profit-positive {
            color: #51cf66;
            font-weight: bold;
        }

        .profit-negative {
            color: #ff6b6b;
            font-weight: bold;
        }

        .summary-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .summary-box h3 {
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .summary-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .summary-item {
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 5px;
            text-align: center;
        }

        .summary-item .label {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .summary-item .value {
            font-size: 1.5em;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üëÆ ËªäÈöäÁ∏æÊïàÁÆ°ÁêÜÂ†±Ë°®</h1>
            <p>JBD Dept.</p>
        </div>
        
        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('overview')">üìä Á∏ΩË¶Ω</button>
            <button class="tab-btn" onclick="switchTab('trends')">üìà È¢®Èö™</button>
            <button class="tab-btn" onclick="switchTab('vehicles')">üöô ÁßüË≥É</button>
            <button class="tab-btn" onclick="switchTab('sold')">‚úÖ Âá∫ÂîÆ</button>
            <button class="tab-btn" onclick="switchTab('terminated')">‚õî Áï∞Â∏∏</button>
            <button class="tab-btn" onclick="switchTab('profitability')">üí∞ ÂÄãÂà•ÊêçÁõä</button>
            <button class="tab-btn" onclick="switchTab('costs')">üîß ÊàêÊú¨ÁµêÊßã</button>
        </div>
        
        <div class="content">
            <!-- Á∏ΩË¶Ω -->
            <div id="overview" class="tab-content active">
                <h2 style="margin-bottom: 20px;">ÁèæÊ≥Å</h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>‰øùÊúâ</h3>
                        <div class="value" id="totalVehicles"></div>
                        <div class="unit">Âè∞</div>
                    </div>
                    <div class="stat-card">
                        <h3>ÊâøÁßü</h3>
                        <div class="value" id="activeVehicles"></div>
                        <div class="unit">Âè∞</div>
                    </div>
                    <div class="stat-card">
                        <h3>Ëá™Ë≥º</h3>
                        <div class="value" id="idleVehicles"></div>
                        <div class="unit">Âè∞</div>
                    </div>
                    <div class="stat-card">
                        <h3>Á∂≠‰øÆ</h3>
                        <div class="value" id="maintenanceVehicles">0</div>
                        <div class="unit">Âè∞</div>
                    </div>
                    <div class="stat-card">
                        <h3>Âá∫ÂîÆ</h3>
                        <div class="value" id="soldVehicles"></div>
                        <div class="unit">Âè∞</div>
                    </div>
                    <div class="stat-card">
                        <h3>Ëß£Á¥Ñ</h3>
                        <div class="value" id="terminatedVehicles"></div>
                        <div class="unit">Âè∞</div>
                    </div>
                    <div class="stat-card">
                        <h3>Âπ≥ÂùáÊúàÊî∂Áõä</h3>
                        <div class="value" id="avgMonthlyRevenue"></div>
                        <div class="unit">NTD</div>
                    </div>
                    <div class="stat-card">
                        <h3>Âπ≥ÂùáÊúàÊàêÊú¨</h3>
                        <div class="value" id="avgMonthlyExpense"></div>
                        <div class="unit">NTD</div>
                    </div>
                    <div class="stat-card">
                        <h3>Êï¥È´î‰ΩøÁî®Áéá</h3>
                        <div class="value" id="utilizationRate"></div>
                        <div class="unit">%</div>
                    </div>
                </div>
            </div>

            <!-- È¢®Èö™ -->
            <div id="trends" class="tab-content">
                <h2 style="margin-bottom: 20px;">Âπ¥Â∫¶Ë∂®Âã¢ËàáÈ¢®Èö™Ë©ï‰º∞</h2>
                <div class="chart-row">
                    <div class="chart-container">
                        <canvas id="yearlyTrendChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="claimRateChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- ÁßüË≥É -->
            <div id="vehicles" class="tab-content">
                <h2 style="margin-bottom: 20px;">‰ΩøÁî®‰∏≠ËªäËºõ</h2>
                <div class="search-filter">
                    <input type="text" id="vehicleSearch" placeholder="ÊêúÂ∞ãËªäÁâå„ÄÅËªäÂûã...">
                    <select id="statusFilter">
                        <option value="all">ÊâÄÊúâÁãÄÊÖã</option>
                        <option value="normal">Ê≠£Â∏∏</option>
                        <option value="warning">Ë≠¶Âëä</option>
                        <option value="critical">Âç±Èö™</option>
                    </select>
                    <select id="typeFilter">
                        <option value="all">ÊâÄÊúâÈ°ûÂûã</option>
                        <option value="Sedan">ËΩéËªä</option>
                        <option value="SUV">‰ºëÊóÖËªä</option>
                        <option value="MPV">ÂªÇÂûãËªä</option>
                    </select>
                </div>
                <div class="table-container">
                    <table id="activeVehiclesTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>ËªäÁâå</th>
                                <th>ËªäÂûã</th>
                                <th>È°ûÂûã</th>
                                <th>Ëµ∑ÁßüÊó•Êúü</th>
                                <th>ÊåÅÊúâÊúàÊï∏</th>
                                <th>ÁßüÁ¥ÑÂà∞ÊúüÊó•</th>
                                <th>Á¥ØË®àÁ∏ΩÊî∂Áõä</th>
                                <th>Á¥ØË®àÁ∏ΩÊàêÊú¨</th>
                                <th>ÊúàÂùáÊ∑®Âà©</th>
                                <th>Âà©ÊΩ§Áéá (%)</th>
                                <th>‰ΩøÁî®Áéá (%)</th>
                                <th>ÁãÄÊÖã</th>
                                <th>Âª∫Ë≠∞</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Data will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Âá∫ÂîÆ -->
            <div id="sold" class="tab-content">
                <h2 style="margin-bottom: 20px;">Â∑≤Âá∫ÂîÆËªäËºõ</h2>
                <div class="table-container">
                    <table id="soldVehiclesTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>ËªäÁâå</th>
                                <th>ËªäÂûã</th>
                                <th>È°ûÂûã</th>
                                <th>Ë≥ºÂÖ•Êó•Êúü</th>
                                <th>Âá∫ÂîÆÊó•Êúü</th>
                                <th>Ë≥ºÂÖ•ÂÉπ</th>
                                <th>Âá∫ÂîÆÂÉπ</th>
                                <th>Á∏ΩÁßüÈáëÊî∂ÂÖ•</th>
                                <th>Á∏ΩÁáüÈÅãÊàêÊú¨</th>
                                <th>Á∏ΩÊêçÁõä</th>
                                <th>ÊåÅÊúâÊúüÈñì (Âπ¥)</th>
                                <th>ÂÇôË®ª</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Data will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Áï∞Â∏∏ -->
            <div id="terminated" class="tab-content">
                <h2 style="margin-bottom: 20px;">Ëß£Á¥ÑËªäËºõ</h2>
                <div class="table-container">
                    <table id="terminatedVehiclesTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>ËªäÁâå</th>
                                <th>ËªäÂûã</th>
                                <th>È°ûÂûã</th>
                                <th>Ëµ∑ÁßüÊó•Êúü</th>
                                <th>Ëß£Á¥ÑÊó•Êúü</th>
                                <th>Ë≥ºÂÖ•ÂÉπ</th>
                                <th>ÁßüÈáëÊî∂ÂÖ•</th>
                                <th>Ëß£Á¥ÑÈáë</th>
                                <th>Á∏ΩÁáüÈÅãÊàêÊú¨</th>
                                <th>Á∏ΩÊêçÁõä</th>
                                <th>ÊåÅÊúâÊúüÈñì (Âπ¥)</th>
                                <th>Ëß£Á¥ÑÂéüÂõ†</th>
                                <th>ÂÇôË®ª</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Data will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ÂÄãÂà•ÊêçÁõä -->
            <div id="profitability" class="tab-content">
                <h2 style="margin-bottom: 20px;">ÂÄãÂà•ËªäËºõÊêçÁõäÂàÜÊûê</h2>
                <div class="legend">
                    <div class="legend-item"><span class="legend-color status-normal"></span> Âà©ÊΩ§Áéá > 30%</div>
                    <div class="legend-item"><span class="legend-color status-warning"></span> Âà©ÊΩ§Áéá 10% - 30%</div>
                    <div class="legend-item"><span class="legend-color status-critical"></span> Âà©ÊΩ§Áéá < 10%</div>
                </div>
                <div class="table-container">
                    <table id="profitabilityTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>ËªäÁâå</th>
                                <th>ËªäÂûã</th>
                                <th>È°ûÂûã</th>
                                <th>Á¥ØË®àÁ∏ΩÊî∂Áõä</th>
                                <th>Á¥ØË®àÁ∏ΩÊàêÊú¨</th>
                                <th>ÊúàÂùáÊ∑®Âà©</th>
                                <th>Âà©ÊΩ§Áéá (%)</th>
                                <th>‰ΩøÁî®Áéá (%)</th>
                                <th>ÁãÄÊÖã</th>
                                <th>Âª∫Ë≠∞</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Data will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ÊàêÊú¨ÁµêÊßã -->
            <div id="costs" class="tab-content">
                <h2 style="margin-bottom: 20px;">ÊàêÊú¨ÁµêÊßãÂàÜÊûê</h2>
                <div class="chart-container">
                    <canvas id="costBreakdownChart"></canvas>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>&copy; 2026 JBD Dept. All rights reserved.</p>
        </div>
    </div>

    <script>
        // Injected fleetData from Python script
        const fleetData = {
    "reportInfo": {
        "reportDate": "2026-03-01",
        "reportTitle": "üëÆËªäÈöäÂ†±Ë°®",
        "company": " JBD Dept. "
    },
    "summary": {
        "totalVehicles": 52,
        "status": {
            "active": 21,
            "idle": 0,
            "sold": 27,
            "terminated": 4
        },
        "avgMonthlyRevenue": 0,
        "avgMonthlyExpense": 0,
        "utilizationRate": 0
    },
    "yearlyTrend": [
        {
            "year": 2021,
            "revenue": 5774563,
            "expense": 3934790,
            "profit": 1839773,
            "claimRate": 0.42,
            "utilization": 92.5
        },
        {
            "year": 2022,
            "revenue": 7085577,
            "expense": 4077142,
            "profit": 3008435,
            "claimRate": 0.44,
            "utilization": 94.1
        },
        {
            "year": 2023,
            "revenue": 8744272,
            "expense": 3694609,
            "profit": 5049663,
            "claimRate": 1.44,
            "utilization": 95.8
        },
        {
            "year": 2024,
            "revenue": 9306029,
            "expense": 3202077,
            "profit": 6103952,
            "claimRate": 0.74,
            "utilization": 96.2
        },
        {
            "year": 2025,
            "revenue": 8595524,
            "expense": 3158363,
            "profit": 5437161,
            "claimRate": 0.67,
            "utilization": 96.7
        },
        {
            "year": 2026,
            "revenue": 8854422,
            "expense": 2858841,
            "profit": 5234191,
            "claimRate": 0.69,
            "utilization": 96.7
        },
        {
            "year": 2027,
            "revenue": 8499354,
            "expense": 3026021,
            "profit": 5473333,
            "claimRate": 0.64,
            "utilization": 100
        },
        {
            "year": 2028,
            "revenue": 9533640,
            "expense": 4000000,
            "profit": 5533640,
            "claimRate": 0.6,
            "utilization": 100
        },
        {
            "year": 2029,
            "revenue": 9533640,
            "expense": 4000000,
            "profit": 5533600,
            "claimRate": 0.55,
            "utilization": 100
        },
        {
            "year": 2030,
            "revenue": 9533640,
            "expense": 4000000,
            "profit": 5533600,
            "claimRate": 0.48,
            "utilization": 100
        }
    ],
    "expiringVehicles": [
        {
            "id": "HSR-23006",
            "plate": "RFA-8193",
            "model": "Toyota Vios",
            "type": "Sedan",
            "leaseEnd": "2026-04-30",
            "revenue": 768000,
            "cost": 919000,
            "profit": 38000,
            "margin": 20.8,
            "utilization": 55.3,
            "status": "critical",
            "recommendation": "Â∑°ÈÇèËªäÈ´òÁ®ºÂãï,Â¶ÇÊúüÊõ¥Êñ∞",
            "leaseStartDate": "2023-09-01",
            "monthsHeld": 30,
            "avgMonthlyRevenue": 25600.0,
            "avgMonthlyCost": 30633.33,
            "avgMonthlyProfit": -5033.33
        },
        {
            "id": "HSR-23007",
            "plate": "RFA-8197",
            "model": "Toyota Vios",
            "type": "Sedan",
            "leaseEnd": "2026-04-30",
            "revenue": 768000,
            "cost": 919000,
            "profit": 38000,
            "margin": 20.8,
            "utilization": 55.3,
            "status": "critical",
            "recommendation": "Â∑°ÈÇèËªäÈ´òÁ®ºÂãï,Â¶ÇÊúüÊõ¥Êñ∞",
            "leaseStartDate": "2023-09-01",
            "monthsHeld": 30,
            "avgMonthlyRevenue": 25600.0,
            "avgMonthlyCost": 30633.33,
            "avgMonthlyProfit": -5033.33
        },
        {
            "id": "HSR-23008",
            "plate": "RFA-8201",
            "model": "Toyota Vios",
            "type": "Sedan",
            "leaseEnd": "2026-04-30",
            "revenue": 768000,
            "cost": 919000,
            "profit": 38000,
            "margin": 20.8,
            "utilization": 55.3,
            "status": "critical",
            "recommendation": "Â∑°ÈÇèËªäÈ´òÁ®ºÂãï,Â¶ÇÊúüÊõ¥Êñ∞",
            "leaseStartDate": "2023-09-01",
            "monthsHeld": 30,
            "avgMonthlyRevenue": 25600.0,
            "avgMonthlyCost": 30633.33,
            "avgMonthlyProfit": -5033.33
        },
        {
            "id": "HSR-23009",
            "plate": "RFA-8202",
            "model": "Toyota Vios",
            "type": "Sedan",
            "leaseEnd": "2026-04-30",
            "revenue": 768000,
            "cost": 919000,
            "profit": 38000,
            "margin": 20.8,
            "utilization": 55.3,
            "status": "critical",
            "recommendation": "Â∑°ÈÇèËªäÈ´òÁ®ºÂãï,Â¶ÇÊúüÊõ¥Êñ∞",
            "leaseStartDate": "2023-09-01",
            "monthsHeld": 30,
            "avgMonthlyRevenue": 25600.0,
            "avgMonthlyCost": 30633.33,
            "avgMonthlyProfit": -5033.33
        },
        {
            "id": "HSR-23010",
            "plate": "RFA-8203",
            "model": "Toyota Vios",
            "type": "Sedan",
            "leaseEnd": "2026-04-30",
            "revenue": 768000,
            "cost": 919000,
            "profit": 38000,
            "margin": 20.8,
            "utilization": 55.3,
            "status": "critical",
            "recommendation": "Â∑°ÈÇèËªäÈ´òÁ®ºÂãï,Â¶ÇÊúüÊõ¥Êñ∞",
            "leaseStartDate": "2023-09-01",
            "monthsHeld": 30,
            "avgMonthlyRevenue": 25600.0,
            "avgMonthlyCost": 30633.33,
            "avgMonthlyProfit": -5033.33
        },
        {
            "id": "HSR-23011",
            "plate": "RFA-8205",
            "model": "Toyota Vios",
            "type": "Sedan",
            "leaseEnd": "2026-04-30",
            "revenue": 768000,
            "cost": 919000,
            "profit": 38000,
            "margin": 20.8,
            "utilization": 55.3,
            "status": "critical",
            "recommendation": "Â∑°ÈÇèËªäÈ´òÁ®ºÂãï,Â¶ÇÊúüÊõ¥Êñ∞",
            "leaseStartDate": "2023-09-01",
            "monthsHeld": 30,
            "avgMonthlyRevenue": 25600.0,
            "avgMonthlyCost": 30633.33,
            "avgMonthlyProfit": -5033.33
        },
        {
            "id": "HSR-23012",
            "plate": "RFA-8210",
            "model": "Toyota Vios",
            "type": "Sedan",
            "leaseEnd": "2026-04-30",
            "revenue": 768000,
            "cost": 919000,
            "profit": 38000,
            "margin": 20.8,
            "utilization": 55.3,
            "status": "critical",
            "recommendation": "Â∑°ÈÇèËªäÈ´òÁ®ºÂãï,Â¶ÇÊúüÊõ¥Êñ∞",
            "leaseStartDate": "2023-09-01",
            "monthsHeld": 30,
            "avgMonthlyRevenue": 25600.0,
            "avgMonthlyCost": 30633.33,
            "avgMonthlyProfit": -5033.33
        },
        {
            "id": "HSR-23013",
            "plate": "RFA-8211",
            "model": "Toyota Vios",
            "type": "Sedan",
            "leaseEnd": "2026-04-30",
            "revenue": 768000,
            "cost": 919000,
            "profit": 38000,
            "margin": 20.8,
            "utilization": 55.3,
            "status": "critical",
            "recommendation": "Â∑°ÈÇèËªäÈ´òÁ®ºÂãï,Â¶ÇÊúüÊõ¥Êñ∞",
            "leaseStartDate": "2023-09-01",
            "monthsHeld": 30,
            "avgMonthlyRevenue": 25600.0,
            "avgMonthlyCost": 30633.33,
            "avgMonthlyProfit": -5033.33
        },
        {
            "id": "HSR-23014",
            "plate": "RFA-8215",
            "model": "Toyota Vios",
            "type": "Sedan",
            "leaseEnd": "2026-04-30",
            "revenue": 768000,
            "cost": 919000,
            "profit": 38000,
            "margin": 20.8,
            "utilization": 55.3,
            "status": "critical",
            "recommendation": "Â∑°ÈÇèËªäÈ´òÁ®ºÂãï,Â¶ÇÊúüÊõ¥Êñ∞",
            "leaseStartDate": "2023-09-01",
            "monthsHeld": 30,
            "avgMonthlyRevenue": 25600.0,
            "avgMonthlyCost": 30633.33,
            "avgMonthlyProfit": -5033.33
        },
        {
            "id": "HSR-23015",
            "plate": "RFA-8219",
            "model": "Toyota Vios",
            "type": "Sedan",
            "leaseEnd": "2026-04-30",
            "revenue": 768000,
            "cost": 919000,
            "profit": 38000,
            "margin": 20.8,
            "utilization": 55.3,
            "status": "critical",
            "recommendation": "Â∑°ÈÇèËªäÈ´òÁ®ºÂãï,Â¶ÇÊúüÊõ¥Êñ∞",
            "leaseStartDate": "2023-09-01",
            "monthsHeld": 30,
            "avgMonthlyRevenue": 25600.0,
            "avgMonthlyCost": 30633.33,
            "avgMonthlyProfit": -5033.33
        },
        {
            "id": "HSR-23016",
            "plate": "RFA-8223",
            "model": "Toyota Vios",
            "type": "Sedan",
            "leaseEnd": "2026-04-30",
            "revenue": 768000,
            "cost": 919000,
            "profit": 38000,
            "margin": 20.8,
            "utilization": 55.3,
            "status": "critical",
            "recommendation": "Â∑°ÈÇèËªäÈ´òÁ®ºÂãï,Â¶ÇÊúüÊõ¥Êñ∞",
            "leaseStartDate": "2023-09-01",
            "monthsHeld": 30,
            "avgMonthlyRevenue": 25600.0,
            "avgMonthlyCost": 30633.33,
            "avgMonthlyProfit": -5033.33
        },
        {
            "id": "HSR-23017",
            "plate": "RFA-8225",
            "model": "Toyota Vios",
            "type": "Sedan",
            "leaseEnd": "2026-04-30",
            "revenue": 768000,
            "cost": 919000,
            "profit": 38000,
            "margin": 20.8,
            "utilization": 55.3,
            "status": "critical",
            "recommendation": "Â∑°ÈÇèËªäÈ´òÁ®ºÂãï,Â¶ÇÊúüÊõ¥Êñ∞",
            "leaseStartDate": "2023-09-01",
            "monthsHeld": 30,
            "avgMonthlyRevenue": 25600.0,
            "avgMonthlyCost": 30633.33,
            "avgMonthlyProfit": -5033.33
        },
        {
            "id": "HSR-23018",
            "plate": "RFA-8230",
            "model": "Toyota Vios",
            "type": "Sedan",
            "leaseEnd": "2026-04-30",
            "revenue": 768000,
            "cost": 919000,
            "profit": 38000,
            "margin": 20.8,
            "utilization": 55.3,
            "status": "critical",
            "recommendation": "Â∑°ÈÇèËªäÈ´òÁ®ºÂãï,Â¶ÇÊúüÊõ¥Êñ∞",
            "leaseStartDate": "2023-09-01",
            "monthsHeld": 30,
            "avgMonthlyRevenue": 25600.0,
            "avgMonthlyCost": 30633.33,
            "avgMonthlyProfit": -5033.33
        },
        {
            "id": "HSR-23019",
            "plate": "RFA-8232",
            "make": "Toyota",
            "model": "Vios",
            "type": "Sedan",
            "leaseEnd": "2026-04-30",
            "revenue": 768000,
            "cost": 919000,
            "profit": 38000,
            "margin": 20.8,
            "utilization": 55.3,
            "status": "critical",
            "recommendation": "Â∑°ÈÇèËªäÈ´òÁ®ºÂãï,Â¶ÇÊúüÊõ¥Êñ∞",
            "leaseStartDate": "2023-09-01",
            "monthsHeld": 30,
            "avgMonthlyRevenue": 25600.0,
            "avgMonthlyCost": 30633.33,
            "avgMonthlyProfit": -5033.33
        },
        {
            "id": "HSR-23020",
            "plate": "RFA-8235",
            "model": "Toyota Vios",
            "type": "Sedan",
            "leaseEnd": "2026-04-30",
            "revenue": 768000,
            "cost": 919000,
            "profit": 38000,
            "margin": 20.8,
            "utilization": 55.3,
            "status": "critical",
            "recommendation": "Â∑°ÈÇèËªäÈ´òÁ®ºÂãï,Â¶ÇÊúüÊõ¥Êñ∞",
            "leaseStartDate": "2023-09-01",
            "monthsHeld": 30,
            "avgMonthlyRevenue": 25600.0,
            "avgMonthlyCost": 30633.33,
            "avgMonthlyProfit": -5033.33
        },
        {
            "id": "HSR-23021",
            "plate": "RFA-8237",
            "model": "Toyota Vios",
            "type": "Sedan",
            "leaseEnd": "2026-04-30",
            "revenue": 768000,
            "cost": 919000,
            "profit": 38000,
            "margin": 20.8,
            "utilization": 55.3,
            "status": "critical",
            "recommendation": "Â∑°ÈÇèËªäÈ´òÁ®ºÂãï,Â¶ÇÊúüÊõ¥Êñ∞",
            "leaseStartDate": "2023-09-01",
            "monthsHeld": 30,
            "avgMonthlyRevenue": 25600.0,
            "avgMonthlyCost": 30633.33,
            "avgMonthlyProfit": -5033.33
        },
        {
            "id": "HSR-23022",
            "plate": "RFA-8239",
            "model": "Toyota Vios",
            "type": "Sedan",
            "leaseEnd": "2026-04-30",
            "revenue": 768000,
            "cost": 919000,
            "profit": 38000,
            "margin": 20.8,
            "utilization": 55.3,
            "status": "critical",
            "recommendation": "Â∑°ÈÇèËªäÈ´òÁ®ºÂãï,Â¶ÇÊúüÊõ¥Êñ∞",
            "leaseStartDate": "2023-09-01",
            "monthsHeld": 30,
            "avgMonthlyRevenue": 25600.0,
            "avgMonthlyCost": 30633.33,
            "avgMonthlyProfit": -5033.33
        },
        {
            "id": "HSR-23023",
            "plate": "RFA-8250",
            "model": "Toyota Vios",
            "type": "Sedan",
            "leaseEnd": "2026-04-30",
            "revenue": 768000,
            "cost": 919000,
            "profit": 38000,
            "margin": 20.8,
            "utilization": 55.3,
            "status": "critical",
            "recommendation": "Â∑°ÈÇèËªäÈ´òÁ®ºÂãï,Â¶ÇÊúüÊõ¥Êñ∞",
            "leaseStartDate": "2023-09-01",
            "monthsHeld": 30,
            "avgMonthlyRevenue": 25600.0,
            "avgMonthlyCost": 30633.33,
            "avgMonthlyProfit": -5033.33
        },
        {
            "id": "HSR-23024",
            "plate": "RFA-8251",
            "model": "Toyota Vios",
            "type": "Sedan",
            "leaseEnd": "2026-04-30",
            "revenue": 768000,
            "cost": 919000,
            "profit": 38000,
            "margin": 20.8,
            "utilization": 55.3,
            "status": "critical",
            "recommendation": "Â∑°ÈÇèËªäÈ´òÁ®ºÂãï,Â¶ÇÊúüÊõ¥Êñ∞",
            "leaseStartDate": "2023-09-01",
            "monthsHeld": 30,
            "avgMonthlyRevenue": 25600.0,
            "avgMonthlyCost": 30633.33,
            "avgMonthlyProfit": -5033.33
        },
        {
            "id": "HSR-23025",
            "plate": "RFA-8252",
            "model": "Toyota Vios",
            "type": "Sedan",
            "leaseEnd": "2026-04-30",
            "revenue": 768000,
            "cost": 919000,
            "profit": 38000,
            "margin": 20.8,
            "utilization": 55.3,
            "status": "critical",
            "recommendation": "Â∑°ÈÇèËªäÈ´òÁ®ºÂãï,Â¶ÇÊúüÊõ¥Êñ∞",
            "leaseStartDate": "2023-09-01",
            "monthsHeld": 30,
            "avgMonthlyRevenue": 25600.0,
            "avgMonthlyCost": 30633.33,
            "avgMonthlyProfit": -5033.33
        },
        {
            "id": "HSR-23026",
            "plate": "RFA-9715",
            "model": "Toyota Vios",
            "type": "Sedan",
            "leaseEnd": "2026-04-30",
            "revenue": 768000,
            "cost": 919000,
            "profit": 38000,
            "margin": 20.8,
            "utilization": 55.3,
            "status": "critical",
            "recommendation": "Â∑°ÈÇèËªäÈ´òÁ®ºÂãï,Â¶ÇÊúüÊõ¥Êñ∞",
            "leaseStartDate": "2025-05-01",
            "monthsHeld": 10,
            "avgMonthlyRevenue": 76800.0,
            "avgMonthlyCost": 91900.0,
            "avgMonthlyProfit": -3800.0
        }
    ],
    "soldVehicles": [
        {
            "id": "GA-19001",
            "plate": "RDQ-1350",
            "model": "Toyota Sienta",
            "type": "MPV",
            "purchaseDate": "2019-03-31",
            "saleDate": "2022-03-30",
            "purchasePrice": 679531,
            "salePrice": 438095,
            "totalRentalRevenue": 480000,
            "totalOperatingCost": 124148,
            "totalProfit": 114416,
            "holdingPeriod": 3,
            "status": "completed",
            "notes": "5.5Ëê¨km"
        },
        {
            "id": "CEO-20001",
            "plate": "RDB-8065",
            "model": "M-BENZ GLC coupe",
            "type": "SUV",
            "purchaseDate": "2020-12-01",
            "saleDate": "2023-11-30",
            "purchasePrice": 2780095,
            "salePrice": 1790476,
            "totalRentalRevenue": 1952360,
            "totalOperatingCost": 306228,
            "totalProfit": 656513,
            "holdingPeriod": 3,
            "status": "completed",
            "notes": "7.9Ëê¨km"
        },
        {
            "id": "HSR-20001",
            "plate": "RCU-6706",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "purchaseDate": "2020-04-30",
            "saleDate": "2023-10-02",
            "purchasePrice": 512794,
            "salePrice": 147619,
            "totalRentalRevenue": 743424,
            "totalOperatingCost": 353683,
            "totalProfit": 24866,
            "holdingPeriod": 3.3,
            "status": "completed",
            "notes": "33.5Ëê¨km"
        },
        {
            "id": "HSR-20002",
            "plate": "RCU-6710",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "purchaseDate": "2020-04-30",
            "saleDate": "2023-10-02",
            "purchasePrice": 512794,
            "salePrice": 147619,
            "totalRentalRevenue": 743424,
            "totalOperatingCost": 353683,
            "totalProfit": 24866,
            "holdingPeriod": 3.3,
            "status": "completed",
            "notes": "33.5Ëê¨km"
        },
        {
            "id": "HSR-20003",
            "plate": "RCU-6712",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "purchaseDate": "2020-04-30",
            "saleDate": "2023-10-02",
            "purchasePrice": 512794,
            "salePrice": 154286,
            "totalRentalRevenue": 741484,
            "totalOperatingCost": 326754,
            "totalProfit": 56222,
            "holdingPeriod": 3.3,
            "status": "completed",
            "notes": "30.1Ëê¨km"
        },
        {
            "id": "HSR-20004",
            "plate": "RCU-6713",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "purchaseDate": "2020-04-30",
            "saleDate": "2023-10-02",
            "purchasePrice": 512794,
            "salePrice": 171429,
            "totalRentalRevenue": 746190,
            "totalOperatingCost": 351446,
            "totalProfit": 53379,
            "holdingPeriod": 3.3,
            "status": "completed",
            "notes": "36Ëê¨km"
        },
        {
            "id": "HSR-20005",
            "plate": "RCU-6715",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "purchaseDate": "2020-04-30",
            "saleDate": "2023-11-16",
            "purchasePrice": 512794,
            "salePrice": 136190,
            "totalRentalRevenue": 792421,
            "totalOperatingCost": 397736,
            "totalProfit": 18081,
            "holdingPeriod": 3.3,
            "status": "completed",
            "notes": "31.3Ëê¨km"
        },
        {
            "id": "HSR-20006",
            "plate": "RCU-6716",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "purchaseDate": "2020-04-30",
            "saleDate": "2023-10-02",
            "purchasePrice": 512794,
            "salePrice": 202857,
            "totalRentalRevenue": 770322,
            "totalOperatingCost": 403156,
            "totalProfit": 57229,
            "holdingPeriod": 3.3,
            "status": "completed",
            "notes": "30.8Ëê¨km"
        },
        {
            "id": "HSR-20007",
            "plate": "RCU-6720",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "purchaseDate": "2020-04-30",
            "saleDate": "2023-10-26",
            "purchasePrice": 512794,
            "salePrice": 170476,
            "totalRentalRevenue": 768768,
            "totalOperatingCost": 383830,
            "totalProfit": 42620,
            "holdingPeriod": 3.3,
            "status": "completed",
            "notes": "30Ëê¨km"
        },
        {
            "id": "HSR-20008",
            "plate": "RCU-6721",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "purchaseDate": "2020-04-30",
            "saleDate": "2023-10-02",
            "purchasePrice": 512794,
            "salePrice": 109524,
            "totalRentalRevenue": 762533,
            "totalOperatingCost": 338750,
            "totalProfit": 20513,
            "holdingPeriod": 3.3,
            "status": "completed",
            "notes": "24.8Ëê¨km"
        },
        {
            "id": "HSR-20009",
            "plate": "RCU-6723",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "purchaseDate": "2020-04-30",
            "saleDate": "2023-10-02",
            "purchasePrice": 512794,
            "salePrice": 126667,
            "totalRentalRevenue": 761657,
            "totalOperatingCost": 450339,
            "totalProfit": -74809,
            "holdingPeriod": 3.3,
            "status": "completed",
            "notes": "30Ëê¨km"
        },
        {
            "id": "HSR-20010",
            "plate": "RCU-6730",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "purchaseDate": "2020-04-30",
            "saleDate": "2023-10-02",
            "purchasePrice": 512794,
            "salePrice": 171429,
            "totalRentalRevenue": 744353,
            "totalOperatingCost": 351446,
            "totalProfit": 51542,
            "holdingPeriod": 3.3,
            "status": "completed",
            "notes": "36.5Ëê¨km"
        },
        {
            "id": "HSR-20011",
            "plate": "RCU-6732",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "purchaseDate": "2020-04-30",
            "saleDate": "2023-10-02",
            "purchasePrice": 512794,
            "salePrice": 187619,
            "totalRentalRevenue": 739048,
            "totalOperatingCost": 351446,
            "totalProfit": 62427,
            "holdingPeriod": 3.3,
            "status": "completed",
            "notes": "23.7Ëê¨km"
        },
        {
            "id": "HSR-20012",
            "plate": "RCU-6733",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "purchaseDate": "2020-04-30",
            "saleDate": "2023-10-02",
            "purchasePrice": 512794,
            "salePrice": 191429,
            "totalRentalRevenue": 754895,
            "totalOperatingCost": 288537,
            "totalProfit": 144993,
            "holdingPeriod": 3.3,
            "status": "completed",
            "notes": "24.5Ëê¨km"
        },
        {
            "id": "HSR-20013",
            "plate": "RCU-6735",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "purchaseDate": "2020-04-30",
            "saleDate": "2023-10-02",
            "purchasePrice": 512794,
            "salePrice": 171429,
            "totalRentalRevenue": 747771,
            "totalOperatingCost": 346717,
            "totalProfit": 59689,
            "holdingPeriod": 3.3,
            "status": "completed",
            "notes": "34.2Ëê¨km"
        },
        {
            "id": "HSR-20014",
            "plate": "RCU-6750",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "purchaseDate": "2020-04-30",
            "saleDate": "2023-10-02",
            "purchasePrice": 512794,
            "salePrice": 176190,
            "totalRentalRevenue": 968096,
            "totalOperatingCost": 393361,
            "totalProfit": 238131,
            "holdingPeriod": 3.3,
            "status": "completed",
            "notes": "31.6Ëê¨km ÊúâÊî∂ÂõûÂæ©Ë≤ª"
        },
        {
            "id": "HSR-20015",
            "plate": "RCU-6751",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "purchaseDate": "2020-04-30",
            "saleDate": "2023-10-02",
            "purchasePrice": 512794,
            "salePrice": 118095,
            "totalRentalRevenue": 735048,
            "totalOperatingCost": 334736,
            "totalProfit": 5613,
            "holdingPeriod": 3.3,
            "status": "completed",
            "notes": "28Ëê¨km"
        },
        {
            "id": "HSR-20016",
            "plate": "RCU-6752",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "purchaseDate": "2020-04-30",
            "saleDate": "2023-10-02",
            "purchasePrice": 512794,
            "salePrice": 164762,
            "totalRentalRevenue": 735048,
            "totalOperatingCost": 349720,
            "totalProfit": 5613,
            "holdingPeriod": 3.3,
            "status": "completed",
            "notes": "29.4Ëê¨km"
        },
        {
            "id": "HSR-20017",
            "plate": "RCU-6753",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "purchaseDate": "2020-04-30",
            "saleDate": "2023-10-02",
            "purchasePrice": 512794,
            "salePrice": 141905,
            "totalRentalRevenue": 746119,
            "totalOperatingCost": 438791,
            "totalProfit": 37296,
            "holdingPeriod": 3.3,
            "status": "completed",
            "notes": "40.9Ëê¨km"
        },
        {
            "id": "HSR-20018",
            "plate": "RCU-6760",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "purchaseDate": "2020-04-30",
            "saleDate": "2023-10-02",
            "purchasePrice": 512794,
            "salePrice": 142857,
            "totalRentalRevenue": 746190,
            "totalOperatingCost": 445174,
            "totalProfit": -68921,
            "holdingPeriod": 3.3,
            "status": "completed",
            "notes": "36Ëê¨km"
        },
        {
            "id": "HSR-20019",
            "plate": "RCU-6762",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "purchaseDate": "2020-04-30",
            "saleDate": "2023-10-02",
            "purchasePrice": 512794,
            "salePrice": 143810,
            "totalRentalRevenue": 735048,
            "totalOperatingCost": 326343,
            "totalProfit": 39721,
            "holdingPeriod": 3.3,
            "status": "completed",
            "notes": "32.3Ëê¨km"
        },
        {
            "id": "HSR-20020",
            "plate": "RCU-6763",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "purchaseDate": "2020-04-30",
            "saleDate": "2023-10-02",
            "purchasePrice": 512794,
            "salePrice": 200000,
            "totalRentalRevenue": 735048,
            "totalOperatingCost": 245254,
            "totalProfit": 177000,
            "holdingPeriod": 3.3,
            "status": "completed",
            "notes": "25.1Ëê¨km"
        },
        {
            "id": "HSR-20021",
            "plate": "RCU-6772",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "purchaseDate": "2020-04-30",
            "saleDate": "2023-10-02",
            "purchasePrice": 512794,
            "salePrice": 158095,
            "totalRentalRevenue": 742095,
            "totalOperatingCost": 246858,
            "totalProfit": 140538,
            "holdingPeriod": 3.3,
            "status": "completed",
            "notes": "23,1Ëê¨km"
        },
        {
            "id": "HSR-20022",
            "plate": "RCU-6773",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "purchaseDate": "2020-04-30",
            "saleDate": "2023-10-02",
            "purchasePrice": 512794,
            "salePrice": 164762,
            "totalRentalRevenue": 735048,
            "totalOperatingCost": 245254,
            "totalProfit": 141762,
            "holdingPeriod": 3.3,
            "status": "completed",
            "notes": "24.1Ëê¨km"
        },
        {
            "id": "HSR-20023",
            "plate": "RCU-6773",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "purchaseDate": "2020-04-30",
            "saleDate": "2023-10-02",
            "purchasePrice": 512794,
            "salePrice": 164762,
            "totalRentalRevenue": 735048,
            "totalOperatingCost": 245254,
            "totalProfit": 141762,
            "holdingPeriod": 3.3,
            "status": "completed",
            "notes": "24.1Ëê¨km"
        },
        {
            "id": "HSR-20024",
            "plate": "RCU-6775",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "purchaseDate": "2020-04-30",
            "saleDate": "2023-08-31",
            "purchasePrice": 338286,
            "salePrice": 171429,
            "totalRentalRevenue": 919631,
            "totalOperatingCost": 298443,
            "totalProfit": 454331,
            "holdingPeriod": 3.3,
            "status": "completed",
            "notes": "23.7Ëê¨km"
        },
        {
            "id": "HSR-20025",
            "plate": "RDL-6517",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "purchaseDate": "2022-03-11",
            "saleDate": "2023-08-31",
            "purchasePrice": 445047,
            "salePrice": 202857,
            "totalRentalRevenue": 587424,
            "totalOperatingCost": 102616,
            "totalProfit": 242618,
            "holdingPeriod": 1.46,
            "status": "completed",
            "notes": "14.6Ëê¨km"
        }
    ],
    "terminatedVehicles": [
        {
            "id": "HSR-001",
            "plate": "RCU-6725",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "leaseStartDate": "2020-04-30",
            "terminationDate": "2020-07-29",
            "purchasePrice": 512794,
            "rentalRevenueReceived": 40000,
            "terminationFeeReceived": 572460,
            "totalOperatingCost": 533031,
            "totalProfit": 79429,
            "holdingPeriod": 0.25,
            "terminationReason": "ËãóÊ†óËá™ÊíûÂÆâÂÖ®Â≥∂ÂÖ®Êêç",
            "status": "terminated",
            "notes": "Êú¨ÈáëÂà©Áõä26891,RCW-6713Êé•Á∫å"
        },
        {
            "id": "HSR-002",
            "plate": "RCU-6736",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "leaseStartDate": "2020-04-30",
            "terminationDate": "2021-06-29",
            "purchasePrice": 512794,
            "rentalRevenueReceived": 230667,
            "terminationFeeReceived": 485980,
            "totalOperatingCost": 645531,
            "totalProfit": 71116,
            "holdingPeriod": 1.17,
            "terminationReason": "ÂΩ∞ÂåñËá™ÊíûÈõªÁ∑öÊ°øÂÖ®Êêç",
            "status": "terminated",
            "notes": "Êú¨ÈáëÂà©Áõä38307,RDF-5603Êé•Á∫å"
        },
        {
            "id": "HSR-003",
            "plate": "RDF-5603",
            "model": "Toyota Yaris",
            "type": "Sedan",
            "leaseStartDate": "2021-06-30",
            "terminationDate": "2022-02-07",
            "purchasePrice": 520033,
            "rentalRevenueReceived": 163107,
            "terminationFeeReceived": 513770,
            "totalOperatingCost": 592558,
            "totalProfit": 84319,
            "holdingPeriod": 0.75,
            "terminationReason": "ÂΩ∞ÂåñËá™ÊíûÂÖ®Êêç",
            "status": "terminated",
            "notes": "Êú¨ÈáëÂà©Áõä34051,RDL-6517Êé•Á∫å"
        },
        {
            "id": "HSR-004",
            "plate": "RDA-8226",
            "model": "Vios",
            "type": "Sedan",
            "leaseStartDate": "2023-09-01",
            "terminationDate": "2025-06-11",
            "purchasePrice": 528413,
            "rentalRevenueReceived": 480000,
            "terminationFeeReceived": 451800,
            "totalOperatingCost": 682558,
            "totalProfit": 249242,
            "holdingPeriod": 1.67,
            "terminationReason": "Èõ≤ÊûóËá™ÊíûË∑ØÊ®πÂÖ®Êêç",
            "status": "terminated",
            "notes": "Êú¨ÈáëÂà©Áõä115949,RDL-6517Êé•Á∫å"
        }
    ],
    "costBreakdown": {
        "purchase": 2074034,
        "tax": 41331,
        "maintenance": 229508,
        "insurance": 92390,
        "others": 19524
    }
};

        document.addEventListener("DOMContentLoaded", () => {
            // Update Report Info
            document.querySelector(".header h1").innerText = fleetData.reportInfo.reportTitle;
            document.querySelector(".header p").innerText = fleetData.reportInfo.company;
            document.getElementById("reportDate").innerText = `Â†±ÂëäÊó•Êúü: ${fleetData.reportInfo.reportDate}`;

            // Update Summary Cards
            updateSummaryCards();

            // Populate Tables
            populateActiveVehiclesTable();
            populateSoldVehiclesTable();
            populateTerminatedVehiclesTable();
            populateProfitabilityTable();

            // Render Charts
            renderYearlyTrendChart();
            renderClaimRateChart();
            renderCostBreakdownChart();

            // Set up tab switching
            const tabButtons = document.querySelectorAll(".tab-btn");
            tabButtons.forEach(button => {
                button.addEventListener("click", () => {
                    const tabId = button.onclick.toString().match(/switchTab\('([^']+)'\)/)[1];
                    switchTab(tabId);
                });
            });
            switchTab('overview'); // Default to overview tab

            // Set up search and filter for active vehicles
            document.getElementById('vehicleSearch').addEventListener('keyup', filterActiveVehicles);
            document.getElementById('statusFilter').addEventListener('change', filterActiveVehicles);
            document.getElementById('typeFilter').addEventListener('change', filterActiveVehicles);
        });

        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(tabId).classList.add('active');
            document.querySelector(`.tab-btn[onclick*='${tabId}']`).classList.add('active');
        }

        function updateSummaryCards() {
            document.getElementById("totalVehicles").innerText = fleetData.summary.totalVehicles;
            document.getElementById("activeVehicles").innerText = fleetData.summary.status.active;
            document.getElementById("idleVehicles").innerText = fleetData.summary.status.idle;
            document.getElementById("soldVehicles").innerText = fleetData.summary.status.sold;
            document.getElementById("terminatedVehicles").innerText = fleetData.summary.status.terminated;

            let totalCumulativeRevenue = 0;
            let totalCumulativeCost = 0;
            let totalMonthsHeld = 0;
            let totalUtilization = 0;
            let activeVehiclesCount = 0;

            fleetData.expiringVehicles.forEach(v => {
                if (v.monthsHeld) {
                    totalCumulativeRevenue += v.revenue;
                    totalCumulativeCost += v.cost;
                    totalMonthsHeld += v.monthsHeld;
                }
                if (v.utilization !== undefined) {
                    totalUtilization += v.utilization;
                    activeVehiclesCount++;
                }
            });

            document.getElementById("avgMonthlyRevenue").innerText = `$${(totalMonthsHeld > 0 ? totalCumulativeRevenue / totalMonthsHeld : 0).toLocaleString(undefined, {minimumFractionDigits: 0, maximumFractionDigits: 0})}`;
            document.getElementById("avgMonthlyExpense").innerText = `$${(totalMonthsHeld > 0 ? totalCumulativeCost / totalMonthsHeld : 0).toLocaleString(undefined, {minimumFractionDigits: 0, maximumFractionDigits: 0})}`;
            document.getElementById("utilizationRate").innerText = `${(activeVehiclesCount > 0 ? totalUtilization / activeVehiclesCount : 0).toFixed(1)}%`;
        }

        function populateActiveVehiclesTable() {
            const tableBody = document.querySelector("#activeVehiclesTable tbody");
            tableBody.innerHTML = ""; // Clear existing rows
            const filteredVehicles = getFilteredActiveVehicles();

            filteredVehicles.forEach(v => {
                const row = tableBody.insertRow();
                const margin = ((v.revenue - v.cost) / v.revenue * 100);
                const statusClass = margin < 10 ? 'status-critical' : (margin < 30 ? 'status-warning' : 'status-normal');
                const utilizationClass = v.utilization < 75 ? 'status-critical' : (v.utilization < 90 ? 'status-warning' : 'status-normal');
                
                row.innerHTML = `<td>${v.id}</td><td>${v.plate}</td><td>${v.model}</td><td>${v.type}</td><td>${v.leaseStartDate || "N/A"}</td><td>${v.monthsHeld || 0}</td><td>${v.leaseEnd}</td><td>$${v.revenue.toLocaleString()}</td><td>$${v.cost.toLocaleString()}</td><td>$${(v.avgMonthlyProfit || 0).toLocaleString(undefined, {minimumFractionDigits: 0, maximumFractionDigits: 0})}</td><td class="${statusClass}">${margin.toFixed(1)}%</td><td class="${utilizationClass}">${v.utilization.toFixed(1)}%</td><td><span class="status-badge ${v.status}">${v.status}</span></td><td>${v.recommendation}</td>`;
            });
        }

        function getFilteredActiveVehicles() {
            const searchTerm = document.getElementById('vehicleSearch').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;
            const typeFilter = document.getElementById('typeFilter').value;

            return fleetData.expiringVehicles.filter(v => {
                const matchesSearch = (v.plate.toLowerCase().includes(searchTerm) || v.model.toLowerCase().includes(searchTerm));
                const matchesStatus = (statusFilter === 'all' || v.status === statusFilter);
                const matchesType = (typeFilter === 'all' || v.type === typeFilter);
                return matchesSearch && matchesStatus && matchesType;
            });
        }

        function filterActiveVehicles() {
            populateActiveVehiclesTable();
        }

        function populateSoldVehiclesTable() {
            const tableBody = document.querySelector("#soldVehiclesTable tbody");
            tableBody.innerHTML = ""; // Clear existing rows
            fleetData.soldVehicles.forEach(v => {
                const row = tableBody.insertRow();
                const profitClass = v.totalProfit >= 0 ? 'profit-positive' : 'profit-negative';
                row.innerHTML = `<td>${v.id}</td><td>${v.plate}</td><td>${v.model}</td><td>${v.type}</td><td>${v.purchaseDate}</td><td>${v.saleDate}</td><td>$${v.purchasePrice.toLocaleString()}</td><td>$${v.salePrice.toLocaleString()}</td><td>$${v.totalRentalRevenue.toLocaleString()}</td><td>$${v.totalOperatingCost.toLocaleString()}</td><td class="${profitClass}">$${v.totalProfit.toLocaleString()}</td><td>${v.holdingPeriod}</td><td>${v.notes}</td>`;
            });
        }

        function populateTerminatedVehiclesTable() {
            const tableBody = document.querySelector("#terminatedVehiclesTable tbody");
            tableBody.innerHTML = ""; // Clear existing rows
            fleetData.terminatedVehicles.forEach(v => {
                const row = tableBody.insertRow();
                const profitClass = v.totalProfit >= 0 ? 'profit-positive' : 'profit-negative';
                row.innerHTML = `<td>${v.id}</td><td>${v.plate}</td><td>${v.model}</td><td>${v.type}</td><td>${v.leaseStartDate || "N/A"}</td><td>${v.terminationDate}</td><td>$${v.purchasePrice.toLocaleString()}</td><td>$${v.rentalRevenueReceived.toLocaleString()}</td><td>$${v.terminationFeeReceived.toLocaleString()}</td><td>$${v.totalOperatingCost.toLocaleString()}</td><td class="${profitClass}">$${v.totalProfit.toLocaleString()}</td><td>${v.holdingPeriod}</td><td>${v.terminationReason}</td><td>${v.notes}</td>`;
            });
        }

        function populateProfitabilityTable() {
            const tableBody = document.querySelector("#profitabilityTable tbody");
            tableBody.innerHTML = ""; // Clear existing rows
            fleetData.expiringVehicles.forEach(v => {
                const row = tableBody.insertRow();
                const margin = ((v.revenue - v.cost) / v.revenue * 100);
                const statusClass = margin < 10 ? 'status-critical' : (margin < 30 ? 'status-warning' : 'status-normal');
                const utilizationClass = v.utilization < 75 ? 'status-critical' : (v.utilization < 90 ? 'status-warning' : 'status-normal');
                const profitClass = (v.revenue - v.cost) >= 0 ? 'profit-positive' : 'profit-negative';

                row.innerHTML = `<td>${v.id}</td><td>${v.plate}</td><td>${v.model}</td><td>${v.type}</td><td>$${v.revenue.toLocaleString()}</td><td>$${v.cost.toLocaleString()}</td><td class="${profitClass}">$${(v.avgMonthlyProfit || 0).toLocaleString(undefined, {minimumFractionDigits: 0, maximumFractionDigits: 0})}</td><td class="${statusClass}">${margin.toFixed(1)}%</td><td class="${utilizationClass}">${v.utilization.toFixed(1)}%</td><td><span class="status-badge ${v.status}">${v.status}</span></td><td>${v.recommendation}</td>`;
            });
        }

        function renderYearlyTrendChart() {
            const ctx = document.getElementById("yearlyTrendChart").getContext("2d");
            new Chart(ctx, {
                type: "line",
                data: {
                    labels: fleetData.yearlyTrend.map(item => item.year),
                    datasets: [
                        {
                            label: "Êî∂Áõä",
                            data: fleetData.yearlyTrend.map(item => item.revenue),
                            borderColor: "rgb(75, 192, 192)",
                            tension: 0.1,
                            fill: false
                        },
                        {
                            label: "ÊàêÊú¨",
                            data: fleetData.yearlyTrend.map(item => item.expense),
                            borderColor: "rgb(255, 99, 132)",
                            tension: 0.1,
                            fill: false
                        },
                        {
                            label: "Ê∑®Âà©",
                            data: fleetData.yearlyTrend.map(item => item.profit),
                            borderColor: "rgb(54, 162, 235)",
                            tension: 0.1,
                            fill: false
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: "Âπ¥Â∫¶Êî∂Áõä„ÄÅÊàêÊú¨ËàáÊ∑®Âà©Ë∂®Âã¢"
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: "ÈáëÈ°ç (NTD)"
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: "Âπ¥‰ªΩ"
                            }
                        }
                    }
                }
            });
        }

        function renderClaimRateChart() {
            const ctx = document.getElementById("claimRateChart").getContext("2d");
            new Chart(ctx, {
                type: "bar",
                data: {
                    labels: fleetData.yearlyTrend.map(item => item.year),
                    datasets: [
                        {
                            label: "ÁêÜË≥†Áéá",
                            data: fleetData.yearlyTrend.map(item => item.claimRate * 100),
                            backgroundColor: "rgba(255, 159, 64, 0.6)",
                            borderColor: "rgba(255, 159, 64, 1)",
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: "Âπ¥Â∫¶ÁêÜË≥†ÁéáË∂®Âã¢"
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: "ÁêÜË≥†Áéá (%)"
                            },
                            max: 100
                        },
                        x: {
                            title: {
                                display: true,
                                text: "Âπ¥‰ªΩ"
                            }
                        }
                    }
                }
            });
        }

        function renderCostBreakdownChart() {
            const ctx = document.getElementById("costBreakdownChart").getContext("2d");
            const costLabels = Object.keys(fleetData.costBreakdown);
            const costValues = Object.values(fleetData.costBreakdown);

            new Chart(ctx, {
                type: "pie",
                data: {
                    labels: costLabels,
                    datasets: [{
                        data: costValues,
                        backgroundColor: [
                            "#FF6384",
                            "#36A2EB",
                            "#FFCE56",
                            "#4BC0C0",
                            "#9966FF"
                        ],
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: "ÊàêÊú¨ÁµêÊßãÂàÜ‰Ωà"
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>
