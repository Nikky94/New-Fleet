<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÈÄ≤ÈöéËªäÈöäÁáüÈÅãÁ∏æÊïàÂ†±Ë°®</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .tabs {
            display: flex;
            background: #f5f5f5;
            border-bottom: 2px solid #ddd;
            overflow-x: auto;
        }
        
        .tab-btn {
            flex: 1;
            padding: 15px 20px;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 1em;
            color: #666;
            transition: all 0.3s;
            white-space: nowrap;
            min-width: 150px;
        }
        
        .tab-btn:hover {
            background: #e0e0e0;
            color: #333;
        }
        
        .tab-btn.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
            font-weight: bold;
        }
        
        .content {
            padding: 30px;
            min-height: 600px;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .stat-card h3 {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 10px;
        }
        
        .stat-card .value {
            font-size: 2em;
            font-weight: bold;
        }
        
        .stat-card .unit {
            font-size: 0.8em;
            opacity: 0.8;
            margin-top: 5px;
        }
        
        .chart-container {
            position: relative;
            height: 400px;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .chart-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        @media (max-width: 1024px) {
            .chart-row {
                grid-template-columns: 1fr;
            }
        }
        
        .table-container {
            overflow-x: auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95em;
        }
        
        th {
            background: #667eea;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        
        td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }
        
        tr:hover {
            background: #f9f9f9;
        }
        
        .status-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }
        
        .status-critical {
            background: #ff6b6b;
            color: white;
        }
        
        .status-warning {
            background: #ffd93d;
            color: #333;
        }
        
        .status-normal {
            background: #51cf66;
            color: white;
        }
        
        .status-completed {
            background: #868e96;
            color: white;
        }
        
        .status-terminated {
            background: #ff922b;
            color: white;
        }
        
        .search-filter {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .search-filter input,
        .search-filter select {
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 0.95em;
        }
        
        .search-filter input {
            flex: 1;
            min-width: 200px;
        }
        
        .footer {
            background: #f5f5f5;
            padding: 20px;
            text-align: center;
            color: #666;
            font-size: 0.9em;
            border-top: 1px solid #ddd;
        }
        
        .legend {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 20px;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 5px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
        }

        .profit-positive {
            color: #51cf66;
            font-weight: bold;
        }

        .profit-negative {
            color: #ff6b6b;
            font-weight: bold;
        }

        .summary-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .summary-box h3 {
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .summary-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .summary-item {
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 5px;
            text-align: center;
        }

        .summary-item .label {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .summary-item .value {
            font-size: 1.5em;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üëÆÂ§©È∑π‰øùÂÖ®ËªäÈöä</h1>
            <p></p>
        </div>
        
        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('overview')">üìä Á∏ΩË¶Ω</button>
            <button class="tab-btn" onclick="switchTab('trends')">üìà È¢®Èö™</button>
            <button class="tab-btn" onclick="switchTab('vehicles')">üöô ÁßüË≥É</button>
            <button class="tab-btn" onclick="switchTab('sold')">üßÆ Âá∫ÂîÆ</button>
            <button class="tab-btn" onclick="switchTab('terminated')">‚õî Ëß£Á¥Ñ</button>
            <button class="tab-btn" onclick="switchTab('profitability')">üí∞ ÊêçÁõä</button>
            <button class="tab-btn" onclick="switchTab('costs')">üîß ÊàêÊú¨</button>
        </div>
        
        <div class="content">
            <!-- Á∏ΩË¶Ω -->
            <div id="overview" class="tab-content active">
                <h2 style="margin-bottom: 20px;">ÁãÄÊÖãÂà•</h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>‰øùÊúâ</h3>
                        <div class="value" id="totalVehicles">30</div>
                        <div class="unit">Âè∞</div>
                    </div>
                    <div class="stat-card">
                        <h3>ÊΩõÂú®</h3>
                        <div class="value" id="idleVehicles">1</div>
                        <div class="unit">Âè∞</div>
                    </div>
                    <div class="stat-card">
                        <h3>Êú™Âà∞Êúü</h3>
                        <div class="value" id="activeVehicles">29</div>
                        <div class="unit">Âè∞</div>
                    </div>
                    <div class="stat-card">
                        <h3>ÈáçÂ§ßÁ∂≠‰øÆ</h3>
                        <div class="value" id="maintenanceVehicles">0</div>
                        <div class="unit">Âè∞</div>
                    </div>
                    <div class="stat-card">
                        <h3>Â∑≤Âá∫ÂîÆ</h3>
                        <div class="value" id="soldVehicles">28</div>
                        <div class="unit">Âè∞</div>
                    </div>
                    <div class="stat-card">
                        <h3>Áï∞Â∏∏</h3>
                        <div class="value" id="terminatedVehicles">4</div>
                        <div class="unit">Âè∞</div>
                    </div>
                </div>
                
                <div class="chart-row">
                    <div class="chart-container">
                        <canvas id="statusChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="typeChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-row">
                    <div class="chart-container">
                        <canvas id="ageChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="typePerformanceChart"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- È¢®Èö™ -->
            <div id="trends" class="tab-content">
                <h2 style="margin-bottom: 20px;">Áî®ËªäÁøíÊÖ£</h2>
                
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: #667eea;"></div>
                        <span>ÈÅéÂéª5Âπ¥ (ÂØ¶Á∏æ)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #ffd93d;"></div>
                        <span>Êú™‰æÜ5Âπ¥ (È†êÊ∏¨)</span>
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="revenueChart"></canvas>
                </div>
                
                <div class="chart-row">
                    <div class="chart-container">
                        <canvas id="claimRateChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="utilizationChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="profitTrendChart"></canvas>
                </div>
            </div>
            
            <!-- ÊâøÁßü -->
            <div id="vehicles" class="tab-content">
                <h2 style="margin-bottom: 20px;">ÂØ¶Ë°å‰∏≠</h2>
                
                <div class="search-filter">
                    <input type="text" id="searchVehicle" placeholder="üîç ÊêúÂ∞ãËªäÁâå / ËªäÂûã..." onkeyup="filterVehicles()">
                    <select id="statusFilter" onchange="filterVehicles()">
                        <option value="">ÁãÄÊÖã</option>
                        <option value="critical">üî¥ Á∑äÊÄ•</option>
                        <option value="warning">üü° Ë≠¶Á§∫</option>
                        <option value="normal">üü¢ ‰∏ÄËà¨</option>
                    </select>
                </div>
                
                <div class="chart-row">
                    <div class="chart-container">
                        <canvas id="expiryTimelineChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="expiryProfitChart"></canvas>
                    </div>
                </div>
                
                <div class="table-container">
                    <table id="vehicleTable">
                        <thead>
                            <tr>
                                <th>Á∑®Á¢º</th>
                                <th>ËªäËôü</th>
                                <th>ËªäÂûã</th>
                                <th>Âà∞ÊúüÊó•</th>
                                <th>Êî∂Áõä</th>
                                <th>ÊàêÊú¨</th>
                                <th>Ê∑®Âà©</th>
                                <th>Âà©ÊΩ§Áéá</th>
                                <th>‰ΩøÁî®Áéá</th>
                                <th>ÁãÄÊÖã</th>
                                <th>Âª∫Ë≠∞</th>
                            </tr>
                        </thead>
                        <tbody id="vehicleTableBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Âá∫ÂîÆ -->
            <div id="sold" class="tab-content">
                <h2 style="margin-bottom: 20px;">Â∑≤ËôïÂàÜ</h2>

                <div class="summary-box">
                    <h3>ÊëòË¶Å</h3>
                    <div class="summary-content">
                        <div class="summary-item">
                            <div class="label">Âá∫ÂîÆÂè∞Êï∏</div>
                            <div class="value" id="soldCount">28</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">Ë≥ºËªäÊàêÊú¨</div>
                            <div class="value" id="soldTotalPurchase">$5.7M</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">Âá∫ÂîÆÊî∂ÂÖ•</div>
                            <div class="value" id="soldTotalSale">$2.65M</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">ÁßüÈáëÊî∂ÂÖ•</div>
                            <div class="value" id="soldTotalRental">$22.0M</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">ÁµêÊ°àÊàêÊú¨</div>
                            <div class="value" id="soldTotalCost">$15.15M</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">ÊêçÁõäÁ¥ØË®à</div>
                            <div class="value profit-positive" id="soldTotalProfit">$4.95M</div>
                        </div>
                    </div>
                </div>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Á∑®Á¢º</th>
                                <th>ËªäËôü</th>
                                <th>ËªäÂûã</th>
                                <th>Ë≥ºÂÖ•Êó•Êúü</th>
                                <th>Âá∫ÂîÆÊó•Êúü</th>
                                <th>Ë≥ºËªäÂÉπ</th>
                                <th>Âá∫ÂîÆÂÉπ</th>
                                <th>ÁßüÈáëÊî∂ÂÖ•</th>
                                <th>ÊàêÊú¨ÊîØÂá∫</th>
                                <th>Á∏ΩÊêçÁõä</th>
                                <th>ÊåÅÊúâÂπ¥Èôê</th>
                                <th>ÂÇôË®ª</th>
                            </tr>
                        </thead>
                        <tbody id="soldTableBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Ëß£Á¥Ñ -->
            <div id="terminated" class="tab-content">
                <h2 style="margin-bottom: 20px;">Áï∞Â∏∏ÁµÇÊ≠¢</h2>

                <div class="summary-box">
                    <h3>ÊëòË¶Å</h3>
                    <div class="summary-content">
                        <div class="summary-item">
                            <div class="label">Ëß£Á¥ÑÂè∞Êï∏</div>
                            <div class="value" id="termCount">5</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">Ë≥ºËªäÊàêÊú¨</div>
                            <div class="value" id="termTotalPurchase">$5.9M</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">ÁßüÈáëÊî∂ÂÖ•</div>
                            <div class="value" id="termTotalRental">$9.75M</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">ÂÖ∂‰ªñÊî∂ÂÖ•</div>
                            <div class="value" id="termTotalFee">$0.87M</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">Êö´ÁµêÊàêÊú¨</div>
                            <div class="value" id="termTotalCost">$7.65M</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">ÊêçÁõäÁ¥ØË®à</div>
                            <div class="value profit-positive" id="termTotalProfit">$3.27M</div>
                        </div>
                    </div>
                </div>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Á∑®Á¢º</th>
                                <th>ËªäËôü</th>
                                <th>ËªäÂûã</th>
                                <th>Ëµ∑ÁßüÊó•</th>
                                <th>Ëß£Á¥ÑÊó•</th>
                                <th>Ë≥ºËªäÂÉπ</th>
                                <th>ÁßüÈáëÊî∂ÂÖ•</th>
                                <th>Ëß£Á¥ÑÊî∂ÂÖ•</th>
                                <th>ÊîØÂá∫ÊàêÊú¨</th>
                                <th>Á∏ΩÊêçÁõä</th>
                                <th>ÊåÅÊúâÂπ¥Èôê</th>
                                <th>Ëß£Á¥ÑÂéüÂõ†</th>
                                <th>ÂÇôË®ª</th>
                            </tr>
                        </thead>
                        <tbody id="terminatedTableBody">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- ÊêçÁõä -->
            <div id="profitability" class="tab-content">
                <h2 style="margin-bottom: 20px;">ËªäËºõÂà•</h2>
                
                <div class="chart-row">
                    <div class="chart-container">
                        <canvas id="vehicleComparisonChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="marginRankChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="scatterChart"></canvas>
                </div>
            </div>
            
            <!-- ÊàêÊú¨ -->
            <div id="costs" class="tab-content">
                <h2 style="margin-bottom: 20px;">ÂúñË°®Ê™¢Ë¶ñ</h2>
                
                <div class="chart-row">
                    <div class="chart-container">
                        <canvas id="costStructureChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="typeMarginChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="costStackChart"></canvas>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>SEMAIL-TCO Report | Êó•ÊúüÔºö<span id="reportDate">2026-02-26</span> | OALT JAM Dept. </p>
        </div>
    </div>
    
    <script>
        // Êï∏ÊìöËºâÂÖ•
        const fleetData = {
            "reportDate": "2026-02-26",
            "reportTitle": "SEMAIL-TCO Report",
            "company": "OALT JAM Dept.",
            "summary": {
                "totalVehicles": 30,
                "status": {
                    "idle": 1,
                    "active": 29,
                    "maintenance": 0,
                    "terminated": 4,
                    "sold": 28
                },
                "vehicleTypes": {
                    "Sedan": 26,
                    "SUV": 1,
                    "MPV": 2,                   
                },
                "fleetAge": {
                    "under1Year": 0,
                    "1to3Years": 27,
                    "3to5Years":  2,
                    "over5Years": 0
                }
            },
            "yearlyTrend": [
                {"year": 2021, "revenue": 12500000, "expense": 9500000, "profit": 3000000, "claimRate": 4.2, "utilization": 82.5},
                {"year": 2022, "revenue": 13800000, "expense": 10200000, "profit": 3600000, "claimRate": 3.8, "utilization": 84.2},
                {"year": 2023, "revenue": 15200000, "expense": 11500000, "profit": 3700000, "claimRate": 4.5, "utilization": 86.8},
                {"year": 2024, "revenue": 16500000, "expense": 12800000, "profit": 3700000, "claimRate": 4.1, "utilization": 85.5},
                {"year": 2025, "revenue": 17800000, "expense": 13500000, "profit": 4300000, "claimRate": 3.9, "utilization": 88.2},
                {"year": 2026, "revenue": 18500000, "expense": 14200000, "profit": 4300000, "claimRate": 4.0, "utilization": 87.5, "forecast": true},
                {"year": 2027, "revenue": 19200000, "expense": 14800000, "profit": 4400000, "claimRate": 4.0, "utilization": 88.0, "forecast": true},
                {"year": 2028, "revenue": 20500000, "expense": 15500000, "profit": 5000000, "claimRate": 3.8, "utilization": 89.5, "forecast": true},
                {"year": 2029, "revenue": 21800000, "expense": 16200000, "profit": 5600000, "claimRate": 3.7, "utilization": 90.2, "forecast": true},
                {"year": 2030, "revenue": 23000000, "expense": 17000000, "profit": 6000000, "claimRate": 3.6, "utilization": 91.5, "forecast": true}
            ],
            "costStructure": {
                "acquisition": 45.0,
                "tax": 12.5,
                "maintenance": 18.5,
                "insurance": 15.0,
                "other": 9.0
            },
            "typePerformance": [
                {"type": "Sedan", "count": 26, "utilization": 82.5, "profitMargin": 12.5, "avgCost": 850000},
                {"type": "SUV", "count": 1, "utilization": 88.2, "profitMargin": 15.8, "avgCost": 1250000},
                {"type": "MPV", "count": 2, "utilization": 91.5, "profitMargin": 18.2, "avgCost": 1550000},
            ],
            "expiringVehicles": [
                {
                    "id": "GA-21001",
                    "plate": "RDQ-8065",
                    "model": "Luxgen M7",
                    "type": "MPV",
                    "leaseEnd": "2026-09-18",
                    "revenue": 1033000,
                    "cost": 796000,
                    "profit": 250000,
                    "margin": 20.8,
                    "utilization": 88.5,
                    "status": "critical",
                    "recommendation": "È´òÊî∂ÁõäÔºåÂª∫Ë≠∞Á∫åÁ¥ÑÊàñËΩâÂîÆÈ´òÂÉπ"
                },
                {
                    "id": "CEO-001",
                    "plate": "BOSS-1",
                    "model": "Mercedes-Benz S-Class",
                    "type": "Sedan",
                    "leaseEnd": "2026-06-01",
                    "revenue": 4500000,
                    "cost": 4200000,
                    "profit": 300000,
                    "margin": 6.7,
                    "utilization": 65.0,
                    "status": "warning",
                    "recommendation": "Á∂≠Ë≠∑ÊàêÊú¨ÂÅèÈ´òÔºåË©ï‰º∞ÊèõË≥ºÊñ∞Ëªä"
                },
                {
                    "id": "HSR-005",
                    "plate": "HSR-5566",
                    "model": "VW Multivan",
                    "type": "MPV",
                    "leaseEnd": "2026-08-20",
                    "revenue": 2800000,
                    "cost": 2100000,
                    "profit": 700000,
                    "margin": 25.0,
                    "utilization": 95.2,
                    "status": "normal",
                    "recommendation": "È´òÈêµÊé•ÈßÅ‰∏ªÂäõÔºåÈ´òÁ®ºÂãïÁéáÔºåÂª∫Ë≠∞Á∫åÁ¥Ñ"
                },
                {
                    "id": "TRK-002",
                    "plate": "TRK-1234",
                    "model": "Isuzu F-Series",
                    "type": "Track",
                    "leaseEnd": "2027-02-15",
                    "revenue": 5500000,
                    "cost": 4100000,
                    "profit": 1400000,
                    "margin": 25.5,
                    "utilization": 92.0,
                    "status": "normal",
                    "recommendation": "Á©©ÂÆöÊî∂ÁõäË≤®ËªäÔºåÊåâË®àÁï´‰øùÈ§ä"
                },
                {
                    "id": "VAN-012",
                    "plate": "VAN-9900",
                    "model": "Ford Transit",
                    "type": "VAN",
                    "leaseEnd": "2026-04-10",
                    "revenue": 1500000,
                    "cost": 1550000,
                    "profit": -50000,
                    "margin": -3.3,
                    "utilization": 72.0,
                    "status": "critical",
                    "recommendation": "ËôßÊêçËªäËºõÔºåÁßüÁ¥ÑÊúüÊªøÂç≥ÂàªËôïÂàÜ"
                }
            ],
            "soldVehicles": [
                {
                    "id": "GA-19001",
                    "plate": "RDQ-1350",
                    "model": "Toyota Sienta",
                    "type": "MPV",
                    "purchaseDate": "2019-03-31",
                    "saleDate": "2022-06-24",
                    "purchasePrice": 679537,
                    "salePrice": 438095,
                    "totalRentalRevenue": 480000,
                    "totalOperatingCost": 121148,
                    "totalProfit": 117410,
                    "holdingPeriod": 3.25,
                    "status": "completed",
                    "notes": "È´òÊñºÂ∏ÇÂÉπÂá∫ÂîÆ"
                },
                {
                    "id": "CEO-20001",
                    "plate": "RDB-8065",
                    "model": "Mercedes-Benz GLC",
                    "type": "SUV",
                    "purchaseDate": "2020-12-01",
                    "saleDate": "2023-12-05",
                    "purchasePrice": 2780095,
                    "salePrice": 1790476,
                    "totalRentalRevenue": 1952360,
                    "totalOperatingCost": 306228,
                    "totalProfit": 656513,
                    "holdingPeriod": 3,
                    "status": "completed",
                    "notes": "Ê•µÈ´òÊî∂Áõä"
                },
                {
                    "id": "HSR-20001",
                    "plate": "RCU-6706",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-26",
                    "purchasePrice": 512794,
                    "salePrice": 188571,
                    "totalRentalRevenue": 744252,
                    "totalOperatingCost": 287922,
                    "totalProfit": 132107,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "17.9Ëê¨km"
                },
                {                    
                    "id": "HSR-20002",
                    "plate": "RCU-6710",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 189524,
                    "totalRentalRevenue": 748495,
                    "totalOperatingCost": 288920,
                    "totalProfit": 136305,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "20.9Ëê¨km"
                },
                {
                    "id": "HSR-20003",
                    "plate": "RCU-6712",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-11-02",
                    "purchasePrice": 512794,
                    "salePrice": 136190,
                    "totalRentalRevenue": 757257,
                    "totalOperatingCost": 312643,
                    "totalProfit": 68010,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "30.5Ëê¨km"
                },
                {
                    "id": "HSR-20004",
                    "plate": "RCU-6713",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-11-09",
                    "purchasePrice": 512794,
                    "salePrice": 153333,
                    "totalRentalRevenue": 745410,
                    "totalOperatingCost": 266159,
                    "totalProfit": 119790,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "26.8Ëê¨km"
                },
                {
                    "id": "HSR-20005",
                    "plate": "RCU-6715",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-11-16",
                    "purchasePrice": 512794,
                    "salePrice": 136190,
                    "totalRentalRevenue": 792421,
                    "totalOperatingCost": 397736,
                    "totalProfit": 18081,
                    "holdingPeriod": 3.3,
                    "status": "completed",
                    "notes": "31.3Ëê¨km"
                },
                {
                    "id": "HSR-20006",
                    "plate": "RCU-6716",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 202857,
                    "totalRentalRevenue": 770322,
                    "totalOperatingCost": 403156,
                    "totalProfit": 57229,
                    "holdingPeriod": 3.3,
                    "status": "completed",
                    "notes": "30.8Ëê¨km"
                },
                {
                    "id": "HSR-20007",
                    "plate": "RCU-6720",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-26",
                    "purchasePrice": 512794,
                    "salePrice": 170476,
                    "totalRentalRevenue": 768768,
                    "totalOperatingCost": 383830,
                    "totalProfit": 42620,
                    "holdingPeriod": 3.3,
                    "status": "completed",
                    "notes": "30Ëê¨km"
                },
                {
                    "id": "HSR-20008",
                    "plate": "RCU-6721",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 109524,
                    "totalRentalRevenue": 762533,
                    "totalOperatingCost": 338750,
                    "totalProfit": 20513,
                    "holdingPeriod": 3.3,
                    "status": "completed",
                    "notes": "24.8Ëê¨km"
                },
                {
                    "id": "HSR-20009",
                    "plate": "RCU-6723",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 126667,
                    "totalRentalRevenue": 761657,
                    "totalOperatingCost": 450339,
                    "totalProfit": -74809,
                    "holdingPeriod": 3.3,
                    "status": "completed",
                    "notes": "30Ëê¨km"
                },
                {
                    "id": "HSR-20010",
                    "plate": "RCU-6730",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 171429,
                    "totalRentalRevenue": 744353,
                    "totalOperatingCost": 351446,
                    "totalProfit": 51542,
                    "holdingPeriod": 3.3,
                    "status": "completed",
                    "notes": "36.5Ëê¨km"
                },
                {
                    "id": "HSR-20011",
                    "plate": "RCU-6732",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 187619,
                    "totalRentalRevenue": 739048,
                    "totalOperatingCost": 351446,
                    "totalProfit": 62427,
                    "holdingPeriod": 3.3,
                    "status": "completed",
                    "notes": "23.7Ëê¨km"
                },
                {
                    "id": "HSR-20012",
                    "plate": "RCU-6733",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 191429,
                    "totalRentalRevenue": 754895,
                    "totalOperatingCost": 288537,
                    "totalProfit": 144993,
                    "holdingPeriod": 3.3,
                    "status": "completed",
                    "notes": "24.5Ëê¨km"
                },
                {
                    "id": "HSR-20013",
                    "plate": "RCU-6735",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 171429,
                    "totalRentalRevenue": 747771,
                    "totalOperatingCost": 346717,
                    "totalProfit": 59689,
                    "holdingPeriod": 3.3,
                    "status": "completed",
                    "notes": "34.2Ëê¨km"
                },
                {
                    "id": "HSR-20014",
                    "plate": "RCU-6750",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 176190,
                    "totalRentalRevenue": 968096,
                    "totalOperatingCost": 393361,
                    "totalProfit": 238131,
                    "holdingPeriod": 3.3,
                    "status": "completed",
                    "notes": "31.6Ëê¨km ÊúâÊî∂ÂõûÂæ©Ë≤ª"
                },
                {
                    "id": "HSR-20015",
                    "plate": "RCU-6751",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 118095,
                    "totalRentalRevenue": 735048,
                    "totalOperatingCost": 334736,
                    "totalProfit": 5613,
                    "holdingPeriod": 3.3,
                    "status": "completed",
                    "notes": "28Ëê¨km"
                },
                {
                    "id": "HSR-20016",
                    "plate": "RCU-6752",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 164762,
                    "totalRentalRevenue": 735048,
                    "totalOperatingCost": 349720,
                    "totalProfit": 5613,
                    "holdingPeriod": 3.3,
                    "status": "completed",
                    "notes": "29.4Ëê¨km"
                },
                {
                    "id": "HSR-20017",
                    "plate": "RCU-6753",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 141905,
                    "totalRentalRevenue": 746119,
                    "totalOperatingCost": 438791,
                    "totalProfit": 37296,
                    "holdingPeriod": 3.3,
                    "status": "completed",
                    "notes": "40.9Ëê¨km"
                },
                {
                    "id": "HSR-20018",
                    "plate": "RCU-6760",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 142857,
                    "totalRentalRevenue": 746190,
                    "totalOperatingCost": 445174,
                    "totalProfit": -68921,
                    "holdingPeriod": 3.3,
                    "status": "completed",
                    "notes": "36Ëê¨km"
                },
                {
                    "id": "HSR-20019",
                    "plate": "RCU-6762",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 143810,
                    "totalRentalRevenue": 735048,
                    "totalOperatingCost": 326343,
                    "totalProfit": 39721,
                    "holdingPeriod": 3.3,
                    "status": "completed",
                    "notes": "32.3Ëê¨km"
                },
                {
                    "id": "HSR-20020",
                    "plate": "RCU-6763",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 200000,
                    "totalRentalRevenue": 735048,
                    "totalOperatingCost": 245254,
                    "totalProfit": 177000,
                    "holdingPeriod": 3.3,
                    "status": "completed",
                    "notes": "25.1Ëê¨km"
                },
                {
                    "id": "HSR-20021",
                    "plate": "RCU-6772",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 158095,
                    "totalRentalRevenue": 742095,
                    "totalOperatingCost": 246858,
                    "totalProfit": 140538,
                    "holdingPeriod": 3.3,
                    "status": "completed",
                    "notes": "23,1Ëê¨km"
                },
                {
                    "id": "HSR-20022",
                    "plate": "RCU-6773",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 195238,
                    "totalRentalRevenue": 735048,
                    "totalOperatingCost": 251706,
                    "totalProfit": 165786,
                    "holdingPeriod": 3.3,
                    "status": "completed",
                    "notes": "25.1Ëê¨km"
                },
                {
                    "id": "HSR-20023",
                    "plate": "RCU-6775",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 171429,
                    "totalRentalRevenue": 919535,
                    "totalOperatingCost": 298443,
                    "totalProfit": 279727,
                    "holdingPeriod": 3.3,
                    "status": "completed",
                    "notes": "23.7Ëê¨km"ÊúâÊî∂Ë∂ÖÈáåÁ®ã
                },
                {
                    "id": "HSR-20024",
                    "plate": "RCU-6781",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-10-02",
                    "purchasePrice": 512794,
                    "salePrice": 190476,
                    "totalRentalRevenue": 735048,
                    "totalOperatingCost": 249316,
                    "totalProfit": 163414,
                    "holdingPeriod": 3.3,
                    "status": "completed",
                    "notes": "20.6Ëê¨km"
                },
                {
                    "id": "HSR-20025",
                    "plate": "RCW-6713",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2020-04-30",
                    "saleDate": "2023-11-16",
                    "purchasePrice": 512794,
                    "salePrice": 142857,
                    "totalRentalRevenue": 960382,
                    "totalOperatingCost": 417061,
                    "totalProfit": 173383,
                    "holdingPeriod": 3.4,
                    "status": "completed",
                    "notes": "31.4Ëê¨km"ÊúâÊî∂ÂõûÂæ©Ë≤ª
                },
                {      
                    "id": "HSR-22026",
                    "plate": "RDL-6517",
                    "model": "Toyota Yaris",
                    "type": "Sedan",
                    "purchaseDate": "2022-03-11",
                    "saleDate": "2024-05-16",
                    "purchasePrice": 445047,
                    "salePrice": 202857,
                    "totalRentalRevenue": 514995,
                    "totalOperatingCost": 102616,
                    "totalProfit": 1730189,
                    "holdingPeriod": 1.5,
                    "status": "completed",
                    "notes": "14.6Ëê¨km"
                }
            ],
            "terminatedVehicles": [
                {
                    "id": "GA-22003",
                    "plate": "TERM-001",
                    "model": "Hyundai Elantra",
                    "type": "Sedan",
                    "leaseStartDate": "2022-05-01",
                    "terminationDate": "2025-02-15",
                    "purchasePrice": 750000,
                    "rentalRevenueReceived": 1800000,
                    "terminationFeeReceived": 150000,
                    "totalOperatingCost": 1200000,
                    "totalProfit": 700000,
                    "holdingPeriod": 2.76,
                    "terminationReason": "ÁßüÂÆ¢Ê•≠ÂãôÁ∏ÆÊ∏õ",
                    "status": "terminated",
                    "notes": "ÊèêÂâçËß£Á¥ÑÔºåÊî∂ÂèñÈÅïÁ¥ÑÈáë"
                },
                {
                    "id": "HSR-23003",
                    "plate": "RCU-6725",
                    "model": "Nissan Serena",
                    "type": "MPV",
                    "leaseStartDate": "2023-01-10",
                    "terminationDate": "2025-07-20",
                    "purchasePrice": 1100000,
                    "rentalRevenueReceived": 1950000,
                    "terminationFeeReceived": 200000,
                    "totalOperatingCost": 1400000,
                    "totalProfit": 850000,
                    "holdingPeriod": 2.53,
                    "terminationReason": "ÁßüÂÆ¢ËΩâÂêëËá™Ë≥º",
                    "status": "terminated",
                    "notes": "2.5Âπ¥ÊèêÂâçËß£Á¥Ñ"
                },
                {
                    "id": "TRK-22003",
                    "plate": "TERM-003",
                    "model": "Mitsubishi Fuso",
                    "type": "Track",
                    "leaseStartDate": "2022-08-15",
                    "terminationDate": "2025-05-10",
                    "purchasePrice": 1800000,
                    "rentalRevenueReceived": 3200000,
                    "terminationFeeReceived": 300000,
                    "totalOperatingCost": 2400000,
                    "totalProfit": 1100000,
                    "holdingPeriod": 2.78,
                    "terminationReason": "ÁßüÂÆ¢‰ΩµË≥ºÂæåËªäÈöäÊï¥‰Ωµ",
                    "status": "terminated",
                    "notes": "Âõ†‰ºÅÊ•≠‰ΩµË≥ºËÄåËß£Á¥Ñ"
                },
                {
                    "id": "VAN-23005",
                    "plate": "TERM-004",
                    "model": "Mercedes Sprinter",
                    "type": "VAN",
                    "leaseStartDate": "2023-06-20",
                    "terminationDate": "2025-03-30",
                    "purchasePrice": 1050000,
                    "rentalRevenueReceived": 1200000,
                    "terminationFeeReceived": 100000,
                    "totalOperatingCost": 950000,
                    "totalProfit": 400000,
                    "holdingPeriod": 1.78,
                    "terminationReason": "ÁßüÂÆ¢Á∂ìÁáüÂõ∞Èõ£",
                    "status": "terminated",
                    "notes": "1.8Âπ¥ÊèêÂâçËß£Á¥ÑÔºåËôßÊêçÈ¢®Èö™"
                },
                {
                    "id": "GA-23008",
                    "plate": "TERM-005",
                    "model": "Mazda CX-5",
                    "type": "SUV",
                    "leaseStartDate": "2023-03-05",
                    "terminationDate": "2025-09-15",
                    "purchasePrice": 1200000,
                    "rentalRevenueReceived": 1600000,
                    "terminationFeeReceived": 120000,
                    "totalOperatingCost": 1100000,
                    "totalProfit": 620000,
                    "holdingPeriod": 2.52,
                    "terminationReason": "ÁßüÂÆ¢‰∏ªÂãïÊèêÂâçÁµêÊùü",
                    "status": "terminated",
                    "notes": "2.5Âπ¥ÊèêÂâçËß£Á¥Ñ"
                }
            ]
        };
        
        // ÂàùÂßãÂåñ
        document.getElementById('reportDate').textContent = fleetData.reportDate;
        document.getElementById('totalVehicles').textContent = fleetData.summary.totalVehicles;
        document.getElementById('idleVehicles').textContent = fleetData.summary.status.idle;
        document.getElementById('activeVehicles').textContent = fleetData.summary.status.active;
        document.getElementById('maintenanceVehicles').textContent = fleetData.summary.status.maintenance;
        document.getElementById('soldVehicles').textContent = fleetData.summary.status.sold;
        document.getElementById('terminatedVehicles').textContent = fleetData.summary.status.terminated;
        
        // Ê®ôÁ±§ÂàáÊèõ
        function switchTab(tabName) {
            const contents = document.querySelectorAll('.tab-content');
            const buttons = document.querySelectorAll('.tab-btn');
            
            contents.forEach(c => c.classList.remove('active'));
            buttons.forEach(b => b.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            setTimeout(() => {
                if (tabName === 'overview') initOverviewCharts();
                else if (tabName === 'trends') initTrendCharts();
                else if (tabName === 'vehicles') { initVehicleCharts(); populateVehicleTable(); }
                else if (tabName === 'sold') populateSoldTable();
                else if (tabName === 'terminated') populateTerminatedTable();
                else if (tabName === 'profitability') initProfitabilityCharts();
                else if (tabName === 'costs') initCostCharts();
            }, 100);
        }
        
        // ÂúñË°®ÈÖçÁΩÆ
        const chartConfig = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    labels: {
                        font: { size: 12 },
                        padding: 15
                    }
                }
            }
        };
        
        // ÂàùÂßãÂåñËªäÈöäÁ∏ΩË¶ΩÂúñË°®
        function initOverviewCharts() {
            new Chart(document.getElementById('statusChart'), {
                type: 'doughnut',
                data: {
                    labels: ['ÁßüÁî®‰∏≠', 'ÊΩõÂú®', 'ÈáçÂ§ßÁ∂≠‰øÆ', 'Â∑≤Ëß£Á¥Ñ', 'Â∑≤Âá∫ÂîÆ'],
                    datasets: [{
                        data: [29, 1, 0, 5, 28],
                        backgroundColor: ['#51cf66', '#ffd93d', '#ff922b', '#ff6b6b', '#868e96']
                    }]
                },
                options: chartConfig
            });
            
            new Chart(document.getElementById('typeChart'), {
                type: 'doughnut',
                data: {
                    labels: ['Sedan', 'SUV', 'MPV'],
                    datasets: [{
                        data: [26, 1, 2],
                        backgroundColor: ['#667eea', '#4facfe', '#00f2fe']
                    }]
                },
                options: chartConfig
            });
            
            new Chart(document.getElementById('ageChart'), {
                type: 'bar',
                data: {
                    labels: ['<1Âπ¥', '1-3Âπ¥', '3-5Âπ¥', '>5Âπ¥'],
                    datasets: [{
                        label: 'ËªäËºõÂè∞Êï∏',
                        data: [0, 27, 2, 0],
                        backgroundColor: '#667eea'
                    }]
                },
                options: chartConfig
            });
            
            new Chart(document.getElementById('typePerformanceChart'), {
                type: 'bar',
                data: {
                    labels: ['Sedan', 'SUV', 'MPV'],
                    datasets: [
                        {
                            label: 'Âà©ÊΩ§Áéá (%)',
                            data: [12.5, 10.5, 22.4],
                            backgroundColor: '#667eea'
                        }
                    ]
                },
                options: chartConfig
            });
        }
        
        // ÂàùÂßãÂåñÂπ¥Â∫¶Ë∂®Âã¢ÂúñË°®
        function initTrendCharts() {
            const years = fleetData.yearlyTrend.map(y => y.year);
            const revenues = fleetData.yearlyTrend.map(y => y.revenue / 1000000);
            const expenses = fleetData.yearlyTrend.map(y => y.expense / 1000000);
            const profits = fleetData.yearlyTrend.map(y => y.profit / 1000000);
            
            new Chart(document.getElementById('revenueChart'), {
                type: 'line',
                data: {
                    labels: years,
                    datasets: [
                        {
                            label: 'Êî∂Áõä',
                            data: revenues,
                            borderColor: '#51cf66',
                            backgroundColor: 'rgba(81, 207, 102, 0.1)',
                            tension: 0.4,
                            fill: true
                        },
                        {
                            label: 'ÊàêÊú¨',
                            data: expenses,
                            borderColor: '#ff6b6b',
                            backgroundColor: 'rgba(255, 107, 107, 0.1)',
                            tension: 0.4,
                            fill: true
                        },
                        {
                            label: 'Ê∑®Âà©',
                            data: profits,
                            borderColor: '#667eea',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            tension: 0.4,
                            fill: true
                        }
                    ]
                },
                options: chartConfig
            });
            
            new Chart(document.getElementById('claimRateChart'), {
                type: 'line',
                data: {
                    labels: years,
                    datasets: [{
                        label: 'Âá∫Èö™Áéá (%)',
                        data: fleetData.yearlyTrend.map(y => y.claimRate),
                        borderColor: '#ff922b',
                        backgroundColor: 'rgba(255, 146, 43, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: chartConfig
            });
            
            new Chart(document.getElementById('utilizationChart'), {
                type: 'line',
                data: {
                    labels: years,
                    datasets: [{
                        label: '‰ΩøÁî®Áéá (%)',
                        data: fleetData.yearlyTrend.map(y => y.utilization),
                        borderColor: '#4facfe',
                        backgroundColor: 'rgba(79, 172, 254, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: chartConfig
            });
            
            new Chart(document.getElementById('profitTrendChart'), {
                type: 'bar',
                data: {
                    labels: years,
                    datasets: [{
                        label: 'Âπ¥Â∫¶Ê∑®Âà© (ÁôæËê¨ÂÖÉ)',
                        data: profits,
                        backgroundColor: years.map((y, i) => fleetData.yearlyTrend[i].forecast ? '#ffd93d' : '#667eea')
                    }]
                },
                options: chartConfig
            });
        }
        
        // ÂàùÂßãÂåñËªäËºõÂàÜÊûêÂúñË°®
        function initVehicleCharts() {
            const vehicles = fleetData.expiringVehicles;
            
            new Chart(document.getElementById('expiryTimelineChart'), {
                type: 'bar',
                data: {
                    labels: vehicles.map(v => v.id),
                    datasets: [{
                        label: 'Ë∑ùÈõ¢Âà∞ÊúüÂ§©Êï∏',
                        data: vehicles.map(v => Math.ceil((new Date(v.leaseEnd) - new Date()) / (1000 * 60 * 60 * 24))),
                        backgroundColor: vehicles.map(v => {
                            if (v.status === 'critical') return '#ff6b6b';
                            if (v.status === 'warning') return '#ffd93d';
                            return '#51cf66';
                        })
                    }]
                },
                options: chartConfig
            });
            
            new Chart(document.getElementById('expiryProfitChart'), {
                type: 'bar',
                data: {
                    labels: vehicles.map(v => v.id),
                    datasets: [{
                        label: 'Ê∑®Âà© (Ëê¨ÂÖÉ)',
                        data: vehicles.map(v => v.profit / 10000),
                        backgroundColor: vehicles.map(v => v.profit > 0 ? '#51cf66' : '#ff6b6b')
                    }]
                },
                options: chartConfig
            });
        }
        
        // Â°´ÂÖÖËªäËºõË°®Ê†º
        function populateVehicleTable() {
            const tbody = document.getElementById('vehicleTableBody');
            tbody.innerHTML = '';
            
            fleetData.expiringVehicles.forEach(v => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${v.id}</td>
                    <td>${v.plate}</td>
                    <td>${v.type}</td>
                    <td>${v.leaseEnd}</td>
                    <td>$${(v.revenue / 1000000).toFixed(2)}M</td>
                    <td>$${(v.cost / 1000000).toFixed(2)}M</td>
                    <td>$${(v.profit / 10000).toFixed(0)}Ëê¨</td>
                    <td>${v.margin.toFixed(1)}%</td>
                    <td>${v.utilization}%</td>
                    <td><span class="status-badge status-${v.status}">${v.status === 'critical' ? 'üî¥ Á∑äÊÄ•' : v.status === 'warning' ? 'üü° Ë≠¶Á§∫' : 'üü¢ ‰∏ÄËà¨'}</span></td>
                    <td>${v.recommendation}</td>
                `;
            });
        }

        // Â°´ÂÖÖÂ∑≤Âá∫ÂîÆËªäËºõË°®Ê†º
        function populateSoldTable() {
            const tbody = document.getElementById('soldTableBody');
            tbody.innerHTML = '';
            
            let totalPurchase = 0, totalSale = 0, totalRental = 0, totalCost = 0, totalProfit = 0;
            
            fleetData.soldVehicles.forEach(v => {
                totalPurchase += v.purchasePrice;
                totalSale += v.salePrice;
                totalRental += v.totalRentalRevenue;
                totalCost += v.totalOperatingCost;
                totalProfit += v.totalProfit;
                
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${v.id}</td>
                    <td>${v.plate}</td>
                    <td>${v.type}</td>
                    <td>${v.purchaseDate}</td>
                    <td>${v.saleDate}</td>
                    <td>$${(v.purchasePrice / 1000000).toFixed(2)}M</td>
                    <td>$${(v.salePrice / 1000000).toFixed(2)}M</td>
                    <td>$${(v.totalRentalRevenue / 1000000).toFixed(2)}M</td>
                    <td>$${(v.totalOperatingCost / 1000000).toFixed(2)}M</td>
                    <td class="profit-positive">$${(v.totalProfit / 10000).toFixed(0)}Ëê¨</td>
                    <td>${v.holdingPeriod.toFixed(1)}Âπ¥</td>
                    <td>${v.notes}</td>
                `;
            });
            
            document.getElementById('soldCount').textContent = fleetData.soldVehicles.length;
            document.getElementById('soldTotalPurchase').textContent = '$' + (totalPurchase / 1000000).toFixed(1) + 'M';
            document.getElementById('soldTotalSale').textContent = '$' + (totalSale / 1000000).toFixed(2) + 'M';
            document.getElementById('soldTotalRental').textContent = '$' + (totalRental / 1000000).toFixed(1) + 'M';
            document.getElementById('soldTotalCost').textContent = '$' + (totalCost / 1000000).toFixed(2) + 'M';
            document.getElementById('soldTotalProfit').textContent = '$' + (totalProfit / 1000000).toFixed(2) + 'M';
        }

        // Â°´ÂÖÖËß£Á¥ÑËªäËºõË°®Ê†º
        function populateTerminatedTable() {
            const tbody = document.getElementById('terminatedTableBody');
            tbody.innerHTML = '';
            
            let totalPurchase = 0, totalRental = 0, totalFee = 0, totalCost = 0, totalProfit = 0;
            
            fleetData.terminatedVehicles.forEach(v => {
                totalPurchase += v.purchasePrice;
                totalRental += v.rentalRevenueReceived;
                totalFee += v.terminationFeeReceived;
                totalCost += v.totalOperatingCost;
                totalProfit += v.totalProfit;
                
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${v.id}</td>
                    <td>${v.plate}</td>
                    <td>${v.type}</td>
                    <td>${v.leaseStartDate}</td>
                    <td>${v.terminationDate}</td>
                    <td>$${(v.purchasePrice / 1000000).toFixed(2)}M</td>
                    <td>$${(v.rentalRevenueReceived / 1000000).toFixed(2)}M</td>
                    <td>$${(v.terminationFeeReceived / 10000).toFixed(0)}Ëê¨</td>
                    <td>$${(v.totalOperatingCost / 1000000).toFixed(2)}M</td>
                    <td class="profit-positive">$${(v.totalProfit / 10000).toFixed(0)}Ëê¨</td>
                    <td>${v.holdingPeriod.toFixed(1)}Âπ¥</td>
                    <td>${v.terminationReason}</td>
                    <td>${v.notes}</td>
                `;
            });
            
            document.getElementById('termCount').textContent = fleetData.terminatedVehicles.length;
            document.getElementById('termTotalPurchase').textContent = '$' + (totalPurchase / 1000000).toFixed(1) + 'M';
            document.getElementById('termTotalRental').textContent = '$' + (totalRental / 1000000).toFixed(2) + 'M';
            document.getElementById('termTotalFee').textContent = '$' + (totalFee / 1000000).toFixed(2) + 'M';
            document.getElementById('termTotalCost').textContent = '$' + (totalCost / 1000000).toFixed(2) + 'M';
            document.getElementById('termTotalProfit').textContent = '$' + (totalProfit / 1000000).toFixed(2) + 'M';
        }
        
        // ËªäËºõÈÅéÊøæ
        function filterVehicles() {
            const searchText = document.getElementById('searchVehicle').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;
            
            const rows = document.querySelectorAll('#vehicleTableBody tr');
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                const status = row.querySelector('.status-badge').className.includes(statusFilter) || statusFilter === '';
                row.style.display = (text.includes(searchText) && status) ? '' : 'none';
            });
        }
        
        // ÂàùÂßãÂåñÂÄãÂà•ÊêçÁõäÂúñË°®
        function initProfitabilityCharts() {
            const vehicles = fleetData.expiringVehicles;
            
            new Chart(document.getElementById('vehicleComparisonChart'), {
                type: 'bar',
                data: {
                    labels: vehicles.map(v => v.id),
                    datasets: [
                        {
                            label: 'Êî∂Áõä',
                            data: vehicles.map(v => v.revenue / 1000000),
                            backgroundColor: '#51cf66'
                        },
                        {
                            label: 'ÊàêÊú¨',
                            data: vehicles.map(v => v.cost / 1000000),
                            backgroundColor: '#ff6b6b'
                        },
                        {
                            label: 'Ê∑®Âà©',
                            data: vehicles.map(v => v.profit / 1000000),
                            backgroundColor: '#667eea'
                        }
                    ]
                },
                options: chartConfig
            });
            
            new Chart(document.getElementById('marginRankChart'), {
                type: 'bar',
                data: {
                    labels: vehicles.map(v => v.id),
                    datasets: [{
                        label: 'Âà©ÊΩ§Áéá (%)',
                        data: vehicles.map(v => v.margin),
                        backgroundColor: vehicles.map(v => v.margin > 0 ? '#51cf66' : '#ff6b6b')
                    }]
                },
                options: {
                    ...chartConfig,
                    indexAxis: 'y'
                }
            });
            
            new Chart(document.getElementById('scatterChart'), {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'ËªäËºõÁ∏æÊïà',
                        data: vehicles.map(v => ({x: v.utilization, y: v.margin})),
                        backgroundColor: vehicles.map(v => {
                            if (v.status === 'critical') return '#ff6b6b';
                            if (v.status === 'warning') return '#ffd93d';
                            return '#51cf66';
                        }),
                        pointRadius: 8
                    }]
                },
                options: {
                    ...chartConfig,
                    scales: {
                        x: { title: { display: true, text: '‰ΩøÁî®Áéá (%)' } },
                        y: { title: { display: true, text: 'Âà©ÊΩ§Áéá (%)' } }
                    }
                }
            });
        }
        
        // ÂàùÂßãÂåñÊàêÊú¨ÁµêÊßãÂúñË°®
        function initCostCharts() {
            new Chart(document.getElementById('costStructureChart'), {
                type: 'doughnut',
                data: {
                    labels: ['Ë≥ºËªä', 'Á®ÖÈáë', 'Á∂≠‰øÆ', '‰øùÈö™', 'ÂÖ∂‰ªñ'],
                    datasets: [{
                        data: [45.0, 12.5, 18.5, 15.0, 9.0],
                        backgroundColor: ['#667eea', '#764ba2', '#f093fb', '#4facfe', '#868e96']
                    }]
                },
                options: chartConfig
            });
            
            new Chart(document.getElementById('typeMarginChart'), {
                type: 'bar',
                data: {
                    labels: fleetData.typePerformance.map(t => t.type),
                    datasets: [{
                        label: 'Âà©ÊΩ§Áéá (%)',
                        data: fleetData.typePerformance.map(t => t.profitMargin),
                        backgroundColor: '#667eea'
                    }]
                },
                options: chartConfig
            });
            
            new Chart(document.getElementById('costStackChart'), {
                type: 'bar',
                data: {
                    labels: fleetData.expiringVehicles.map(v => v.id),
                    datasets: [{
                        label: 'ÊàêÊú¨ (ÁôæËê¨ÂÖÉ)',
                        data: fleetData.expiringVehicles.map(v => v.cost / 1000000),
                        backgroundColor: '#667eea'
                    }]
                },
                options: chartConfig
            });
        }
        
        // ÂàùÂßãÂåñÈ¶ñÈ†ÅÂúñË°®
        initOverviewCharts();
    </script>
</body>
              </html>
