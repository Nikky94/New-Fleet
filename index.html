<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é€²éšè»ŠéšŠç‡Ÿé‹ç¸¾æ•ˆå ±è¡¨</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <style>
        /* CSS styles remain the same */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 1600px; margin: 0 auto; background: white; border-radius: 12px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); overflow: hidden; }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; text-align: center; }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; }
        .header p { font-size: 1.1em; opacity: 0.9; }
        .tabs { display: flex; background: #f5f5f5; border-bottom: 2px solid #ddd; overflow-x: auto; }
        .tab-btn { flex: 1; padding: 15px 20px; border: none; background: none; cursor: pointer; font-size: 1em; color: #666; transition: all 0.3s; white-space: nowrap; min-width: 150px; }
        .tab-btn:hover { background: #e0e0e0; color: #333; }
        .tab-btn.active { background: white; color: #667eea; border-bottom: 3px solid #667eea; font-weight: bold; }
        .content { padding: 30px; min-height: 600px; }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .stat-card h3 { font-size: 0.9em; opacity: 0.9; margin-bottom: 10px; }
        .stat-card .value { font-size: 2em; font-weight: bold; }
        .stat-card .unit { font-size: 0.8em; opacity: 0.8; margin-top: 5px; }
        .chart-container { position: relative; height: 400px; margin-bottom: 30px; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .chart-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
        @media (max-width: 1024px) { .chart-row { grid-template-columns: 1fr; } }
        .table-container { overflow-x: auto; background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        table { width: 100%; border-collapse: collapse; font-size: 0.95em; }
        th { background: #667eea; color: white; padding: 15px; text-align: left; font-weight: 600; }
        td { padding: 12px 15px; border-bottom: 1px solid #eee; }
        tr:hover { background: #f9f9f9; }
        .status-badge { display: inline-block; padding: 5px 12px; border-radius: 20px; font-size: 0.85em; font-weight: 600; }
        .status-critical { background: #ff6b6b; color: white; }
        .status-warning { background: #ffd93d; color: #333; }
        .status-normal { background: #51cf66; color: white; }
        .profit-positive { color: #51cf66; font-weight: bold; }
        .profit-negative { color: #ff6b6b; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš— é€²éšè»ŠéšŠç‡Ÿé‹ç¸¾æ•ˆå ±è¡¨</h1>
            <p>JBD Dept. Fleet Management - 2026 Performance Dashboard</p>
        </div>
        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab(\'overview\')">ğŸ“Š è»ŠéšŠç¸½è¦½</button>
            <button class="tab-btn" onclick="switchTab(\'vehicles\')">ğŸš™ ä½¿ç”¨ä¸­è»Šè¼›</button>
            <button class="tab-btn" onclick="switchTab(\'profitability\')">ğŸ’° å€‹åˆ¥æç›Š</button>
             <button class="tab-btn" onclick="switchTab(\'sold\')">âœ… å·²å‡ºå”®è»Šè¼›</button>
        </div>
        <div class="content">
            <div id="overview" class="tab-content active">
                <h2 style="margin-bottom: 20px;">ç¾æ³çµ±è¨ˆ</h2>
                <div class="stats-grid">
                    <div class="stat-card"><h3>ç¸½è»Šè¼›</h3><div class="value" id="totalVehicles"></div><div class="unit">å°</div></div>
                    <div class="stat-card"><h3>ä½¿ç”¨ä¸­</h3><div class="value" id="activeVehicles"></div><div class="unit">å°</div></div>
                    <div class="stat-card"><h3>è‡ªè³¼</h3><div class="value" id="idleVehicles"></div><div class="unit">å°</div></div>
                    <div class="stat-card"><h3>æœˆå‡ç¸½æ”¶ç›Š</h3><div class="value" id="avgMonthlyRevenue"></div><div class="unit">å…ƒ</div></div>
                    <div class="stat-card"><h3>æœˆå‡ç¸½æˆæœ¬</h3><div class="value" id="avgMonthlyExpense"></div><div class="unit">å…ƒ</div></div>
                    <div class="stat-card"><h3>æ•´é«”ä½¿ç”¨ç‡</h3><div class="value" id="utilizationRate"></div></div>
                </div>
            </div>
            <div id="vehicles" class="tab-content">
                <h2 style="margin-bottom: 20px;">ä½¿ç”¨ä¸­è»Šè¼›åˆ—è¡¨</h2>
                <div class="table-container">
                    <table id="vehiclesTable"><thead><tr><th>è»Šç‰Œ</th><th>è»Šå‹</th><th>ç§Ÿç´„åˆ°æœŸæ—¥</th><th>ç´¯è¨ˆç¸½æ”¶ç›Š</th><th>ç´¯è¨ˆç¸½æˆæœ¬</th><th>æœˆå‡æ·¨åˆ©</th><th>åˆ©æ½¤ç‡</th><th>ä½¿ç”¨ç‡</th><th>ç‹€æ…‹</th></tr></thead><tbody></tbody></table>
                </div>
            </div>
            <div id="profitability" class="tab-content">
                 <h2 style="margin-bottom: 20px;">å€‹åˆ¥è»Šè¼›æç›Šåˆ†æ</h2>
                <div class="table-container">
                    <table id="profitabilityTable"><thead><tr><th>è»Šç‰Œ</th><th>è»Šå‹</th><th>ç´¯è¨ˆç¸½æ”¶ç›Š</th><th>ç´¯è¨ˆç¸½æˆæœ¬</th><th>ç´¯è¨ˆæ·¨åˆ©</th><th>åˆ©æ½¤ç‡</th></tr></thead><tbody></tbody></table>
                </div>
            </div>
            <div id="sold" class="tab-content">
                <h2 style="margin-bottom: 20px;">å·²å‡ºå”®è»Šè¼›åˆ—è¡¨</h2>
                <div class="table-container">
                    <table id="soldVehiclesTable"><thead><tr><th>è»Šç‰Œ</th><th>è»Šå‹</th><th>è³¼å…¥åƒ¹</th><th>å‡ºå”®åƒ¹</th><th>ç¸½ç§Ÿé‡‘æ”¶å…¥</th><th>ç¸½ç‡Ÿé‹æˆæœ¬</th><th>ç¸½æç›Š</th></tr></thead><tbody></tbody></table>
                </div>
            </div>
        </div>
    </div>
    <script>
        const fleetData = {
            "reportInfo": {
                "reportDate": "2026-02-28",
                "reportTitle": "ğŸ‘®è»ŠéšŠå ±è¡¨",
                "company": " JBD Dept. "
            },
            "summary": {
                "totalVehicles": 30,
                "status": {
                    "active": 29,
                    "idle": 1,
                    "sold": 27,
                    "terminated": 4
                },
                "avgMonthlyRevenue": 24695,
                "avgMonthlyExpense": 7722,
                "utilizationRate": 96.7
            },
            "yearlyTrend": [
                {"year": 2021, "revenue": 5774563, "expense": 3934790, "profit": 1839773, "claimRate": 0.42, "utilization": 92.5},
                {"year": 2022, "revenue": 7085577, "expense": 4077142, "profit": 3008435, "claimRate": 0.44, "utilization": 94.1},
                {"year": 2023, "revenue": 8744272, "expense": 3694609, "profit": 5049663, "claimRate": 1.44, "utilization": 95.8},
                {"year": 2024, "revenue": 9306029, "expense": 3202077, "profit": 6103952, "claimRate": 0.74, "utilization": 96.2},
                {"year": 2025, "revenue": 8595524, "expense": 3158363, "profit": 5437161, "claimRate": 0.67, "utilization": 96.7},
                {"year": 2026, "revenue": 8854422, "expense": 2858841, "profit": 5234191, "claimRate": 0.69, "utilization": 96.7},
                {"year": 2027, "revenue": 8499354, "expense": 3026021, "profit": 5473333, "claimRate": 0.64, "utilization": 100},
                {"year": 2028, "revenue": 9533640, "expense": 4000000, "profit": 5533640, "claimRate": 0.6, "utilization": 100},
                {"year": 2029, "revenue": 9533640, "expense": 4000000, "profit": 5533600, "claimRate": 0.55, "utilization": 100},
                {"year": 2030, "revenue": 9533640, "expense": 4000000, "profit": 5533600, "claimRate": 0.48, "utilization": 100}
            ],
            "expiringVehicles": [
                {"id": "GA-21001", "plate": "RDH-8065", "model": "Luxgen M7", "type": "MPV", "leaseEnd": "2026-09-18", "revenue": 1033000, "cost": 796000, "utilization": 78.5, "status": "critical", "recommendation": "å·²ä½¿ç”¨äº”å¹´ï¼Œå»ºè­°æ±°æ–°", "leaseStartDate": "2021-09-01"},
                {"id": "GA-21002", "plate": "RDQ-0865", "model": "Honda CR-V", "type": "SUV", "leaseEnd": "2027-03-30", "revenue": 1001000, "cost": 1254000, "utilization": 82.1, "status": "critical", "recommendation": "å·²ä½¿ç”¨å…­å¹´ï¼Œå»ºè­°æ±°æ–°", "leaseStartDate": "2022-03-01"},
                {"id": "CEO-22001", "plate": "RFD-9786", "model": "Toyota Sienna", "type": "MPV", "leaseEnd": "2026-11-30", "revenue": 2100000, "cost": 3089000, "utilization": 88.3, "status": "critical", "recommendation": "8.6è¬,é«˜æ”¶ç›Šè»Šè¼›", "leaseStartDate": "2023-12-01"},
                {"id": "HSR-23001", "plate": "RFA-8173", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°", "leaseStartDate": "2023-09-01"},
                {"id": "HSR-23002", "plate": "RFA-8175", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°", "leaseStartDate": "2023-09-01"},
                {"id": "HSR-23003", "plate": "RFA-8187", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°", "leaseStartDate": "2023-09-01"},
                {"id": "HSR-23004", "plate": "RFA-8190", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°", "leaseStartDate": "2023-09-01"},
                {"id": "HSR-23005", "plate": "RFA-8192", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°", "leaseStartDate": "2023-09-01"},
                {"id": "HSR-23006", "plate": "RFA-8193", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°", "leaseStartDate": "2023-09-01"},
                {"id": "HSR-23007", "plate": "RFA-8197", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°", "leaseStartDate": "2023-09-01"},
                {"id": "HSR-23008", "plate": "RFA-8201", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°", "leaseStartDate": "2023-09-01"},
                {"id": "HSR-23009", "plate": "RFA-8202", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°", "leaseStartDate": "2023-09-01"},
                {"id": "HSR-23010", "plate": "RFA-8203", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°", "leaseStartDate": "2023-09-01"},
                {"id": "HSR-23011", "plate": "RFA-8205", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°", "leaseStartDate": "2023-09-01"},
                {"id": "HSR-23012", "plate": "RFA-8210", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°", "leaseStartDate": "2023-09-01"},
                {"id": "HSR-23013", "plate": "RFA-8211", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°", "leaseStartDate": "2023-09-01"},
                {"id": "HSR-23014", "plate": "RFA-8215", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°", "leaseStartDate": "2023-09-01"},
                {"id": "HSR-23015", "plate": "RFA-8219", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°", "leaseStartDate": "2023-09-01"},
                {"id": "HSR-23016", "plate": "RFA-8223", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°", "leaseStartDate": "2023-09-01"},
                {"id": "HSR-23017", "plate": "RFA-8225", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°", "leaseStartDate": "2023-09-01"},
                {"id": "HSR-23018", "plate": "RFA-8230", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°", "leaseStartDate": "2023-09-01"},
                {"id": "HSR-23019", "plate": "RFA-8232", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°", "leaseStartDate": "2023-09-01"},
                {"id": "HSR-23020", "plate": "RFA-8235", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°", "leaseStartDate": "2023-09-01"},
                {"id": "HSR-23021", "plate": "RFA-8237", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°", "leaseStartDate": "2023-09-01"},
                {"id": "HSR-23022", "plate": "RFA-8239", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°", "leaseStartDate": "2023-09-01"},
                {"id": "HSR-23023", "plate": "RFA-8250", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°", "leaseStartDate": "2023-09-01"},
                {"id": "HSR-23024", "plate": "RFA-8251", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°", "leaseStartDate": "2023-09-01"},
                {"id": "HSR-23025", "plate": "RFA-8252", "model": "Toyota Vios", "type": "Sedan", "leaseEnd": "2026-04-30", "revenue": 768000, "cost": 919000, "utilization": 55.3, "status": "critical", "recommendation": "å·¡é‚è»Šé«˜ç¨¼å‹•,å¦‚æœŸæ›´æ–°", "leaseStartDate": "2023-09-01"},
                {"id": "HSR-23026", "plate": "RFA-9715", "model": "Toyota Camry", "type": "Sedan", "leaseEnd": "2030-05-31", "revenue": 360000, "cost": 96000, "utilization": 85.0, "status": "normal", "recommendation": "æ­£å¸¸", "leaseStartDate": "2025-05-01"}
            ],
            "soldVehicles": [
                {"id": "GA-19001", "plate": "RDQ-1350", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-03-31", "saleDate": "2022-03-30", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
                {"id": "GA-19002", "plate": "RDQ-1351", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-04-01", "saleDate": "2022-04-01", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
                {"id": "GA-19003", "plate": "RDQ-1352", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-04-02", "saleDate": "2022-04-02", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
                {"id": "GA-19004", "plate": "RDQ-1353", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-04-03", "saleDate": "2022-04-03", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
                {"id": "GA-19005", "plate": "RDQ-1354", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-04-04", "saleDate": "2022-04-04", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
                {"id": "GA-19006", "plate": "RDQ-1355", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-04-05", "saleDate": "2022-04-05", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
                {"id": "GA-19007", "plate": "RDQ-1356", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-04-06", "saleDate": "2022-04-06", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
                {"id": "GA-19008", "plate": "RDQ-1357", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-04-07", "saleDate": "2022-04-07", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
                {"id": "GA-19009", "plate": "RDQ-1358", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-04-08", "saleDate": "2022-04-08", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
                {"id": "GA-19010", "plate": "RDQ-1359", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-04-09", "saleDate": "2022-04-09", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
                {"id": "GA-19011", "plate": "RDQ-1360", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-04-10", "saleDate": "2022-04-10", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
                {"id": "GA-19012", "plate": "RDQ-1361", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-04-11", "saleDate": "2022-04-11", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
                {"id": "GA-19013", "plate": "RDQ-1362", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-04-12", "saleDate": "2022-04-12", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
                {"id": "GA-19014", "plate": "RDQ-1363", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-04-13", "saleDate": "2022-04-13", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
                {"id": "GA-19015", "plate": "RDQ-1364", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-04-14", "saleDate": "2022-04-14", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
                {"id": "GA-19016", "plate": "RDQ-1365", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-04-15", "saleDate": "2022-04-15", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
                {"id": "GA-19017", "plate": "RDQ-1366", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-04-16", "saleDate": "2022-04-16", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
                {"id": "GA-19018", "plate": "RDQ-1367", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-04-17", "saleDate": "2022-04-17", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
                {"id": "GA-19019", "plate": "RDQ-1368", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-04-18", "saleDate": "2022-04-18", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
                {"id": "GA-19020", "plate": "RDQ-1369", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-04-19", "saleDate": "2022-04-19", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
                {"id": "GA-19021", "plate": "RDQ-1370", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-04-20", "saleDate": "2022-04-20", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
                {"id": "GA-19022", "plate": "RDQ-1371", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-04-21", "saleDate": "2022-04-21", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
                {"id": "GA-19023", "plate": "RDQ-1372", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-04-22", "saleDate": "2022-04-22", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
                {"id": "GA-19024", "plate": "RDQ-1373", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-04-23", "saleDate": "2022-04-23", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
                {"id": "GA-19025", "plate": "RDQ-1374", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-04-24", "saleDate": "2022-04-24", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
                {"id": "GA-19026", "plate": "RDQ-1375", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-04-25", "saleDate": "2022-04-25", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"},
                {"id": "GA-19027", "plate": "RDQ-1376", "model": "Toyota Sienta", "type": "MPV", "purchaseDate": "2019-04-26", "saleDate": "2022-04-26", "purchasePrice": 679531, "salePrice": 438095, "totalRentalRevenue": 480000, "totalOperatingCost": 124148, "totalProfit": 114416, "holdingPeriod": 3, "status": "completed", "notes": "5.5è¬km"}
            ],
            "terminatedVehicles": [
                {"id": "HSR-001", "plate": "RAA-1234", "model": "Nissan Sentra", "rentalRevenue": 120000, "penalty": 50000, "operatingCost": 80000, "totalProfit": 90000, "reason": "å®¢æˆ¶æå‰è§£ç´„"},
                {"id": "HSR-002", "plate": "RAB-5678", "model": "Ford Focus", "rentalRevenue": 80000, "penalty": 30000, "operatingCost": 60000, "totalProfit": 50000, "reason": "è»Šè¼›æå£åš´é‡"},
                {"id": "HSR-003", "plate": "RAC-9012", "model": "Mazda 3", "rentalRevenue": 100000, "penalty": 40000, "operatingCost": 70000, "totalProfit": 70000, "reason": "å®¢æˆ¶ä¿¡ç”¨ä¸ä½³"},
                {"id": "HSR-004", "plate": "RAD-3456", "model": "Hyundai Elantra", "rentalRevenue": 90000, "penalty": 35000, "operatingCost": 65000, "totalProfit": 60000, "reason": "ç§Ÿè³ƒæœŸæ»¿æœªçºŒç´„"}
            ],
            "costBreakdown": [
                {"item": "è³¼è»Šæˆæœ¬", "amount": 5000000, "percentage": 0.5},
                {"item": "ç¨…é‡‘èˆ‡è¦è²»", "amount": 1000000, "percentage": 0.1},
                {"item": "ç¶­ä¿®ä¿é¤Š", "amount": 1500000, "percentage": 0.15},
                {"item": "ä¿éšªè²»ç”¨", "amount": 1200000, "percentage": 0.12},
                {"item": "å…¶ä»–", "amount": 1300000, "percentage": 0.13}
            ]
        };

        function formatCurrency(num) {
            return num.toLocaleString('zh-TW', { style: 'currency', currency: 'TWD', minimumFractionDigits: 0 });
        }

        function getMonthsBetween(startDateStr, endDate) {
            const start = new Date(startDateStr);
            const end = new Date(endDate);
            let months = (end.getFullYear() - start.getFullYear()) * 12;
            months -= start.getMonth();
            months += end.getMonth();
            return months <= 0 ? 1 : months;
        }

        function updateSummaryCards() {
            const totalVehicles = fleetData.expiringVehicles.length;
            const activeVehicles = fleetData.expiringVehicles.filter(v => v.status !== 'idle').length;
            const idleVehicles = totalVehicles - activeVehicles;

            let totalRevenue = 0;
            let totalCost = 0;
            let totalMonths = 0;
            let totalUtilization = 0;

            fleetData.expiringVehicles.forEach(v => {
                const leaseMonths = getMonthsBetween(v.leaseStartDate, new Date());
                totalRevenue += v.revenue;
                totalCost += v.cost;
                totalMonths += leaseMonths;
                totalUtilization += v.utilization;
            });

            document.getElementById('totalVehicles').textContent = totalVehicles;
            document.getElementById('activeVehicles').textContent = activeVehicles;
            document.getElementById('idleVehicles').textContent = idleVehicles;
            document.getElementById('avgMonthlyRevenue').textContent = formatCurrency(totalRevenue / totalMonths);
            document.getElementById('avgMonthlyExpense').textContent = formatCurrency(totalCost / totalMonths);
            document.getElementById('utilizationRate').textContent = `${(totalUtilization / totalVehicles).toFixed(1)}%`;
        }

        function populateVehiclesTable() {
            const tableBody = document.querySelector('#vehiclesTable tbody');
            tableBody.innerHTML = '';
            fleetData.expiringVehicles.forEach(v => {
                const leaseMonths = getMonthsBetween(v.leaseStartDate, new Date());
                const monthlyProfit = (v.revenue - v.cost) / leaseMonths;
                const margin = (v.revenue > 0) ? ((v.revenue - v.cost) / v.revenue * 100).toFixed(1) : 0;

                const row = tableBody.insertRow();
                row.insertCell().textContent = v.plate;
                row.insertCell().textContent = v.model;
                row.insertCell().textContent = v.leaseEnd;
                row.insertCell().textContent = formatCurrency(v.revenue);
                row.insertCell().textContent = formatCurrency(v.cost);
                row.insertCell().textContent = formatCurrency(monthlyProfit);
                row.insertCell().textContent = `${margin}%`;
                row.insertCell().textContent = `${v.utilization.toFixed(1)}%`;
                const statusCell = row.insertCell();
                const statusBadge = document.createElement('span');
                statusBadge.className = `status-badge status-${v.status}`;
                statusBadge.textContent = v.recommendation;
                statusCell.appendChild(statusBadge);
            });
        }
        
        function populateProfitabilityTable() {
            const tableBody = document.querySelector('#profitabilityTable tbody');
            tableBody.innerHTML = '';
            fleetData.expiringVehicles.forEach(v => {
                const netProfit = v.revenue - v.cost;
                const margin = (v.revenue > 0) ? (netProfit / v.revenue * 100).toFixed(1) : 0;
                const row = tableBody.insertRow();
                row.insertCell().textContent = v.plate;
                row.insertCell().textContent = v.model;
                row.insertCell().textContent = formatCurrency(v.revenue);
                row.insertCell().textContent = formatCurrency(v.cost);
                const profitCell = row.insertCell();
                profitCell.textContent = formatCurrency(netProfit);
                profitCell.className = netProfit >= 0 ? 'profit-positive' : 'profit-negative';
                row.insertCell().textContent = `${margin}%`;
            });
        }

        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            document.querySelector(`.tab-btn[onclick="switchTab('${tabId}')"]`).classList.add('active');
        }

        document.addEventListener('DOMContentLoaded', () => {
            updateSummaryCards();
            populateVehiclesTable();
            populateProfitabilityTable();
        });
    </script>
</body>
</html>
